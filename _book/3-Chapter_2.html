<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 第2章 | 『カテゴリカルデータの連関モデル』サポートページ</title>
  <meta name="description" content="3 第2章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 第2章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 第2章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  
  
  

<meta name="author" content="藤原翔（Sho Fujihara）" />


<meta name="date" content="2020-09-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2-Chapter_1.html"/>
<link rel="next" href="4-Chapter_3.html"/>
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="1-Introduction.html"><a href="1-Introduction.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-Introduction.html"><a href="1-Introduction.html#本ページの目的"><i class="fa fa-check"></i><b>1.1</b> 本ページの目的</a></li>
<li class="chapter" data-level="1.2" data-path="1-Introduction.html"><a href="1-Introduction.html#正誤表"><i class="fa fa-check"></i><b>1.2</b> 正誤表</a></li>
<li class="chapter" data-level="1.3" data-path="1-Introduction.html"><a href="1-Introduction.html#rのインストール"><i class="fa fa-check"></i><b>1.3</b> Rのインストール</a></li>
<li class="chapter" data-level="1.4" data-path="1-Introduction.html"><a href="1-Introduction.html#l_rm-emのインストール"><i class="fa fa-check"></i><b>1.4</b> <span class="math inline">\(l_{\rm EM}\)</span>のインストール</a></li>
<li class="chapter" data-level="1.5" data-path="1-Introduction.html"><a href="1-Introduction.html#シリーズ編者による序文"><i class="fa fa-check"></i><b>1.5</b> シリーズ編者による序文</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1-Introduction.html"><a href="1-Introduction.html#独立性の検定"><i class="fa fa-check"></i><b>1.5.1</b> 独立性の検定</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-Introduction.html"><a href="1-Introduction.html#一様連関モデル"><i class="fa fa-check"></i><b>1.5.2</b> 一様連関モデル</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="1-Introduction.html"><a href="1-Introduction.html#度数行変数列変数のデータからクロス表を作成"><i class="fa fa-check"></i><b>1.6</b> 度数，行変数，列変数のデータからクロス表を作成</a></li>
<li class="chapter" data-level="1.7" data-path="1-Introduction.html"><a href="1-Introduction.html#練習問題"><i class="fa fa-check"></i><b>1.7</b> 練習問題</a></li>
<li class="chapter" data-level="1.8" data-path="1-Introduction.html"><a href="1-Introduction.html#参考文献"><i class="fa fa-check"></i><b>1.8</b> 参考文献</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-Chapter_1.html"><a href="2-Chapter_1.html"><i class="fa fa-check"></i><b>2</b> 第1章</a></li>
<li class="chapter" data-level="3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html"><i class="fa fa-check"></i><b>3</b> 第2章</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.1-p.8"><i class="fa fa-check"></i><b>3.1</b> 表2.1 (p.8)</a></li>
<li class="chapter" data-level="3.2" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.3-p.32"><i class="fa fa-check"></i><b>3.2</b> 表2.3 (p.32)</a></li>
<li class="chapter" data-level="3.3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4a"><i class="fa fa-check"></i><b>3.3</b> 表2.4A</a></li>
<li class="chapter" data-level="3.4" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4b"><i class="fa fa-check"></i><b>3.4</b> 表2.4B</a></li>
<li class="chapter" data-level="3.5" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.5a"><i class="fa fa-check"></i><b>3.5</b> 表2.5A</a></li>
<li class="chapter" data-level="3.6" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#logmultパッケージの利用"><i class="fa fa-check"></i><b>3.6</b> logmultパッケージの利用</a></li>
<li class="chapter" data-level="3.7" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6a"><i class="fa fa-check"></i><b>3.7</b> 表2.6A</a></li>
<li class="chapter" data-level="3.8" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6b"><i class="fa fa-check"></i><b>3.8</b> 表2.6B</a></li>
<li class="chapter" data-level="3.9" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6c"><i class="fa fa-check"></i><b>3.9</b> 表2.6C</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html"><i class="fa fa-check"></i><b>4</b> 第3章</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1a"><i class="fa fa-check"></i><b>4.1</b> 表3.1A</a></li>
<li class="chapter" data-level="4.2" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1b"><i class="fa fa-check"></i><b>4.2</b> 表3.1B</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-Chapter_4.html"><a href="5-Chapter_4.html"><i class="fa fa-check"></i><b>5</b> 第4章</a></li>
<li class="chapter" data-level="6" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html"><i class="fa fa-check"></i><b>6</b> 第5章</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html#表5.1"><i class="fa fa-check"></i><b>6.1</b> 表5.1</a></li>
<li class="chapter" data-level="6.2" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html#表5.4"><i class="fa fa-check"></i><b>6.2</b> 表5.4</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-Chapter_6.html"><a href="7-Chapter_6.html"><i class="fa fa-check"></i><b>7</b> 第6章</a></li>
<li class="chapter" data-level="8" data-path="8-Note.html"><a href="8-Note.html"><i class="fa fa-check"></i><b>8</b> 補足のノート</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8-Note.html"><a href="8-Note.html#集計データの作成"><i class="fa fa-check"></i><b>8.1</b> 集計データの作成</a></li>
<li class="chapter" data-level="8.2" data-path="8-Note.html"><a href="8-Note.html#glmとgnmの結果の比較"><i class="fa fa-check"></i><b>8.2</b> GLMとGNMの結果の比較</a></li>
<li class="chapter" data-level="8.3" data-path="8-Note.html"><a href="8-Note.html#モザイクプロット"><i class="fa fa-check"></i><b>8.3</b> モザイクプロット</a></li>
<li class="chapter" data-level="8.4" data-path="8-Note.html"><a href="8-Note.html#正規化"><i class="fa fa-check"></i><b>8.4</b> 正規化</a></li>
<li class="chapter" data-level="8.5" data-path="8-Note.html"><a href="8-Note.html#初期値"><i class="fa fa-check"></i><b>8.5</b> 初期値</a></li>
</ul></li>
<li class="divider"></li>
<li></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第2章" class="section level1" number="3">
<h1><span class="header-section-number">3</span> 第2章</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="3-Chapter_2.html#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="3-Chapter_2.html#cb1-2"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb1-3"><a href="3-Chapter_2.html#cb1-3"></a><span class="kw">library</span>(broom)</span>
<span id="cb1-4"><a href="3-Chapter_2.html#cb1-4"></a><span class="kw">library</span>(gnm)</span></code></pre></div>
<div id="表2.1-p.8" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> 表2.1 (p.8)</h2>
<ul>
<li>クロス表に周辺度数を追加する場合は，<code>addmargins</code>を用いる．</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="3-Chapter_2.html#cb2-1"></a><span class="co"># default</span></span>
<span id="cb2-2"><a href="3-Chapter_2.html#cb2-2"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor =</span> <span class="st">&quot;contr.treatment&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb2-3"><a href="3-Chapter_2.html#cb2-3"></a></span>
<span id="cb2-4"><a href="3-Chapter_2.html#cb2-4"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">40</span>, <span class="dv">250</span>,</span>
<span id="cb2-5"><a href="3-Chapter_2.html#cb2-5"></a>          <span class="dv">160</span>,<span class="dv">3000</span>)</span>
<span id="cb2-6"><a href="3-Chapter_2.html#cb2-6"></a>tab_<span class="fl">2.1</span> &lt;-<span class="st"> </span><span class="kw">matrix</span>(Freq, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.table</span>()</span>
<span id="cb2-7"><a href="3-Chapter_2.html#cb2-7"></a></span>
<span id="cb2-8"><a href="3-Chapter_2.html#cb2-8"></a><span class="co"># A. 度数（周辺度数の追加）</span></span>
<span id="cb2-9"><a href="3-Chapter_2.html#cb2-9"></a>tab_<span class="fl">2.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">addmargins</span>()</span></code></pre></div>
<pre><code>       A    B  Sum
A     40  250  290
B    160 3000 3160
Sum  200 3250 3450</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="3-Chapter_2.html#cb4-1"></a><span class="co"># B. Odds </span></span>
<span id="cb4-2"><a href="3-Chapter_2.html#cb4-2"></a><span class="dv">40</span><span class="op">/</span><span class="dv">250</span></span></code></pre></div>
<pre><code>[1] 0.16</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="3-Chapter_2.html#cb6-1"></a><span class="dv">160</span><span class="op">/</span><span class="dv">3000</span></span></code></pre></div>
<pre><code>[1] 0.05333333</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="3-Chapter_2.html#cb8-1"></a><span class="co"># C. Odds ratio</span></span>
<span id="cb8-2"><a href="3-Chapter_2.html#cb8-2"></a>(<span class="dv">40</span> <span class="op">*</span><span class="st"> </span><span class="dv">3000</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">250</span> <span class="op">*</span><span class="st"> </span><span class="dv">160</span>)</span></code></pre></div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="3-Chapter_2.html#cb10-1"></a><span class="co"># 度数のベクトル</span></span>
<span id="cb10-2"><a href="3-Chapter_2.html#cb10-2"></a>Freq</span></code></pre></div>
<pre><code>[1]   40  250  160 3000</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="3-Chapter_2.html#cb12-1"></a><span class="co"># 行変数</span></span>
<span id="cb12-2"><a href="3-Chapter_2.html#cb12-2"></a>COMM &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="dv">2</span>)</span>
<span id="cb12-3"><a href="3-Chapter_2.html#cb12-3"></a>COMM</span></code></pre></div>
<pre><code>[1] 1 1 2 2
Levels: 1 2</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="3-Chapter_2.html#cb14-1"></a><span class="co"># 列変数</span></span>
<span id="cb14-2"><a href="3-Chapter_2.html#cb14-2"></a>SUP  &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">4</span>)</span>
<span id="cb14-3"><a href="3-Chapter_2.html#cb14-3"></a>SUP</span></code></pre></div>
<pre><code>[1] 1 2 1 2
Levels: 1 2</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="3-Chapter_2.html#cb16-1"></a><span class="co"># 度数，行変数，列変数からなるデータを作成</span></span>
<span id="cb16-2"><a href="3-Chapter_2.html#cb16-2"></a>freq_tab_<span class="fl">2.1</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, COMM, SUP)</span>
<span id="cb16-3"><a href="3-Chapter_2.html#cb16-3"></a><span class="co"># データの確認</span></span>
<span id="cb16-4"><a href="3-Chapter_2.html#cb16-4"></a>freq_tab_<span class="fl">2.1</span></span></code></pre></div>
<pre><code># A tibble: 4 x 3
   Freq COMM  SUP  
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
1    40 1     1    
2   250 1     2    
3   160 2     1    
4  3000 2     2    </code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="3-Chapter_2.html#cb18-1"></a><span class="co"># gnmで推定</span></span>
<span id="cb18-2"><a href="3-Chapter_2.html#cb18-2"></a>fit &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-3"><a href="3-Chapter_2.html#cb18-3"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>COMM <span class="op">+</span><span class="st"> </span>SUP <span class="op">+</span><span class="st"> </span>COMM<span class="op">*</span>SUP, <span class="dt">data =</span> ., <span class="dt">family =</span> poisson)</span>
<span id="cb18-4"><a href="3-Chapter_2.html#cb18-4"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ COMM + SUP + COMM * SUP, family = poisson, 
    data = .)

Deviance Residuals: 
[1]  0  0  0  0

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   3.6889     0.1581  23.331  &lt; 2e-16 ***
COMM2         1.3863     0.1768   7.842  &lt; 2e-16 ***
SUP2          1.8326     0.1703  10.761  &lt; 2e-16 ***
COMM2:SUP2    1.0986     0.1886   5.824 5.75e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 1.2257e-13 on 0 degrees of freedom
AIC: 37.649

Number of iterations: 2</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="3-Chapter_2.html#cb20-1"></a><span class="co"># Odds ratios</span></span>
<span id="cb20-2"><a href="3-Chapter_2.html#cb20-2"></a>fit<span class="op">$</span>coefficients[[<span class="st">&quot;COMM2:SUP2&quot;</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</span></code></pre></div>
<pre><code>[1] 3</code></pre>
</div>
<div id="表2.3-p.32" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> 表2.3 (p.32)</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="3-Chapter_2.html#cb22-1"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">39</span>, <span class="dv">50</span>, <span class="dv">18</span>,  <span class="dv">4</span>,</span>
<span id="cb22-2"><a href="3-Chapter_2.html#cb22-2"></a>          <span class="dv">140</span>,<span class="dv">178</span>, <span class="dv">85</span>, <span class="dv">23</span>,</span>
<span id="cb22-3"><a href="3-Chapter_2.html#cb22-3"></a>          <span class="dv">108</span>,<span class="dv">195</span>, <span class="dv">97</span>, <span class="dv">23</span>,</span>
<span id="cb22-4"><a href="3-Chapter_2.html#cb22-4"></a>          <span class="dv">238</span>,<span class="dv">598</span>,<span class="dv">363</span>,<span class="dv">111</span>,</span>
<span id="cb22-5"><a href="3-Chapter_2.html#cb22-5"></a>           <span class="dv">78</span>,<span class="dv">250</span>,<span class="dv">150</span>, <span class="dv">55</span>,</span>
<span id="cb22-6"><a href="3-Chapter_2.html#cb22-6"></a>           <span class="dv">50</span>,<span class="dv">200</span>,<span class="dv">208</span>, <span class="dv">74</span>,</span>
<span id="cb22-7"><a href="3-Chapter_2.html#cb22-7"></a>            <span class="dv">8</span>, <span class="dv">29</span>, <span class="dv">46</span>, <span class="dv">21</span>)</span>
<span id="cb22-8"><a href="3-Chapter_2.html#cb22-8"></a></span>
<span id="cb22-9"><a href="3-Chapter_2.html#cb22-9"></a><span class="co"># コントラスト</span></span>
<span id="cb22-10"><a href="3-Chapter_2.html#cb22-10"></a><span class="kw">options</span>(<span class="st">&#39;contrasts&#39;</span>)</span></code></pre></div>
<pre><code>$contrasts
        unordered           ordered 
&quot;contr.treatment&quot;      &quot;contr.poly&quot; </code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="3-Chapter_2.html#cb24-1"></a><span class="co"># default</span></span>
<span id="cb24-2"><a href="3-Chapter_2.html#cb24-2"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor =</span> <span class="st">&quot;contr.treatment&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb24-3"><a href="3-Chapter_2.html#cb24-3"></a></span>
<span id="cb24-4"><a href="3-Chapter_2.html#cb24-4"></a><span class="co"># データを表形式に変換</span></span>
<span id="cb24-5"><a href="3-Chapter_2.html#cb24-5"></a>tab_<span class="fl">2.3</span>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(Freq, <span class="dt">nrow =</span> <span class="dv">7</span>, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.table</span>()</span>
<span id="cb24-6"><a href="3-Chapter_2.html#cb24-6"></a><span class="kw">rownames</span>(tab_<span class="fl">2.3</span>A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Strongly liberal&quot;</span>,</span>
<span id="cb24-7"><a href="3-Chapter_2.html#cb24-7"></a>                        <span class="st">&quot;Liberal&quot;</span>,</span>
<span id="cb24-8"><a href="3-Chapter_2.html#cb24-8"></a>                        <span class="st">&quot;Slightly liberal&quot;</span>,</span>
<span id="cb24-9"><a href="3-Chapter_2.html#cb24-9"></a>                        <span class="st">&quot;Moderate&quot;</span>,</span>
<span id="cb24-10"><a href="3-Chapter_2.html#cb24-10"></a>                        <span class="st">&quot;Slightly conservative&quot;</span>, </span>
<span id="cb24-11"><a href="3-Chapter_2.html#cb24-11"></a>                        <span class="st">&quot;Conservative&quot;</span>,</span>
<span id="cb24-12"><a href="3-Chapter_2.html#cb24-12"></a>                        <span class="st">&quot;Strongly conservative&quot;</span>)</span>
<span id="cb24-13"><a href="3-Chapter_2.html#cb24-13"></a><span class="kw">colnames</span>(tab_<span class="fl">2.3</span>A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Strongly Disagree&quot;</span>,</span>
<span id="cb24-14"><a href="3-Chapter_2.html#cb24-14"></a>                        <span class="st">&quot;Disagree&quot;</span>,</span>
<span id="cb24-15"><a href="3-Chapter_2.html#cb24-15"></a>                        <span class="st">&quot;Agree&quot;</span>,</span>
<span id="cb24-16"><a href="3-Chapter_2.html#cb24-16"></a>                        <span class="st">&quot;Strongly agree&quot;</span>)</span>
<span id="cb24-17"><a href="3-Chapter_2.html#cb24-17"></a>tab_<span class="fl">2.3</span>A</span></code></pre></div>
<pre><code>                      Strongly Disagree Disagree Agree Strongly agree
Strongly liberal                     39       50    18              4
Liberal                             140      178    85             23
Slightly liberal                    108      195    97             23
Moderate                            238      598   363            111
Slightly conservative                78      250   150             55
Conservative                         50      200   208             74
Strongly conservative                 8       29    46             21</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="3-Chapter_2.html#cb26-1"></a><span class="co"># 度数，行変数，列変数からなる集計データを作成</span></span>
<span id="cb26-2"><a href="3-Chapter_2.html#cb26-2"></a>polviews &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">7</span>, <span class="dt">k =</span> <span class="dv">4</span>)</span>
<span id="cb26-3"><a href="3-Chapter_2.html#cb26-3"></a>fefam &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">28</span>)</span>
<span id="cb26-4"><a href="3-Chapter_2.html#cb26-4"></a>freq_tab_<span class="fl">2.3</span>A &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, polviews, fefam)</span>
<span id="cb26-5"><a href="3-Chapter_2.html#cb26-5"></a>freq_tab_<span class="fl">2.3</span>A</span></code></pre></div>
<pre><code># A tibble: 28 x 3
    Freq polviews fefam
   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;
 1    39 1        1    
 2    50 1        2    
 3    18 1        3    
 4     4 1        4    
 5   140 2        1    
 6   178 2        2    
 7    85 2        3    
 8    23 2        4    
 9   108 3        1    
10   195 3        2    
# … with 18 more rows</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="3-Chapter_2.html#cb28-1"></a><span class="co"># 行変数と列変数の整数値を作成</span></span>
<span id="cb28-2"><a href="3-Chapter_2.html#cb28-2"></a>freq_tab_<span class="fl">2.3</span>A <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb28-3"><a href="3-Chapter_2.html#cb28-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Rscore =</span> <span class="kw">as.numeric</span>(polviews),</span>
<span id="cb28-4"><a href="3-Chapter_2.html#cb28-4"></a>         <span class="dt">Cscore =</span> <span class="kw">as.numeric</span>(fefam))</span>
<span id="cb28-5"><a href="3-Chapter_2.html#cb28-5"></a>freq_tab_<span class="fl">2.3</span>A</span></code></pre></div>
<pre><code># A tibble: 28 x 5
    Freq polviews fefam Rscore Cscore
   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1    39 1        1          1      1
 2    50 1        2          1      2
 3    18 1        3          1      3
 4     4 1        4          1      4
 5   140 2        1          2      1
 6   178 2        2          2      2
 7    85 2        3          2      3
 8    23 2        4          2      4
 9   108 3        1          3      1
10   195 3        2          3      2
# … with 18 more rows</code></pre>
<ul>
<li>モデル適合度を表示するための関数</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="3-Chapter_2.html#cb30-1"></a>model.summary &lt;-<span class="st"> </span><span class="cf">function</span>(obj){</span>
<span id="cb30-2"><a href="3-Chapter_2.html#cb30-2"></a>  aic &lt;-<span class="st"> </span>obj<span class="op">$</span>deviance <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>df <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="co"># AIC(L2)</span></span>
<span id="cb30-3"><a href="3-Chapter_2.html#cb30-3"></a>  bic &lt;-<span class="st"> </span>obj<span class="op">$</span>deviance <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>df <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">sum</span>(obj<span class="op">$</span>y)) <span class="co">#BIC(L2)</span></span>
<span id="cb30-4"><a href="3-Chapter_2.html#cb30-4"></a>  delta &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(obj<span class="op">$</span>y <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>fitted.values)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(obj<span class="op">$</span>y))</span>
<span id="cb30-5"><a href="3-Chapter_2.html#cb30-5"></a>  p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(obj<span class="op">$</span>deviance, obj<span class="op">$</span>df, <span class="dt">lower.tail =</span> F)     <span class="co">#p&lt;-ifelse(p&lt;0.001,&quot;&lt;0.001&quot;,p)</span></span>
<span id="cb30-6"><a href="3-Chapter_2.html#cb30-6"></a>  result &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb30-7"><a href="3-Chapter_2.html#cb30-7"></a>  Model &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(obj))</span>
<span id="cb30-8"><a href="3-Chapter_2.html#cb30-8"></a>  result &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&quot;Model Description&quot;</span> =<span class="st"> </span>Model,</span>
<span id="cb30-9"><a href="3-Chapter_2.html#cb30-9"></a>              <span class="st">&quot;df&quot;</span> =<span class="st"> </span>obj<span class="op">$</span>df, </span>
<span id="cb30-10"><a href="3-Chapter_2.html#cb30-10"></a>              <span class="st">&quot;L2&quot;</span> =<span class="st"> </span>obj<span class="op">$</span>deviance, </span>
<span id="cb30-11"><a href="3-Chapter_2.html#cb30-11"></a>              <span class="co">#&quot;AIC(L2)&quot; = aic, </span></span>
<span id="cb30-12"><a href="3-Chapter_2.html#cb30-12"></a>              <span class="st">&quot;BIC&quot;</span> =<span class="st"> </span>bic, </span>
<span id="cb30-13"><a href="3-Chapter_2.html#cb30-13"></a>              <span class="st">&quot;Delta&quot;</span> =<span class="st"> </span>delta, </span>
<span id="cb30-14"><a href="3-Chapter_2.html#cb30-14"></a>              <span class="st">&quot;p&quot;</span> =<span class="st"> </span>p)</span>
<span id="cb30-15"><a href="3-Chapter_2.html#cb30-15"></a>  <span class="kw">return</span>(result)</span>
<span id="cb30-16"><a href="3-Chapter_2.html#cb30-16"></a>  }</span></code></pre></div>
<ul>
<li>独立モデル</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="3-Chapter_2.html#cb31-1"></a><span class="co">#  1. O: Independence/Null Association Model</span></span>
<span id="cb31-2"><a href="3-Chapter_2.html#cb31-2"></a>O &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam, </span>
<span id="cb31-3"><a href="3-Chapter_2.html#cb31-3"></a>                           <span class="dt">family =</span> poisson, </span>
<span id="cb31-4"><a href="3-Chapter_2.html#cb31-4"></a>                           <span class="dt">data =</span> ., </span>
<span id="cb31-5"><a href="3-Chapter_2.html#cb31-5"></a>                           <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb31-6"><a href="3-Chapter_2.html#cb31-6"></a><span class="kw">summary</span>(O)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam, family = poisson, data = ., 
    tolerance = 1e-12)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.7415  -2.5344  -0.4283   1.5557   5.8265  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.06035    0.10115  30.256  &lt; 2e-16 ***
polviews2    1.34491    0.10657  12.620  &lt; 2e-16 ***
polviews3    1.33784    0.10664  12.545  &lt; 2e-16 ***
polviews4    2.46825    0.09886  24.968  &lt; 2e-16 ***
polviews5    1.56899    0.10433  15.038  &lt; 2e-16 ***
polviews6    1.56711    0.10435  15.018  &lt; 2e-16 ***
polviews7   -0.06514    0.13647  -0.477    0.633    
fefam2       0.81947    0.04669  17.553  &lt; 2e-16 ***
fefam3       0.38044    0.05047   7.538 4.76e-14 ***
fefam4      -0.75396    0.06876 -10.965  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 211.7 on 18 degrees of freedom
AIC: 403.05

Number of iterations: 5</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="3-Chapter_2.html#cb33-1"></a><span class="kw">model.summary</span>(O)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Desctiption`    df    L2   BIC Delta        p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 O                      18  212.  65.1  8.09 4.54e-35</code></pre>
<ul>
<li>一様連関モデル</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="3-Chapter_2.html#cb35-1"></a><span class="co"># 2. U: Uniform Association Model</span></span>
<span id="cb35-2"><a href="3-Chapter_2.html#cb35-2"></a>U &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Cscore, </span>
<span id="cb35-3"><a href="3-Chapter_2.html#cb35-3"></a>                           <span class="dt">family =</span> poisson, </span>
<span id="cb35-4"><a href="3-Chapter_2.html#cb35-4"></a>                           <span class="dt">data =</span> ., </span>
<span id="cb35-5"><a href="3-Chapter_2.html#cb35-5"></a>                           <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb35-6"><a href="3-Chapter_2.html#cb35-6"></a><span class="kw">summary</span>(U)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + Rscore:Cscore, family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.62563  -0.41050  -0.06989   0.53746   1.67998  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    3.47979    0.10109  34.422  &lt; 2e-16 ***
polviews2      0.95906    0.10934   8.771  &lt; 2e-16 ***
polviews3      0.53993    0.11884   4.543 5.54e-06 ***
polviews4      1.23013    0.12993   9.468  &lt; 2e-16 ***
polviews5     -0.13911    0.15936  -0.873 0.382733    
polviews6     -0.64184    0.19196  -3.344 0.000827 ***
polviews7     -2.80636    0.24740 -11.344  &lt; 2e-16 ***
fefam2         0.05148    0.07139   0.721 0.470857    
fefam3        -1.23188    0.12922  -9.533  &lt; 2e-16 ***
fefam4        -3.28436    0.20609 -15.936  &lt; 2e-16 ***
Rscore:Cscore  0.20211    0.01520  13.299  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 20.125 on 17 degrees of freedom
AIC: 213.48

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="3-Chapter_2.html#cb37-1"></a><span class="kw">model.summary</span>(U)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Desctiption`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 U                      17  20.1 -118.  2.77 0.268</code></pre>
<ul>
<li>行効果モデル</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="3-Chapter_2.html#cb39-1"></a><span class="co"># 3. R: Row Effect Model</span></span>
<span id="cb39-2"><a href="3-Chapter_2.html#cb39-2"></a><span class="co"># contrast</span></span>
<span id="cb39-3"><a href="3-Chapter_2.html#cb39-3"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor =</span> <span class="st">&quot;contr.sum&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.treatment&quot;</span>))</span>
<span id="cb39-4"><a href="3-Chapter_2.html#cb39-4"></a>R &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span></span>
<span id="cb39-5"><a href="3-Chapter_2.html#cb39-5"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>Cscore<span class="op">*</span>polviews, </span>
<span id="cb39-6"><a href="3-Chapter_2.html#cb39-6"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb39-7"><a href="3-Chapter_2.html#cb39-7"></a>      <span class="dt">data =</span> ., </span>
<span id="cb39-8"><a href="3-Chapter_2.html#cb39-8"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb39-9"><a href="3-Chapter_2.html#cb39-9"></a><span class="kw">summary</span>(R)</span></code></pre></div>
<pre><code>
Call:

gnm(formula = Freq ~ polviews + fefam + Cscore * polviews, family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5962  -0.4603   0.0477   0.3840   1.5700  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       4.262045   0.029618 143.902  &lt; 2e-16 ***
polviews1         0.040378   0.222896   0.181   0.8562    
polviews2         1.088684   0.130977   8.312  &lt; 2e-16 ***
polviews3         0.763635   0.132427   5.766 8.09e-09 ***
polviews4         1.335170   0.096565  13.827  &lt; 2e-16 ***
polviews5         0.197587   0.127059   1.555   0.1199    
polviews6        -0.558409   0.134998  -4.136 3.53e-05 ***
fefam1           -0.112887   0.046238  -2.441   0.0146 *  
fefam2            0.758505   0.030086  25.211  &lt; 2e-16 ***
fefam3            0.295555   0.032630   9.058  &lt; 2e-16 ***
Cscore            0.000000         NA      NA       NA    
polviews1:Cscore -0.558727   0.107668  -5.189 2.11e-07 ***
polviews2:Cscore -0.405076   0.059149  -6.848 7.47e-12 ***
polviews3:Cscore -0.248459   0.057741  -4.303 1.69e-05 ***
polviews4:Cscore  0.008764   0.039709   0.221   0.8253    
polviews5:Cscore  0.112245   0.051284   2.189   0.0286 *  
polviews6:Cscore  0.419079   0.051434   8.148  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 15.906 on 12 degrees of freedom
AIC: 219.26

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="3-Chapter_2.html#cb41-1"></a><span class="kw">model.summary</span>(R)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Desctiption`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 R                      12  15.9 -81.8  2.47 0.196</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="3-Chapter_2.html#cb43-1"></a><span class="co"># alternative (default)</span></span>
<span id="cb43-2"><a href="3-Chapter_2.html#cb43-2"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor =</span> <span class="st">&quot;contr.treatment&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb43-3"><a href="3-Chapter_2.html#cb43-3"></a>Ralt &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span></span>
<span id="cb43-4"><a href="3-Chapter_2.html#cb43-4"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>Cscore<span class="op">*</span>polviews, </span>
<span id="cb43-5"><a href="3-Chapter_2.html#cb43-5"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb43-6"><a href="3-Chapter_2.html#cb43-6"></a>      <span class="dt">data =</span> ., </span>
<span id="cb43-7"><a href="3-Chapter_2.html#cb43-7"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb43-8"><a href="3-Chapter_2.html#cb43-8"></a><span class="kw">summary</span>(Ralt)</span></code></pre></div>
<pre><code>
Call:

gnm(formula = Freq ~ polviews + fefam + Cscore * polviews, family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5962  -0.4603   0.0477   0.3840   1.5700  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        3.6308     0.1443  25.160  &lt; 2e-16 ***
polviews2          1.0483     0.2801   3.742 0.000182 ***
polviews3          0.7233     0.2818   2.567 0.010258 *  
polviews4          1.2948     0.2617   4.947 7.52e-07 ***
polviews5          0.1572     0.2798   0.562 0.574154    
polviews6         -0.5988     0.2859  -2.094 0.036244 *  
polviews7         -2.9074     0.4145  -7.015 2.30e-12 ***
fefam2             0.3127     0.1265   2.471 0.013455 *  
fefam3            -0.7090     0.2447  -2.897 0.003763 ** 
fefam4            -2.5045     0.3703  -6.763 1.36e-11 ***
Cscore             0.0000         NA      NA       NA    
polviews2:Cscore   0.1537     0.1362   1.128 0.259246    
polviews3:Cscore   0.3103     0.1357   2.287 0.022191 *  
polviews4:Cscore   0.5675     0.1268   4.477 7.58e-06 ***
polviews5:Cscore   0.6710     0.1326   5.059 4.21e-07 ***
polviews6:Cscore   0.9778     0.1331   7.346 2.04e-13 ***
polviews7:Cscore   1.2309     0.1678   7.335 2.22e-13 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 15.906 on 12 degrees of freedom
AIC: 219.26

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="3-Chapter_2.html#cb45-1"></a><span class="kw">model.summary</span>(Ralt)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Desctiption`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Ralt                   12  15.9 -81.8  2.47 0.196</code></pre>
<ul>
<li>列効果モデル</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="3-Chapter_2.html#cb47-1"></a><span class="co"># 4. C: Column Effect Model</span></span>
<span id="cb47-2"><a href="3-Chapter_2.html#cb47-2"></a><span class="co"># contrast</span></span>
<span id="cb47-3"><a href="3-Chapter_2.html#cb47-3"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor =</span> <span class="st">&quot;contr.sum&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.treatment&quot;</span>))</span>
<span id="cb47-4"><a href="3-Chapter_2.html#cb47-4"></a>C &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-5"><a href="3-Chapter_2.html#cb47-5"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>Rscore<span class="op">*</span>fefam, <span class="dt">family =</span> poisson, </span>
<span id="cb47-6"><a href="3-Chapter_2.html#cb47-6"></a>      <span class="dt">data =</span> ., </span>
<span id="cb47-7"><a href="3-Chapter_2.html#cb47-7"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb47-8"><a href="3-Chapter_2.html#cb47-8"></a><span class="kw">summary</span>(C)</span></code></pre></div>
<pre><code>
Call:

gnm(formula = Freq ~ polviews + fefam + Rscore * fefam, family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7572  -0.4920   0.1628   0.4922   1.4247  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    4.26735    0.02842 150.161  &lt; 2e-16 ***
polviews1     -1.34764    0.08885 -15.167  &lt; 2e-16 ***
polviews2      0.10725    0.05058   2.120 0.033978 *  
polviews3      0.17817    0.04852   3.672 0.000241 ***
polviews4      1.35465    0.03449  39.280  &lt; 2e-16 ***
polviews5      0.47060    0.04547  10.349  &lt; 2e-16 ***
polviews6      0.45489    0.04714   9.650  &lt; 2e-16 ***
fefam1         1.16938    0.10545  11.089  &lt; 2e-16 ***
fefam2         1.01794    0.08835  11.521  &lt; 2e-16 ***
fefam3        -0.27421    0.10365  -2.646 0.008155 ** 
Rscore         0.00000         NA      NA       NA    
fefam1:Rscore -0.32183    0.02601 -12.373  &lt; 2e-16 ***
fefam2:Rscore -0.06518    0.02013  -3.238 0.001203 ** 
fefam3:Rscore  0.13740    0.02282   6.021 1.73e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 14.237 on 15 degrees of freedom
AIC: 211.59

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="3-Chapter_2.html#cb49-1"></a><span class="kw">model.summary</span>(C)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 C                      15  14.2 -108.  2.32 0.492</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="3-Chapter_2.html#cb51-1"></a><span class="co"># alternative (default)</span></span>
<span id="cb51-2"><a href="3-Chapter_2.html#cb51-2"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor =</span> <span class="st">&quot;contr.treatment&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb51-3"><a href="3-Chapter_2.html#cb51-3"></a>Calt &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-4"><a href="3-Chapter_2.html#cb51-4"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>Rscore<span class="op">*</span>fefam, <span class="dt">family =</span> poisson, <span class="dt">data =</span> ., <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb51-5"><a href="3-Chapter_2.html#cb51-5"></a><span class="kw">summary</span>(Calt)</span></code></pre></div>
<pre><code>
Call:

gnm(formula = Freq ~ polviews + fefam + Rscore * fefam, family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7572  -0.4920   0.1628   0.4922   1.4247  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    3.76726    0.11222  33.571  &lt; 2e-16 ***
polviews2      1.13306    0.10785  10.506  &lt; 2e-16 ***
polviews3      0.88215    0.11310   7.800  &lt; 2e-16 ***
polviews4      1.73680    0.11708  14.834  &lt; 2e-16 ***
polviews5      0.53092    0.13848   3.834 0.000126 ***
polviews6      0.19337    0.16048   1.205 0.228239    
polviews7     -1.80128    0.20632  -8.730  &lt; 2e-16 ***
fefam2        -0.15144    0.13618  -1.112 0.266095    
fefam3        -1.44359    0.15929  -9.063  &lt; 2e-16 ***
fefam4        -3.08249    0.23741 -12.984  &lt; 2e-16 ***
Rscore         0.00000         NA      NA       NA    
fefam2:Rscore  0.25665    0.03459   7.421 1.17e-13 ***
fefam3:Rscore  0.45924    0.03851  11.926  &lt; 2e-16 ***
fefam4:Rscore  0.57144    0.05297  10.788  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 14.237 on 15 degrees of freedom
AIC: 211.59

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="3-Chapter_2.html#cb53-1"></a><span class="kw">model.summary</span>(Calt)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Desctiption`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Calt                   15  14.2 -108.  2.32 0.508</code></pre>
<ul>
<li>行・列効果モデル（<span class="math inline">\(R+C\)</span>）</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="3-Chapter_2.html#cb55-1"></a><span class="co"># コントラスト</span></span>
<span id="cb55-2"><a href="3-Chapter_2.html#cb55-2"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor =</span> <span class="st">&quot;contr.treatment&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.treatment&quot;</span>))</span>
<span id="cb55-3"><a href="3-Chapter_2.html#cb55-3"></a></span>
<span id="cb55-4"><a href="3-Chapter_2.html#cb55-4"></a><span class="co"># 5. R+C: Row and Column Effect Model</span></span>
<span id="cb55-5"><a href="3-Chapter_2.html#cb55-5"></a><span class="co"># 収束しない</span></span>
<span id="cb55-6"><a href="3-Chapter_2.html#cb55-6"></a>RplusCno &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb55-7"><a href="3-Chapter_2.html#cb55-7"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>polviews <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>fefam,</span>
<span id="cb55-8"><a href="3-Chapter_2.html#cb55-8"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb55-9"><a href="3-Chapter_2.html#cb55-9"></a>      <span class="dt">data =</span> ., </span>
<span id="cb55-10"><a href="3-Chapter_2.html#cb55-10"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb55-11"><a href="3-Chapter_2.html#cb55-11"></a></span>
<span id="cb55-12"><a href="3-Chapter_2.html#cb55-12"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb55-13"><a href="3-Chapter_2.html#cb55-13"></a><span class="kw">data.frame</span>(<span class="dt">var =</span> <span class="kw">names</span>(RplusCno<span class="op">$</span>coefficients),</span>
<span id="cb55-14"><a href="3-Chapter_2.html#cb55-14"></a>           <span class="dt">estimate =</span> RplusCno<span class="op">$</span>coefficients) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb55-15"><a href="3-Chapter_2.html#cb55-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> estimate,</span>
<span id="cb55-16"><a href="3-Chapter_2.html#cb55-16"></a>         <span class="dt">number =</span> <span class="kw">row_number</span>())</span></code></pre></div>
<pre><code>                var      estimate number
1       (Intercept) -1.080034e+13      1
2         polviews2  1.440045e+13      2
3         polviews3  2.880091e+13      3
4         polviews4  4.320136e+13      4
5         polviews5  5.760181e+13      5
6         polviews6  7.200226e+13      6
7         polviews7  8.640272e+13      7
8            fefam2 -2.520079e+13      8
9            fefam3 -5.040159e+13      9
10           fefam4 -7.560238e+13     10
11 polviews1:Cscore  2.160068e+13     11
12 polviews2:Cscore  1.800057e+13     12
13 polviews3:Cscore  1.440045e+13     13
14 polviews4:Cscore  1.080034e+13     14
15 polviews5:Cscore  7.200226e+12     15
16 polviews6:Cscore  3.600113e+12     16
17 polviews7:Cscore            NA     17
18    fefam1:Rscore -1.080034e+13     18
19    fefam2:Rscore -7.200226e+12     19
20    fefam3:Rscore -3.600113e+12     20
21    fefam4:Rscore            NA     21</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="3-Chapter_2.html#cb57-1"></a><span class="co"># polviews1:Cscore(11) = polviews7:Cscore(17) = fefam1:Rscore(18) = 0</span></span>
<span id="cb57-2"><a href="3-Chapter_2.html#cb57-2"></a>RplusC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb57-3"><a href="3-Chapter_2.html#cb57-3"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>polviews <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>fefam,</span>
<span id="cb57-4"><a href="3-Chapter_2.html#cb57-4"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">17</span>,<span class="dv">18</span>), </span>
<span id="cb57-5"><a href="3-Chapter_2.html#cb57-5"></a>      <span class="dt">constrainTo =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb57-6"><a href="3-Chapter_2.html#cb57-6"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb57-7"><a href="3-Chapter_2.html#cb57-7"></a>      <span class="dt">data =</span> ., </span>
<span id="cb57-8"><a href="3-Chapter_2.html#cb57-8"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb57-9"><a href="3-Chapter_2.html#cb57-9"></a><span class="kw">summary</span>(RplusC)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + Cscore:polviews + Rscore:fefam, 
    constrain = c(11, 17, 18), constrainTo = c(0, 0, 0), family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.07536  -0.33353   0.01859   0.37548   1.05912  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.69896    0.14301  25.866  &lt; 2e-16 ***
polviews2         1.27521    0.25278   5.045 4.54e-07 ***
polviews3         1.15849    0.24328   4.762 1.92e-06 ***
polviews4         1.91613    0.21048   9.104  &lt; 2e-16 ***
polviews5         0.92939    0.22891   4.060 4.91e-05 ***
polviews6         0.26063    0.24331   1.071   0.2841    
polviews7        -2.01888    0.30512  -6.617 3.67e-11 ***
fefam2           -0.11089    0.17635  -0.629   0.5295    
fefam3           -1.28476    0.28350  -4.532 5.85e-06 ***
fefam4           -2.75218    0.43313  -6.354 2.10e-10 ***
polviews1:Cscore  0.00000         NA      NA       NA    
polviews2:Cscore -0.08578    0.11437  -0.750   0.4532    
polviews3:Cscore -0.15923    0.10585  -1.504   0.1325    
polviews4:Cscore -0.12164    0.09246  -1.316   0.1883    
polviews5:Cscore -0.22243    0.10510  -2.116   0.0343 *  
polviews6:Cscore -0.09452    0.11454  -0.825   0.4092    
polviews7:Cscore  0.00000         NA      NA       NA    
fefam1:Rscore     0.00000         NA      NA       NA    
fefam2:Rscore     0.27936    0.04372   6.389 1.67e-10 ***
fefam3:Rscore     0.48417    0.06239   7.761  &lt; 2e-16 ***
fefam4:Rscore     0.58586    0.08655   6.769 1.30e-11 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 7.6783 on 10 degrees of freedom
AIC: 215.03

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="3-Chapter_2.html#cb59-1"></a><span class="kw">model.summary</span>(RplusC)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Desctiption`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 RplusC                 10  7.68 -73.8  1.77 0.660</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="3-Chapter_2.html#cb61-1"></a><span class="co"># 5. R+C: Row and Column Effect Model (Alternative)</span></span>
<span id="cb61-2"><a href="3-Chapter_2.html#cb61-2"></a>RplusCalt &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-3"><a href="3-Chapter_2.html#cb61-3"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Cscore <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>polviews <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>fefam,</span>
<span id="cb61-4"><a href="3-Chapter_2.html#cb61-4"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb61-5"><a href="3-Chapter_2.html#cb61-5"></a>      <span class="dt">data =</span> ., </span>
<span id="cb61-6"><a href="3-Chapter_2.html#cb61-6"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb61-7"><a href="3-Chapter_2.html#cb61-7"></a>RplusCalt</span></code></pre></div>
<pre><code>
Call:

gnm(formula = Freq ~ polviews + fefam + Rscore:Cscore + Cscore:polviews + 
    Rscore:fefam, family = poisson, data = ., tolerance = 1e-12)

Coefficients:
     (Intercept)         polviews2         polviews3         polviews4  
         3.50368           1.07992           0.76791           1.33027  
       polviews5         polviews6         polviews7            fefam2  
         0.14824          -0.71581          -3.19061          -0.11089  
          fefam3            fefam4     Rscore:Cscore  polviews2:Cscore  
        -1.28476          -2.75218           0.19529          -0.08578  
polviews3:Cscore  polviews4:Cscore  polviews5:Cscore  polviews6:Cscore  
        -0.15923          -0.12164          -0.22243          -0.09452  
polviews7:Cscore     fefam2:Rscore     fefam3:Rscore     fefam4:Rscore  
              NA           0.08407           0.09360                NA  

Deviance:            7.678265 
Pearson chi-squared: 7.790921 
Residual df:         10 </code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="3-Chapter_2.html#cb63-1"></a><span class="kw">summary</span>(RplusCalt)</span></code></pre></div>
<pre><code>
Call:

gnm(formula = Freq ~ polviews + fefam + Rscore:Cscore + Cscore:polviews + 
    Rscore:fefam, family = poisson, data = ., tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.07536  -0.33353   0.01859   0.37548   1.05912  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.50368    0.13171  26.601  &lt; 2e-16 ***
polviews2         1.07992    0.26750   4.037 5.41e-05 ***
polviews3         0.76791    0.27072   2.837  0.00456 ** 
polviews4         1.33027    0.25273   5.264 1.41e-07 ***
polviews5         0.14824    0.27598   0.537  0.59116    
polviews6        -0.71581    0.29336  -2.440  0.01469 *  
polviews7        -3.19061    0.44608  -7.153 8.52e-13 ***
fefam2           -0.11089    0.17635  -0.629  0.52949    
fefam3           -1.28476    0.28350  -4.532 5.85e-06 ***
fefam4           -2.75218    0.43313  -6.354 2.10e-10 ***
Rscore:Cscore     0.19529    0.02885   6.769 1.30e-11 ***
polviews2:Cscore -0.08578    0.11437  -0.750  0.45321    
polviews3:Cscore -0.15923    0.10585  -1.504  0.13250    
polviews4:Cscore -0.12164    0.09246  -1.316  0.18831    
polviews5:Cscore -0.22243    0.10510  -2.116  0.03431 *  
polviews6:Cscore -0.09452    0.11454  -0.825  0.40923    
polviews7:Cscore  0.00000         NA      NA       NA    
fefam2:Rscore     0.08407    0.03224   2.607  0.00912 ** 
fefam3:Rscore     0.09360    0.03861   2.424  0.01535 *  
fefam4:Rscore     0.00000         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 7.6783 on 10 degrees of freedom
AIC: 215.03

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="3-Chapter_2.html#cb65-1"></a><span class="kw">model.summary</span>(RplusCalt)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Desctiption`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 RplusCalt              10  7.68 -73.8  1.77 0.660</code></pre>
<ul>
<li>行・列効果モデル（<span class="math inline">\(RC(1)\)</span>）</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="3-Chapter_2.html#cb67-1"></a><span class="co"># 6. RC: RC(1) model</span></span>
<span id="cb67-2"><a href="3-Chapter_2.html#cb67-2"></a>RC.un &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span></span>
<span id="cb67-3"><a href="3-Chapter_2.html#cb67-3"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam),</span>
<span id="cb67-4"><a href="3-Chapter_2.html#cb67-4"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb67-5"><a href="3-Chapter_2.html#cb67-5"></a>      <span class="dt">data =</span> ., </span>
<span id="cb67-6"><a href="3-Chapter_2.html#cb67-6"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations........................
Done</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="3-Chapter_2.html#cb69-1"></a><span class="kw">summary</span>(RC.un)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), 
    family = poisson, data = ., tolerance = 1e-12)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-5.747  -2.602  -0.122   1.493   5.667  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                  -2.3942     3.0304   -0.79    0.429
polviews1                     0.0000         NA      NA       NA
polviews2                     0.0000         NA      NA       NA
polviews3                     0.0000         NA      NA       NA
polviews4                     0.0000         NA      NA       NA
polviews5                     0.0000         NA      NA       NA
polviews6                     0.0000         NA      NA       NA
fefam1                        0.0000         NA      NA       NA
fefam2                        0.0000         NA      NA       NA
fefam3                        0.0000         NA      NA       NA
Mult(., polviews, fefam).    40.0498         NA      NA       NA
Mult(1, ., fefam).polviews1   0.5169         NA      NA       NA
Mult(1, ., fefam).polviews2   0.6354         NA      NA       NA
Mult(1, ., fefam).polviews3   0.6354         NA      NA       NA
Mult(1, ., fefam).polviews4   0.7346         NA      NA       NA
Mult(1, ., fefam).polviews5   0.6556         NA      NA       NA
Mult(1, ., fefam).polviews6   0.6547         NA      NA       NA
Mult(1, ., fefam).polviews7   0.5093         NA      NA       NA
Mult(1, polviews, .).fefam1   0.2678         NA      NA       NA
Mult(1, polviews, .).fefam2   0.2985         NA      NA       NA
Mult(1, polviews, .).fefam3   0.2822         NA      NA       NA
Mult(1, polviews, .).fefam4   0.2400         NA      NA       NA

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 205.53 on 17 degrees of freedom
AIC: 398.89

Number of iterations: 24</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="3-Chapter_2.html#cb71-1"></a><span class="kw">model.summary</span>(RC.un)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 RC.un                  17  206.  67.1  7.53     1</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="3-Chapter_2.html#cb73-1"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb73-2"><a href="3-Chapter_2.html#cb73-2"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RC.un, <span class="kw">pickCoef</span>(RC.un, <span class="st">&quot;[.]polviews&quot;</span>), </span>
<span id="cb73-3"><a href="3-Chapter_2.html#cb73-3"></a>                   <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb73-4"><a href="3-Chapter_2.html#cb73-4"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb73-5"><a href="3-Chapter_2.html#cb73-5"></a>                   <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb73-6"><a href="3-Chapter_2.html#cb73-6"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb73-7"><a href="3-Chapter_2.html#cb73-7"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RC.un, <span class="kw">pickCoef</span>(RC.un, <span class="st">&quot;[.]fefam&quot;</span>), </span>
<span id="cb73-8"><a href="3-Chapter_2.html#cb73-8"></a>                   <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb73-9"><a href="3-Chapter_2.html#cb73-9"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb73-10"><a href="3-Chapter_2.html#cb73-10"></a>                   <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb73-11"><a href="3-Chapter_2.html#cb73-11"></a></span>
<span id="cb73-12"><a href="3-Chapter_2.html#cb73-12"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], nu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span>
<span id="cb73-13"><a href="3-Chapter_2.html#cb73-13"></a></span>
<span id="cb73-14"><a href="3-Chapter_2.html#cb73-14"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb73-15"><a href="3-Chapter_2.html#cb73-15"></a>RC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb73-16"><a href="3-Chapter_2.html#cb73-16"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam), </span>
<span id="cb73-17"><a href="3-Chapter_2.html#cb73-17"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">22</span>),</span>
<span id="cb73-18"><a href="3-Chapter_2.html#cb73-18"></a>      <span class="dt">constrainTo =</span> con, </span>
<span id="cb73-19"><a href="3-Chapter_2.html#cb73-19"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb73-20"><a href="3-Chapter_2.html#cb73-20"></a>      <span class="dt">data =</span> ., </span>
<span id="cb73-21"><a href="3-Chapter_2.html#cb73-21"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
.....................
Done</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="3-Chapter_2.html#cb75-1"></a><span class="kw">summary</span>(RC)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), 
    constrain = c(12, 18, 19, 22), constrainTo = con, family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-8.8999  -3.2195  -0.9508   2.2304  15.7642  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  4.17523    0.04192  99.594  &lt; 2e-16 ***
polviews1                    0.00000         NA      NA       NA    
polviews2                    0.00000         NA      NA       NA    
polviews3                    0.00000         NA      NA       NA    
polviews4                    0.00000         NA      NA       NA    
polviews5                    0.00000         NA      NA       NA    
polviews6                    0.00000         NA      NA       NA    
fefam1                       0.00000         NA      NA       NA    
fefam2                       0.00000         NA      NA       NA    
fefam3                       0.00000         NA      NA       NA    
Mult(., polviews, fefam).   -0.47511    0.08406  -5.652 1.59e-08 ***
Mult(1, ., fefam).polviews1 -0.52357         NA      NA       NA    
Mult(1, ., fefam).polviews2  0.49888    0.09807   5.087 3.64e-07 ***
Mult(1, ., fefam).polviews3  0.56932    0.10547   5.398 6.74e-08 ***
Mult(1, ., fefam).polviews4  1.41803    0.21219   6.683 2.34e-11 ***
Mult(1, ., fefam).polviews5  0.79760    0.13190   6.047 1.48e-09 ***
Mult(1, ., fefam).polviews6  0.79214    0.13124   6.036 1.58e-09 ***
Mult(1, ., fefam).polviews7 -0.56220         NA      NA       NA    
Mult(1, polviews, .).fefam1 -0.09996         NA      NA       NA    
Mult(1, polviews, .).fefam2 -3.32629    0.53813  -6.181 6.36e-10 ***
Mult(1, polviews, .).fefam3 -2.50844    0.40021  -6.268 3.66e-10 ***
Mult(1, polviews, .).fefam4 -0.74751         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 733.68 on 19 degrees of freedom
AIC: 923.04

Number of iterations: 78</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="3-Chapter_2.html#cb77-1"></a>mu</span></code></pre></div>
<pre><code>                               Estimate Std. Error
Mult(1, ., fefam).polviews1 -0.52357082 0.03172837
Mult(1, ., fefam).polviews2  0.07674377 0.02033442
Mult(1, ., fefam).polviews3  0.07633523 0.02034655
Mult(1, ., fefam).polviews4  0.57936185 0.01524757
Mult(1, ., fefam).polviews5  0.17888661 0.01749183
Mult(1, ., fefam).polviews6  0.17444134 0.01760544
Mult(1, ., fefam).polviews7 -0.56219798 0.03063124</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="3-Chapter_2.html#cb79-1"></a>nu</span></code></pre></div>
<pre><code>                               Estimate Std. Error
Mult(1, polviews, .).fefam1 -0.09995874 0.03056455
Mult(1, polviews, .).fefam2  0.61364007 0.01826753
Mult(1, polviews, .).fefam3  0.23383227 0.02279237
Mult(1, polviews, .).fefam4 -0.74751360 0.01530326</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="3-Chapter_2.html#cb81-1"></a><span class="kw">model.summary</span>(RC)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 RC                     19  734.  579.  13.8     1</code></pre>
</div>
<div id="表2.4a" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> 表2.4A</h2>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="3-Chapter_2.html#cb83-1"></a>models &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb83-2"><a href="3-Chapter_2.html#cb83-2"></a>models[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(O)</span>
<span id="cb83-3"><a href="3-Chapter_2.html#cb83-3"></a>models[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(U)</span>
<span id="cb83-4"><a href="3-Chapter_2.html#cb83-4"></a>models[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(R)</span>
<span id="cb83-5"><a href="3-Chapter_2.html#cb83-5"></a>models[[<span class="dv">4</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(C)</span>
<span id="cb83-6"><a href="3-Chapter_2.html#cb83-6"></a>models[[<span class="dv">5</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(RplusC)</span>
<span id="cb83-7"><a href="3-Chapter_2.html#cb83-7"></a>models[[<span class="dv">6</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(RC)</span>
<span id="cb83-8"><a href="3-Chapter_2.html#cb83-8"></a>models <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 6
  `Model Desctiption`    df     L2    BIC Delta        p
  &lt;chr&gt;               &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 O                      18 212.     65.1  8.09 4.54e-35
2 U                      17  20.1  -118.   2.77 2.68e- 1
3 R                      12  15.9   -81.8  2.47 1.96e- 1
4 C                      15  14.2  -108.   2.32 5.08e- 1
5 RplusC                 10   7.68  -73.8  1.77 6.60e- 1
6 RC                     10   8.07  -73.4  1.77 6.22e- 1</code></pre>
</div>
<div id="表2.4b" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> 表2.4B</h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="3-Chapter_2.html#cb85-1"></a>model_comparison &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">y =</span> <span class="dv">0</span>) {</span>
<span id="cb85-2"><a href="3-Chapter_2.html#cb85-2"></a>  models <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span></span>
<span id="cb85-3"><a href="3-Chapter_2.html#cb85-3"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">Model Used</span><span class="st">`</span> =<span class="st"> </span></span>
<span id="cb85-4"><a href="3-Chapter_2.html#cb85-4"></a><span class="st">                </span><span class="kw">ifelse</span>(y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,<span class="kw">paste0</span>(x),<span class="kw">paste0</span>(x,<span class="st">&quot;-&quot;</span>,y)),</span>
<span id="cb85-5"><a href="3-Chapter_2.html#cb85-5"></a>              <span class="dt">df =</span> <span class="kw">ifelse</span>(y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, df[x], df[x] <span class="op">-</span><span class="st"> </span>df[y]),</span>
<span id="cb85-6"><a href="3-Chapter_2.html#cb85-6"></a>              <span class="dt">L2 =</span> <span class="kw">ifelse</span>(y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, L2[x], L2[x] <span class="op">-</span><span class="st"> </span>L2[y]),</span>
<span id="cb85-7"><a href="3-Chapter_2.html#cb85-7"></a>              <span class="dt">p =</span> <span class="kw">pchisq</span>(L2, df, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>))</span>
<span id="cb85-8"><a href="3-Chapter_2.html#cb85-8"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="3-Chapter_2.html#cb86-1"></a><span class="co"># Table 2.4 Panel B</span></span>
<span id="cb86-2"><a href="3-Chapter_2.html#cb86-2"></a><span class="kw">bind_rows</span>(<span class="kw">model_comparison</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb86-3"><a href="3-Chapter_2.html#cb86-3"></a>          <span class="kw">model_comparison</span>(<span class="dv">2</span>,<span class="dv">6</span>),</span>
<span id="cb86-4"><a href="3-Chapter_2.html#cb86-4"></a>          <span class="kw">model_comparison</span>(<span class="dv">6</span>),</span>
<span id="cb86-5"><a href="3-Chapter_2.html#cb86-5"></a>          <span class="kw">model_comparison</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code># A tibble: 4 x 4
  `Model Used`    df     L2        p
  &lt;chr&gt;        &lt;int&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1 1-2              1 192.   1.44e-43
2 2-6              7  12.1  9.88e- 2
3 6               10   8.07 6.22e- 1
4 1               18 212.   4.54e-35</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="3-Chapter_2.html#cb88-1"></a><span class="co"># Table 2.4 Panel C</span></span>
<span id="cb88-2"><a href="3-Chapter_2.html#cb88-2"></a><span class="kw">bind_rows</span>(<span class="kw">model_comparison</span>(<span class="dv">2</span>,<span class="dv">4</span>),</span>
<span id="cb88-3"><a href="3-Chapter_2.html#cb88-3"></a>          <span class="kw">model_comparison</span>(<span class="dv">4</span>,<span class="dv">6</span>),</span>
<span id="cb88-4"><a href="3-Chapter_2.html#cb88-4"></a>          <span class="kw">model_comparison</span>(<span class="dv">2</span>,<span class="dv">6</span>))</span></code></pre></div>
<pre><code># A tibble: 3 x 4
  `Model Used`    df    L2      p
  &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 2-4              2  5.89 0.0527
2 4-6              5  6.17 0.290 
3 2-6              7 12.1  0.0988</code></pre>
</div>
<div id="表2.5a" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> 表2.5A</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="3-Chapter_2.html#cb90-1"></a><span class="kw">summary</span>(U)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb90-2"><a href="3-Chapter_2.html#cb90-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb90-3"><a href="3-Chapter_2.html#cb90-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb90-4"><a href="3-Chapter_2.html#cb90-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore:Cscore&quot;</span>, Variable))</span></code></pre></div>
<pre><code>       Variable  Estimate Std..Error  z.value     Pr...z..
1 Rscore:Cscore 0.2021125 0.01519706 13.29945 2.331718e-40</code></pre>
<ul>
<li>表2.5B</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="3-Chapter_2.html#cb92-1"></a><span class="co"># Table 2.5 Panel B Alternative</span></span>
<span id="cb92-2"><a href="3-Chapter_2.html#cb92-2"></a><span class="kw">summary</span>(R)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb92-3"><a href="3-Chapter_2.html#cb92-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb92-4"><a href="3-Chapter_2.html#cb92-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb92-5"><a href="3-Chapter_2.html#cb92-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;:Cscore&quot;</span>, Variable))</span></code></pre></div>
<pre><code>          Variable     Estimate Std..Error    z.value     Pr...z..
1 polviews1:Cscore -0.558726563 0.10766840 -5.1893275 2.110549e-07
2 polviews2:Cscore -0.405075736 0.05914888 -6.8484091 7.467575e-12
3 polviews3:Cscore -0.248458921 0.05774110 -4.3029822 1.685144e-05
4 polviews4:Cscore  0.008763861 0.03970853  0.2207048 8.253223e-01
5 polviews5:Cscore  0.112245001 0.05128383  2.1887016 2.861853e-02
6 polviews6:Cscore  0.419078627 0.05143368  8.1479420 3.701697e-16</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="3-Chapter_2.html#cb94-1"></a><span class="co"># polviews7:Cscoreを求める</span></span>
<span id="cb94-2"><a href="3-Chapter_2.html#cb94-2"></a>mycontrast &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(<span class="kw">coef</span>(R)))</span>
<span id="cb94-3"><a href="3-Chapter_2.html#cb94-3"></a>terms &lt;-<span class="st"> </span><span class="kw">pickCoef</span>(R,<span class="st">&quot;[:]Cscore&quot;</span>)</span>
<span id="cb94-4"><a href="3-Chapter_2.html#cb94-4"></a>mycontrast[terms] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">6</span>)</span>
<span id="cb94-5"><a href="3-Chapter_2.html#cb94-5"></a>mycontrast &lt;-<span class="st"> </span><span class="kw">cbind</span>(mycontrast)</span>
<span id="cb94-6"><a href="3-Chapter_2.html#cb94-6"></a><span class="kw">colnames</span>(mycontrast) &lt;-<span class="st"> &quot;polviews7:Cscore&quot;</span></span>
<span id="cb94-7"><a href="3-Chapter_2.html#cb94-7"></a>gnm<span class="op">::</span><span class="kw">se</span>(R, mycontrast)</span></code></pre></div>
<pre><code>                  Estimate Std. Error
polviews7:Cscore 0.6721737  0.1003211</code></pre>
<ul>
<li>表2.5Bの別の方法</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="3-Chapter_2.html#cb96-1"></a><span class="co"># Table 2.5 Panel B Alternative</span></span>
<span id="cb96-2"><a href="3-Chapter_2.html#cb96-2"></a><span class="kw">summary</span>(Ralt)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb96-3"><a href="3-Chapter_2.html#cb96-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb96-4"><a href="3-Chapter_2.html#cb96-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb96-5"><a href="3-Chapter_2.html#cb96-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;:Cscore&quot;</span>, Variable))</span></code></pre></div>
<pre><code>          Variable  Estimate Std..Error  z.value     Pr...z..
1 polviews2:Cscore 0.1536508  0.1361941 1.128176 2.592458e-01
2 polviews3:Cscore 0.3102676  0.1356609 2.287082 2.219102e-02
3 polviews4:Cscore 0.5674904  0.1267654 4.476699 7.580590e-06
4 polviews5:Cscore 0.6709716  0.1326215 5.059297 4.208051e-07
5 polviews6:Cscore 0.9778052  0.1331060 7.346062 2.041319e-13
6 polviews7:Cscore 1.2309003  0.1678130 7.334954 2.217982e-13</code></pre>
<ul>
<li>表2.5C</li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="3-Chapter_2.html#cb98-1"></a><span class="co"># Table 2.5 Panel C</span></span>
<span id="cb98-2"><a href="3-Chapter_2.html#cb98-2"></a><span class="kw">summary</span>(C)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb98-3"><a href="3-Chapter_2.html#cb98-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb98-4"><a href="3-Chapter_2.html#cb98-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb98-5"><a href="3-Chapter_2.html#cb98-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;:Rscore&quot;</span>, Variable))</span></code></pre></div>
<pre><code>       Variable    Estimate Std..Error    z.value     Pr...z..
1 fefam1:Rscore -0.32183233 0.02601065 -12.373099 3.654449e-35
2 fefam2:Rscore -0.06518238 0.02012977  -3.238109 1.203247e-03
3 fefam3:Rscore  0.13740293 0.02281996   6.021174 1.731567e-09</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="3-Chapter_2.html#cb100-1"></a><span class="co"># fefam4:Rscoreを求める</span></span>
<span id="cb100-2"><a href="3-Chapter_2.html#cb100-2"></a>mycontrast &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(<span class="kw">coef</span>(C)))</span>
<span id="cb100-3"><a href="3-Chapter_2.html#cb100-3"></a>terms &lt;-<span class="st"> </span><span class="kw">pickCoef</span>(C,<span class="st">&quot;[:]Rscore&quot;</span>)</span>
<span id="cb100-4"><a href="3-Chapter_2.html#cb100-4"></a>mycontrast[terms] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb100-5"><a href="3-Chapter_2.html#cb100-5"></a>mycontrast &lt;-<span class="st"> </span><span class="kw">cbind</span>(mycontrast)</span>
<span id="cb100-6"><a href="3-Chapter_2.html#cb100-6"></a><span class="kw">colnames</span>(mycontrast) &lt;-<span class="st"> &quot;fefam4:Rscore&quot;</span></span>
<span id="cb100-7"><a href="3-Chapter_2.html#cb100-7"></a>gnm<span class="op">::</span><span class="kw">se</span>(C, mycontrast)</span></code></pre></div>
<pre><code>               Estimate Std. Error
fefam4:Rscore 0.2496118 0.03429697</code></pre>
<ul>
<li>表2.5Cの別の方法</li>
</ul>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="3-Chapter_2.html#cb102-1"></a><span class="co"># Table 2.5 Panel C</span></span>
<span id="cb102-2"><a href="3-Chapter_2.html#cb102-2"></a><span class="kw">summary</span>(Calt)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb102-3"><a href="3-Chapter_2.html#cb102-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb102-4"><a href="3-Chapter_2.html#cb102-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb102-5"><a href="3-Chapter_2.html#cb102-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;:Rscore&quot;</span>, Variable))</span></code></pre></div>
<pre><code>       Variable  Estimate Std..Error   z.value     Pr...z..
1 fefam2:Rscore 0.2566499 0.03458604  7.420624 1.165702e-13
2 fefam3:Rscore 0.4592353 0.03850703 11.926012 8.662502e-33
3 fefam4:Rscore 0.5714441 0.05297192 10.787680 3.935998e-27</code></pre>
<ul>
<li>表2.5R+C</li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="3-Chapter_2.html#cb104-1"></a><span class="co"># Table 2.5 Panel D</span></span>
<span id="cb104-2"><a href="3-Chapter_2.html#cb104-2"></a><span class="kw">summary</span>(RplusC)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb104-3"><a href="3-Chapter_2.html#cb104-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb104-4"><a href="3-Chapter_2.html#cb104-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb104-5"><a href="3-Chapter_2.html#cb104-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore|Cscore&quot;</span>, Variable))</span></code></pre></div>
<pre><code>           Variable    Estimate Std..Error    z.value     Pr...z..
1  polviews1:Cscore  0.00000000         NA         NA           NA
2  polviews2:Cscore -0.08578207 0.11436513 -0.7500719 4.532114e-01
3  polviews3:Cscore -0.15923097 0.10584890 -1.5043233 1.324981e-01
4  polviews4:Cscore -0.12164181 0.09246130 -1.3155970 1.883093e-01
5  polviews5:Cscore -0.22242867 0.10509647 -2.1164238 3.430878e-02
6  polviews6:Cscore -0.09452143 0.11453734 -0.8252455 4.092322e-01
7  polviews7:Cscore  0.00000000         NA         NA           NA
8     fefam1:Rscore  0.00000000         NA         NA           NA
9     fefam2:Rscore  0.27935717 0.04372418  6.3890770 1.668900e-10
10    fefam3:Rscore  0.48417258 0.06238681  7.7608170 8.438398e-15
11    fefam4:Rscore  0.58586364 0.08654948  6.7691179 1.295700e-11</code></pre>
<ul>
<li>表2.5R+Cの別の方法</li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="3-Chapter_2.html#cb106-1"></a><span class="kw">summary</span>(RplusCalt)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb106-2"><a href="3-Chapter_2.html#cb106-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb106-3"><a href="3-Chapter_2.html#cb106-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb106-4"><a href="3-Chapter_2.html#cb106-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore|Cscore&quot;</span>, Variable))</span></code></pre></div>
<pre><code>           Variable    Estimate Std..Error    z.value     Pr...z..
1     Rscore:Cscore  0.19528788 0.02884983  6.7691179 1.295700e-11
2  polviews2:Cscore -0.08578207 0.11436513 -0.7500719 4.532114e-01
3  polviews3:Cscore -0.15923097 0.10584890 -1.5043233 1.324981e-01
4  polviews4:Cscore -0.12164181 0.09246130 -1.3155970 1.883093e-01
5  polviews5:Cscore -0.22242867 0.10509647 -2.1164238 3.430878e-02
6  polviews6:Cscore -0.09452143 0.11453734 -0.8252455 4.092322e-01
7  polviews7:Cscore  0.00000000         NA         NA           NA
8     fefam2:Rscore  0.08406929 0.03224287  2.6073757 9.123918e-03
9     fefam3:Rscore  0.09359682 0.03861067  2.4241178 1.534563e-02
10    fefam4:Rscore  0.00000000         NA         NA           NA</code></pre>
<ul>
<li>表2.5RC</li>
</ul>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="3-Chapter_2.html#cb108-1"></a><span class="kw">summary</span>(RC)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb108-2"><a href="3-Chapter_2.html#cb108-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb108-3"><a href="3-Chapter_2.html#cb108-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb108-4"><a href="3-Chapter_2.html#cb108-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Mult&quot;</span>, Variable))</span></code></pre></div>
<pre><code>                      Variable    Estimate Std..Error   z.value     Pr...z..
1    Mult(., polviews, fefam). -0.47510902 0.08406071 -5.651975 1.586146e-08
2  Mult(1, ., fefam).polviews1 -0.52357082         NA        NA           NA
3  Mult(1, ., fefam).polviews2  0.49888199 0.09807009  5.086994 3.637827e-07
4  Mult(1, ., fefam).polviews3  0.56932492 0.10547086  5.397936 6.741206e-08
5  Mult(1, ., fefam).polviews4  1.41803416 0.21219124  6.682812 2.344003e-11
6  Mult(1, ., fefam).polviews5  0.79760377 0.13190332  6.046882 1.476762e-09
7  Mult(1, ., fefam).polviews6  0.79214489 0.13123933  6.035880 1.580983e-09
8  Mult(1, ., fefam).polviews7 -0.56219798         NA        NA           NA
9  Mult(1, polviews, .).fefam1 -0.09995874         NA        NA           NA
10 Mult(1, polviews, .).fefam2 -3.32628888 0.53813314 -6.181163 6.363091e-10
11 Mult(1, polviews, .).fefam3 -2.50844443 0.40020772 -6.267856 3.660525e-10
12 Mult(1, polviews, .).fefam4 -0.74751360         NA        NA           NA</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="3-Chapter_2.html#cb110-1"></a>mu</span></code></pre></div>
<pre><code>                               Estimate Std. Error
Mult(1, ., fefam).polviews1 -0.52357082 0.03172837
Mult(1, ., fefam).polviews2  0.07674377 0.02033442
Mult(1, ., fefam).polviews3  0.07633523 0.02034655
Mult(1, ., fefam).polviews4  0.57936185 0.01524757
Mult(1, ., fefam).polviews5  0.17888661 0.01749183
Mult(1, ., fefam).polviews6  0.17444134 0.01760544
Mult(1, ., fefam).polviews7 -0.56219798 0.03063124</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="3-Chapter_2.html#cb112-1"></a>nu</span></code></pre></div>
<pre><code>                               Estimate Std. Error
Mult(1, polviews, .).fefam1 -0.09995874 0.03056455
Mult(1, polviews, .).fefam2  0.61364007 0.01826753
Mult(1, polviews, .).fefam3  0.23383227 0.02279237
Mult(1, polviews, .).fefam4 -0.74751360 0.01530326</code></pre>
</div>
<div id="logmultパッケージの利用" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> logmultパッケージの利用</h2>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="3-Chapter_2.html#cb114-1"></a><span class="kw">library</span>(logmult)</span>
<span id="cb114-2"><a href="3-Chapter_2.html#cb114-2"></a>tab &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam, <span class="dt">data =</span> .)</span>
<span id="cb114-3"><a href="3-Chapter_2.html#cb114-3"></a><span class="kw">anoas</span>(tab)</span></code></pre></div>
<pre><code>Fitting independence model...
Fitting model with 1 dimension...
Initialising
Running start-up iterations..
Running main iterations...............
Done
Fitting model with 2 dimensions...
Initialising
Running start-up iterations..
Running main iterations.......................
Done
Fitting model with 3 dimensions...
Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
<pre><code>       Res. Df           Res. Dev     Dev./Indep. (%)    Dissim. (%)
Indep.      18 211.69508974175707 100.000000000000000 8.091710289647
RC(1)       10   8.07181892815000   3.812945750417103 1.767307927003
RC(2)        4   1.36909098846091   0.646727796157688 0.496392142971
RC(3)        0   0.00000000000002   0.000000000000009 0.000000000004
                      BIC                AIC Dev. Df
Indep.  65.12224155397629 175.69508974175707   NA NA
RC(1)  -73.35754117617266 -11.92818107185000 -204 -8
RC(2)  -31.20265305326816  -6.63090901153909   -7 -6
RC(3)    0.00000000000002   0.00000000000002   -1 -4</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="3-Chapter_2.html#cb117-1"></a>rc_fit &lt;-<span class="st"> </span><span class="kw">rc</span>(tab, <span class="dt">nd =</span> <span class="dv">1</span>, <span class="dt">se =</span> <span class="st">&quot;bootstrap&quot;</span>, <span class="dt">weighting =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb117-2"><a href="3-Chapter_2.html#cb117-2"></a>             <span class="dt">nreplicates =</span> <span class="dv">100</span>, <span class="dt">ncpus =</span> <span class="kw">getOption</span>(<span class="st">&quot;boot.ncpus&quot;</span>)</span>
<span id="cb117-3"><a href="3-Chapter_2.html#cb117-3"></a>             )</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...........
Done
Computing bootstrap standard errors...
.</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="3-Chapter_2.html#cb119-1"></a><span class="kw">summary</span>(rc_fit, <span class="dt">weighting =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>Call:

rc(tab = tab, nd = 1, weighting = &quot;none&quot;, se = &quot;bootstrap&quot;, nreplicates = 100, 
    ncpus = getOption(&quot;boot.ncpus&quot;))

Deviance Residuals:
    Min       1Q   Median       3Q      Max  
-1.0743  -0.2724   0.0304   0.3679   1.0372  

Association coefficients:
                Normalized   Adjusted  Std. error   Pr(&gt;|z|)     
Dim1              2.373307         NA      0.2525  &lt; 2.2e-16  ***
Dim1:polviews1    0.481654   0.742014      0.0768  3.651e-10  ***
Dim1:polviews2    0.375797   0.578936      0.0511  2.014e-13  ***
Dim1:polviews3    0.234430   0.361152      0.0521  6.738e-06  ***
Dim1:polviews4    0.016315   0.025134      0.0346   0.636856     
Dim1:polviews5   -0.077489  -0.119376      0.0471   0.099683  .  
Dim1:polviews6   -0.384247  -0.591953      0.0627  8.794e-10  ***
Dim1:polviews7   -0.646461  -0.995908      0.0665  &lt; 2.2e-16  ***
Dim1:fefam1       0.748118   1.152516      0.0240  &lt; 2.2e-16  ***
Dim1:fefam2       0.140976   0.217181      0.0432   0.001098  ** 
Dim1:fefam3      -0.332294  -0.511916      0.0484  6.398e-12  ***
Dim1:fefam4      -0.556800  -0.857781      0.0437  &lt; 2.2e-16  ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Normalization weights: none
Deviance:              8.071819
Pearson chi-squared:   8.168769
Dissimilarity index:   1.767308%
Residual df:           10
BIC:                   -73.35754
AIC:                   -11.92818</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="3-Chapter_2.html#cb121-1"></a><span class="kw">summary</span>(rc_fit, <span class="dt">weighting =</span> <span class="st">&quot;marginal&quot;</span>)</span></code></pre></div>
<pre><code>Call:

rc(tab = tab, nd = 1, weighting = &quot;none&quot;, se = &quot;bootstrap&quot;, nreplicates = 100, 
    ncpus = getOption(&quot;boot.ncpus&quot;))

Deviance Residuals:
    Min       1Q   Median       3Q      Max  
-1.0743  -0.2724   0.0304   0.3679   1.0372  

Association coefficients:
                Normalized  Adjusted
Dim1              0.256734        NA
Dim1:polviews1    1.820624    0.9225
Dim1:polviews2    1.415319    0.7171
Dim1:polviews3    0.874053    0.4429
Dim1:polviews4    0.038935    0.0197
Dim1:polviews5   -0.320222   -0.1623
Dim1:polviews6   -1.494737   -0.7574
Dim1:polviews7   -2.498701   -1.2661
Dim1:fefam1       1.657784    0.8400
Dim1:fefam2       0.191902    0.0972
Dim1:fefam3      -0.950760   -0.4817
Dim1:fefam4      -1.492808   -0.7564

No standard errors available
(jackknife and bootstrap disabled, or weighting changed since fitting).

Normalization weights: marginal
Deviance:              8.071819
Pearson chi-squared:   8.168769
Dissimilarity index:   1.767308%
Residual df:           10
BIC:                   -73.35754
AIC:                   -11.92818</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="3-Chapter_2.html#cb123-1"></a><span class="kw">se</span>(rc_fit)</span></code></pre></div>
<pre><code>$phi
          Dim1
[1,] 0.2524547

$row
, , 1

        Dim1
1 0.07684038
2 0.05114392
3 0.05207477
4 0.03455884
5 0.04706596
6 0.06268422
7 0.06646373


$col
, , 1

        Dim1
1 0.02401820
2 0.04318924
3 0.04836529
4 0.04368078</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="3-Chapter_2.html#cb125-1"></a><span class="co"># コントラスト</span></span>
<span id="cb125-2"><a href="3-Chapter_2.html#cb125-2"></a><span class="kw">options</span>(<span class="st">&#39;contrasts&#39;</span>)</span></code></pre></div>
<pre><code>$contrasts
           factor           ordered 
&quot;contr.treatment&quot; &quot;contr.treatment&quot; </code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="3-Chapter_2.html#cb127-1"></a><span class="co"># default</span></span>
<span id="cb127-2"><a href="3-Chapter_2.html#cb127-2"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor =</span> <span class="st">&quot;contr.treatment&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb127-3"><a href="3-Chapter_2.html#cb127-3"></a></span>
<span id="cb127-4"><a href="3-Chapter_2.html#cb127-4"></a><span class="co">## 表2.3B</span></span>
<span id="cb127-5"><a href="3-Chapter_2.html#cb127-5"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">518</span>,  <span class="dv">95</span>, <span class="dv">6</span>, <span class="dv">35</span>, <span class="dv">5</span>,</span>
<span id="cb127-6"><a href="3-Chapter_2.html#cb127-6"></a>         　 <span class="dv">81</span>,  <span class="dv">67</span>, <span class="dv">4</span>, <span class="dv">49</span>, <span class="dv">2</span>,</span>
<span id="cb127-7"><a href="3-Chapter_2.html#cb127-7"></a>          <span class="dv">452</span>,<span class="dv">1003</span>,<span class="dv">67</span>,<span class="dv">630</span>, <span class="dv">5</span>,</span>
<span id="cb127-8"><a href="3-Chapter_2.html#cb127-8"></a>           <span class="dv">71</span>, <span class="dv">157</span>,<span class="dv">37</span>,<span class="dv">562</span>,<span class="dv">12</span>)</span>
<span id="cb127-9"><a href="3-Chapter_2.html#cb127-9"></a></span>
<span id="cb127-10"><a href="3-Chapter_2.html#cb127-10"></a><span class="co"># データを表形式に変換</span></span>
<span id="cb127-11"><a href="3-Chapter_2.html#cb127-11"></a>tab_<span class="fl">2.3</span>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(Freq, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">5</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.table</span>()</span>
<span id="cb127-12"><a href="3-Chapter_2.html#cb127-12"></a><span class="kw">rownames</span>(tab_<span class="fl">2.3</span>B) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;College+&quot;</span>,</span>
<span id="cb127-13"><a href="3-Chapter_2.html#cb127-13"></a>                        <span class="st">&quot;Junior college&quot;</span>,</span>
<span id="cb127-14"><a href="3-Chapter_2.html#cb127-14"></a>                        <span class="st">&quot;High school&quot;</span>,</span>
<span id="cb127-15"><a href="3-Chapter_2.html#cb127-15"></a>                        <span class="st">&quot;&lt;High school&quot;</span>)</span>
<span id="cb127-16"><a href="3-Chapter_2.html#cb127-16"></a><span class="kw">colnames</span>(tab_<span class="fl">2.3</span>B) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Upper Nonmanual&quot;</span>,</span>
<span id="cb127-17"><a href="3-Chapter_2.html#cb127-17"></a>                        <span class="st">&quot;Lower Nonmanual&quot;</span>,</span>
<span id="cb127-18"><a href="3-Chapter_2.html#cb127-18"></a>                        <span class="st">&quot;Upper Manual&quot;</span>,</span>
<span id="cb127-19"><a href="3-Chapter_2.html#cb127-19"></a>                        <span class="st">&quot;Lower Nonmanual&quot;</span>,</span>
<span id="cb127-20"><a href="3-Chapter_2.html#cb127-20"></a>                        <span class="st">&quot;Farm&quot;</span>)</span>
<span id="cb127-21"><a href="3-Chapter_2.html#cb127-21"></a>tab_<span class="fl">2.3</span>B</span></code></pre></div>
<pre><code>               Upper Nonmanual Lower Nonmanual Upper Manual Lower Nonmanual
College+                   518              95            6              35
Junior college              81              67            4              49
High school                452            1003           67             630
&lt;High school                71             157           37             562
               Farm
College+          5
Junior college    2
High school       5
&lt;High school     12</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="3-Chapter_2.html#cb129-1"></a><span class="co"># 度数，行変数，列変数からなる集計データを作成</span></span>
<span id="cb129-2"><a href="3-Chapter_2.html#cb129-2"></a>Educ &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">k =</span> <span class="dv">5</span>)</span>
<span id="cb129-3"><a href="3-Chapter_2.html#cb129-3"></a>Occ &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">20</span>)</span>
<span id="cb129-4"><a href="3-Chapter_2.html#cb129-4"></a>freq_tab_<span class="fl">2.3</span>B &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, Educ, Occ)</span>
<span id="cb129-5"><a href="3-Chapter_2.html#cb129-5"></a>freq_tab_<span class="fl">2.3</span>B</span></code></pre></div>
<pre><code># A tibble: 20 x 3
    Freq Educ  Occ  
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
 1   518 1     1    
 2    95 1     2    
 3     6 1     3    
 4    35 1     4    
 5     5 1     5    
 6    81 2     1    
 7    67 2     2    
 8     4 2     3    
 9    49 2     4    
10     2 2     5    
11   452 3     1    
12  1003 3     2    
13    67 3     3    
14   630 3     4    
15     5 3     5    
16    71 4     1    
17   157 4     2    
18    37 4     3    
19   562 4     4    
20    12 4     5    </code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="3-Chapter_2.html#cb131-1"></a><span class="co"># 行変数と列変数の整数値を作成</span></span>
<span id="cb131-2"><a href="3-Chapter_2.html#cb131-2"></a>freq_tab_<span class="fl">2.3</span>B <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb131-3"><a href="3-Chapter_2.html#cb131-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Rscore =</span> <span class="kw">as.numeric</span>(Educ),</span>
<span id="cb131-4"><a href="3-Chapter_2.html#cb131-4"></a>         <span class="dt">Cscore =</span> <span class="kw">as.numeric</span>(Occ))</span>
<span id="cb131-5"><a href="3-Chapter_2.html#cb131-5"></a>freq_tab_<span class="fl">2.3</span>B</span></code></pre></div>
<pre><code># A tibble: 20 x 5
    Freq Educ  Occ   Rscore Cscore
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1   518 1     1          1      1
 2    95 1     2          1      2
 3     6 1     3          1      3
 4    35 1     4          1      4
 5     5 1     5          1      5
 6    81 2     1          2      1
 7    67 2     2          2      2
 8     4 2     3          2      3
 9    49 2     4          2      4
10     2 2     5          2      5
11   452 3     1          3      1
12  1003 3     2          3      2
13    67 3     3          3      3
14   630 3     4          3      4
15     5 3     5          3      5
16    71 4     1          4      1
17   157 4     2          4      2
18    37 4     3          4      3
19   562 4     4          4      4
20    12 4     5          4      5</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="3-Chapter_2.html#cb133-1"></a>O &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb133-2"><a href="3-Chapter_2.html#cb133-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ, </span>
<span id="cb133-3"><a href="3-Chapter_2.html#cb133-3"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb133-4"><a href="3-Chapter_2.html#cb133-4"></a>      <span class="dt">data =</span> ., </span>
<span id="cb133-5"><a href="3-Chapter_2.html#cb133-5"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb133-6"><a href="3-Chapter_2.html#cb133-6"></a></span>
<span id="cb133-7"><a href="3-Chapter_2.html#cb133-7"></a>U &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb133-8"><a href="3-Chapter_2.html#cb133-8"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Cscore, </span>
<span id="cb133-9"><a href="3-Chapter_2.html#cb133-9"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb133-10"><a href="3-Chapter_2.html#cb133-10"></a>      <span class="dt">data =</span> ., </span>
<span id="cb133-11"><a href="3-Chapter_2.html#cb133-11"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb133-12"><a href="3-Chapter_2.html#cb133-12"></a></span>
<span id="cb133-13"><a href="3-Chapter_2.html#cb133-13"></a>R &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb133-14"><a href="3-Chapter_2.html#cb133-14"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Cscore <span class="op">+</span><span class="st"> </span>Educ<span class="op">:</span>Cscore, </span>
<span id="cb133-15"><a href="3-Chapter_2.html#cb133-15"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb133-16"><a href="3-Chapter_2.html#cb133-16"></a>      <span class="dt">data =</span> ., </span>
<span id="cb133-17"><a href="3-Chapter_2.html#cb133-17"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb133-18"><a href="3-Chapter_2.html#cb133-18"></a></span>
<span id="cb133-19"><a href="3-Chapter_2.html#cb133-19"></a>C &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb133-20"><a href="3-Chapter_2.html#cb133-20"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Cscore <span class="op">+</span><span class="st"> </span>Occ<span class="op">:</span>Rscore, </span>
<span id="cb133-21"><a href="3-Chapter_2.html#cb133-21"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb133-22"><a href="3-Chapter_2.html#cb133-22"></a>      <span class="dt">data =</span> ., </span>
<span id="cb133-23"><a href="3-Chapter_2.html#cb133-23"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb133-24"><a href="3-Chapter_2.html#cb133-24"></a></span>
<span id="cb133-25"><a href="3-Chapter_2.html#cb133-25"></a>RplusC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb133-26"><a href="3-Chapter_2.html#cb133-26"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Cscore <span class="op">+</span><span class="st"> </span>Educ<span class="op">:</span>Cscore <span class="op">+</span><span class="st"> </span>Occ<span class="op">:</span>Rscore,</span>
<span id="cb133-27"><a href="3-Chapter_2.html#cb133-27"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">12</span>,<span class="dv">16</span>), </span>
<span id="cb133-28"><a href="3-Chapter_2.html#cb133-28"></a>      <span class="dt">constrainTo =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb133-29"><a href="3-Chapter_2.html#cb133-29"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb133-30"><a href="3-Chapter_2.html#cb133-30"></a>      <span class="dt">data =</span> ., </span>
<span id="cb133-31"><a href="3-Chapter_2.html#cb133-31"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb133-32"><a href="3-Chapter_2.html#cb133-32"></a></span>
<span id="cb133-33"><a href="3-Chapter_2.html#cb133-33"></a>RC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb133-34"><a href="3-Chapter_2.html#cb133-34"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb133-35"><a href="3-Chapter_2.html#cb133-35"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb133-36"><a href="3-Chapter_2.html#cb133-36"></a>      <span class="dt">data =</span> ., </span>
<span id="cb133-37"><a href="3-Chapter_2.html#cb133-37"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................
Done</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="3-Chapter_2.html#cb135-1"></a>UplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb135-2"><a href="3-Chapter_2.html#cb135-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Cscore <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb135-3"><a href="3-Chapter_2.html#cb135-3"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb135-4"><a href="3-Chapter_2.html#cb135-4"></a>      <span class="dt">data =</span> ., </span>
<span id="cb135-5"><a href="3-Chapter_2.html#cb135-5"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations..................................................
Done</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="3-Chapter_2.html#cb137-1"></a>RplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb137-2"><a href="3-Chapter_2.html#cb137-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Educ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb137-3"><a href="3-Chapter_2.html#cb137-3"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">12</span>),</span>
<span id="cb137-4"><a href="3-Chapter_2.html#cb137-4"></a>      <span class="dt">constrainTo =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb137-5"><a href="3-Chapter_2.html#cb137-5"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb137-6"><a href="3-Chapter_2.html#cb137-6"></a>      <span class="dt">data =</span> ., </span>
<span id="cb137-7"><a href="3-Chapter_2.html#cb137-7"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...............................
Done</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="3-Chapter_2.html#cb139-1"></a>CplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb139-2"><a href="3-Chapter_2.html#cb139-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb139-3"><a href="3-Chapter_2.html#cb139-3"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb139-4"><a href="3-Chapter_2.html#cb139-4"></a>      <span class="dt">data =</span> ., </span>
<span id="cb139-5"><a href="3-Chapter_2.html#cb139-5"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations..................................
Done</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="3-Chapter_2.html#cb141-1"></a>RplusCplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb141-2"><a href="3-Chapter_2.html#cb141-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Educ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb141-3"><a href="3-Chapter_2.html#cb141-3"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb141-4"><a href="3-Chapter_2.html#cb141-4"></a>      <span class="dt">data =</span> ., </span>
<span id="cb141-5"><a href="3-Chapter_2.html#cb141-5"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations............
Done</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="3-Chapter_2.html#cb143-1"></a>RC2 &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb143-2"><a href="3-Chapter_2.html#cb143-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">instances</span>(<span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),<span class="dv">2</span>),</span>
<span id="cb143-3"><a href="3-Chapter_2.html#cb143-3"></a>      <span class="dt">family =</span> poisson, <span class="dt">data =</span> ., <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.................
Done</code></pre>
</div>
<div id="表2.6a" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> 表2.6A</h2>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="3-Chapter_2.html#cb145-1"></a>models &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb145-2"><a href="3-Chapter_2.html#cb145-2"></a>models[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(O)</span>
<span id="cb145-3"><a href="3-Chapter_2.html#cb145-3"></a>models[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(U)</span>
<span id="cb145-4"><a href="3-Chapter_2.html#cb145-4"></a>models[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(R)</span>
<span id="cb145-5"><a href="3-Chapter_2.html#cb145-5"></a>models[[<span class="dv">4</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(C)</span>
<span id="cb145-6"><a href="3-Chapter_2.html#cb145-6"></a>models[[<span class="dv">5</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(RplusC)</span>
<span id="cb145-7"><a href="3-Chapter_2.html#cb145-7"></a>models[[<span class="dv">6</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(RC)</span>
<span id="cb145-8"><a href="3-Chapter_2.html#cb145-8"></a>models[[<span class="dv">7</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(UplusRC)</span>
<span id="cb145-9"><a href="3-Chapter_2.html#cb145-9"></a>models[[<span class="dv">8</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(RplusRC)</span>
<span id="cb145-10"><a href="3-Chapter_2.html#cb145-10"></a>models[[<span class="dv">9</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(CplusRC)</span>
<span id="cb145-11"><a href="3-Chapter_2.html#cb145-11"></a>models[[<span class="dv">10</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(RplusCplusRC)</span>
<span id="cb145-12"><a href="3-Chapter_2.html#cb145-12"></a>models[[<span class="dv">11</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(RC2)</span>
<span id="cb145-13"><a href="3-Chapter_2.html#cb145-13"></a>models <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>()</span></code></pre></div>
<pre><code># A tibble: 11 x 6
   `Model Desctiption`    df       L2    BIC   Delta         p
   &lt;chr&gt;               &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
 1 O                      12 1373.    1274.  23.9    8.44e-287
 2 U                      11  244.     153.   8.54   4.99e- 46
 3 R                       9  206.     132.   7.38   1.85e- 39
 4 C                       8  155.      89.3  7.47   1.48e- 29
 5 RplusC                  6   91.6     42.1  4.63   1.40e- 17
 6 RC                      6  125.      75.5  6.44   1.41e- 24
 7 UplusRC                 5   17.6    -23.7  1.52   3.49e-  3
 8 RplusRC                 4    6.94   -26.1  0.832  1.39e-  1
 9 CplusRC                 3   11.4    -13.4  1.01   9.72e-  3
10 RplusCplusRC            2    0.278  -16.2  0.0538 8.70e-  1
11 RC2                     2    0.600  -15.9  0.0935 7.41e-  1</code></pre>
</div>
<div id="表2.6b" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> 表2.6B</h2>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="3-Chapter_2.html#cb147-1"></a><span class="co"># Table 2.4 Panel B</span></span>
<span id="cb147-2"><a href="3-Chapter_2.html#cb147-2"></a><span class="kw">bind_rows</span>(<span class="kw">model_comparison</span>(<span class="dv">1</span>,<span class="dv">6</span>),</span>
<span id="cb147-3"><a href="3-Chapter_2.html#cb147-3"></a>          <span class="kw">model_comparison</span>(<span class="dv">6</span>,<span class="dv">11</span>),</span>
<span id="cb147-4"><a href="3-Chapter_2.html#cb147-4"></a>          <span class="kw">model_comparison</span>(<span class="dv">11</span>),</span>
<span id="cb147-5"><a href="3-Chapter_2.html#cb147-5"></a>          <span class="kw">model_comparison</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code># A tibble: 4 x 4
  `Model Used`    df       L2         p
  &lt;chr&gt;        &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 1-6              6 1248.    1.84e-266
2 6-11             4  124.    5.95e- 26
3 11               2    0.600 7.41e-  1
4 1               12 1373.    8.44e-287</code></pre>
</div>
<div id="表2.6c" class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> 表2.6C</h2>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="3-Chapter_2.html#cb149-1"></a><span class="co"># Table 2.4 Panel C</span></span>
<span id="cb149-2"><a href="3-Chapter_2.html#cb149-2"></a><span class="kw">bind_rows</span>(<span class="kw">model_comparison</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb149-3"><a href="3-Chapter_2.html#cb149-3"></a>          <span class="kw">model_comparison</span>(<span class="dv">2</span>,<span class="dv">6</span>),</span>
<span id="cb149-4"><a href="3-Chapter_2.html#cb149-4"></a>          <span class="kw">model_comparison</span>(<span class="dv">6</span>,<span class="dv">10</span>),</span>
<span id="cb149-5"><a href="3-Chapter_2.html#cb149-5"></a>          <span class="kw">model_comparison</span>(<span class="dv">10</span>),</span>
<span id="cb149-6"><a href="3-Chapter_2.html#cb149-6"></a>          <span class="kw">model_comparison</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code># A tibble: 5 x 4
  `Model Used`    df       L2         p
  &lt;chr&gt;        &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 1-2              1 1129.    1.52e-247
2 2-6              5  119.    5.22e- 24
3 6-10             4  125.    5.08e- 26
4 10               2    0.278 8.70e-  1
5 1               12 1373.    8.44e-287</code></pre>
<ul>
<li>表2.7A</li>
</ul>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="3-Chapter_2.html#cb151-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb151-2"><a href="3-Chapter_2.html#cb151-2"></a>UplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb151-3"><a href="3-Chapter_2.html#cb151-3"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Cscore <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb151-4"><a href="3-Chapter_2.html#cb151-4"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb151-5"><a href="3-Chapter_2.html#cb151-5"></a>      <span class="dt">data =</span> ., </span>
<span id="cb151-6"><a href="3-Chapter_2.html#cb151-6"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
......................
Done</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="3-Chapter_2.html#cb153-1"></a><span class="kw">summary</span>(UplusRC)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Educ + Occ + Rscore:Cscore + Mult(1, Educ, 
    Occ), family = poisson, data = ., tolerance = 1e-12)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0893  -0.5631   0.1321   0.7372   1.9761  

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             5.49123         NA      NA       NA    
Educ2                  -2.07045         NA      NA       NA    
Educ3                  -1.00877         NA      NA       NA    
Educ4                  -3.55473         NA      NA       NA    
Occ2                   -1.06909         NA      NA       NA    
Occ3                   -5.17113         NA      NA       NA    
Occ4                   -4.53939         NA      NA       NA    
Occ5                  -10.91018         NA      NA       NA    
Rscore:Cscore           0.55212    0.03429    16.1   &lt;2e-16 ***
Mult(., Educ, Occ).     0.05379         NA      NA       NA    
Mult(1, ., Occ).Educ1  57.38879         NA      NA       NA    
Mult(1, ., Occ).Educ2  28.47707         NA      NA       NA    
Mult(1, ., Occ).Educ3 -10.70009         NA      NA       NA    
Mult(1, ., Occ).Educ4   9.22301         NA      NA       NA    
Mult(1, Educ, .).Occ1   0.06067         NA      NA       NA    
Mult(1, Educ, .).Occ2  -0.31188         NA      NA       NA    
Mult(1, Educ, .).Occ3   0.01526         NA      NA       NA    
Mult(1, Educ, .).Occ4   0.19408         NA      NA       NA    
Mult(1, Educ, .).Occ5   1.34889         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 17.602 on 5 degrees of freedom
AIC: 163.98

Number of iterations: 79</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="3-Chapter_2.html#cb155-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb155-2"><a href="3-Chapter_2.html#cb155-2"></a><span class="kw">data.frame</span>(<span class="dt">var =</span> <span class="kw">names</span>(UplusRC<span class="op">$</span>coefficients),</span>
<span id="cb155-3"><a href="3-Chapter_2.html#cb155-3"></a>           <span class="dt">estimate =</span> UplusRC<span class="op">$</span>coefficients) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb155-4"><a href="3-Chapter_2.html#cb155-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> estimate,</span>
<span id="cb155-5"><a href="3-Chapter_2.html#cb155-5"></a>         <span class="dt">number =</span> <span class="kw">row_number</span>())</span></code></pre></div>
<pre><code>                     var     estimate number
1            (Intercept)   5.49123206      1
2                  Educ2  -2.07045035      2
3                  Educ3  -1.00877122      3
4                  Educ4  -3.55472593      4
5                   Occ2  -1.06909237      5
6                   Occ3  -5.17112951      6
7                   Occ4  -4.53939355      7
8                   Occ5 -10.91018443      8
9          Rscore:Cscore   0.55211791      9
10   Mult(., Educ, Occ).   0.05378691     10
11 Mult(1, ., Occ).Educ1  57.38878726     11
12 Mult(1, ., Occ).Educ2  28.47707067     12
13 Mult(1, ., Occ).Educ3 -10.70009243     13
14 Mult(1, ., Occ).Educ4   9.22300612     14
15 Mult(1, Educ, .).Occ1   0.06066883     15
16 Mult(1, Educ, .).Occ2  -0.31187525     16
17 Mult(1, Educ, .).Occ3   0.01525644     17
18 Mult(1, Educ, .).Occ4   0.19407628     18
19 Mult(1, Educ, .).Occ5   1.34889133     19</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="3-Chapter_2.html#cb157-1"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(UplusRC, <span class="kw">pickCoef</span>(UplusRC, <span class="st">&quot;[.]Educ&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb157-2"><a href="3-Chapter_2.html#cb157-2"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb157-3"><a href="3-Chapter_2.html#cb157-3"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(UplusRC, <span class="kw">pickCoef</span>(UplusRC, <span class="st">&quot;[.]Occ&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb157-4"><a href="3-Chapter_2.html#cb157-4"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb157-5"><a href="3-Chapter_2.html#cb157-5"></a></span>
<span id="cb157-6"><a href="3-Chapter_2.html#cb157-6"></a><span class="kw">summary</span>(UplusRC)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb157-7"><a href="3-Chapter_2.html#cb157-7"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb157-8"><a href="3-Chapter_2.html#cb157-8"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb157-9"><a href="3-Chapter_2.html#cb157-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore|Cscore|Mult&quot;</span>, Variable))</span></code></pre></div>
<pre><code>                Variable     Estimate Std..Error  z.value     Pr...z..
1          Rscore:Cscore   0.55211791 0.03429436 16.09938 2.576758e-58
2    Mult(., Educ, Occ).   0.05378691         NA       NA           NA
3  Mult(1, ., Occ).Educ1  57.38878726         NA       NA           NA
4  Mult(1, ., Occ).Educ2  28.47707067         NA       NA           NA
5  Mult(1, ., Occ).Educ3 -10.70009243         NA       NA           NA
6  Mult(1, ., Occ).Educ4   9.22300612         NA       NA           NA
7  Mult(1, Educ, .).Occ1   0.06066883         NA       NA           NA
8  Mult(1, Educ, .).Occ2  -0.31187525         NA       NA           NA
9  Mult(1, Educ, .).Occ3   0.01525644         NA       NA           NA
10 Mult(1, Educ, .).Occ4   0.19407628         NA       NA           NA
11 Mult(1, Educ, .).Occ5   1.34889133         NA       NA           NA</code></pre>
<ul>
<li>表2.7B</li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="3-Chapter_2.html#cb159-1"></a>RplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb159-2"><a href="3-Chapter_2.html#cb159-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Educ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb159-3"><a href="3-Chapter_2.html#cb159-3"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">12</span>),</span>
<span id="cb159-4"><a href="3-Chapter_2.html#cb159-4"></a>      <span class="dt">constrainTo =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb159-5"><a href="3-Chapter_2.html#cb159-5"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb159-6"><a href="3-Chapter_2.html#cb159-6"></a>      <span class="dt">data =</span> ., </span>
<span id="cb159-7"><a href="3-Chapter_2.html#cb159-7"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................
Done</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="3-Chapter_2.html#cb161-1"></a><span class="kw">summary</span>(RplusRC)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Educ + Occ + Cscore:Educ + Mult(1, Educ, 
    Occ), constrain = c(9, 12), constrainTo = c(0, 0), family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.96462  -0.24301  -0.05231   0.31330   1.21311  

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             5.1607         NA      NA       NA    
Educ2                  -0.4289         NA      NA       NA    
Educ3                   3.0753         NA      NA       NA    
Educ4                  -0.6896         NA      NA       NA    
Occ2                    0.3985         NA      NA       NA    
Occ3                   -1.4990         NA      NA       NA    
Occ4                    1.1571         NA      NA       NA    
Occ5                   -2.1249         NA      NA       NA    
Educ1:Cscore            0.0000         NA      NA       NA    
Educ2:Cscore           -0.4321     0.2210  -1.955   0.0506 .  
Educ3:Cscore           -1.2670     0.1931  -6.562 5.31e-11 ***
Educ4:Cscore            0.0000         NA      NA       NA    
Mult(., Educ, Occ).    -6.2884         NA      NA       NA    
Mult(1, ., Occ).Educ1  -1.1569         NA      NA       NA    
Mult(1, ., Occ).Educ2  -0.1103         NA      NA       NA    
Mult(1, ., Occ).Educ3   0.9000         NA      NA       NA    
Mult(1, ., Occ).Educ4   0.2945         NA      NA       NA    
Mult(1, Educ, .).Occ1   0.1500         NA      NA       NA    
Mult(1, Educ, .).Occ2  -0.1418         NA      NA       NA    
Mult(1, Educ, .).Occ3  -0.2341         NA      NA       NA    
Mult(1, Educ, .).Occ4  -0.3755         NA      NA       NA    
Mult(1, Educ, .).Occ5  -0.2185         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 6.9359 on 4 degrees of freedom
AIC: 155.31

Number of iterations: 41</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="3-Chapter_2.html#cb163-1"></a><span class="kw">summary</span>(RplusRC)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb163-2"><a href="3-Chapter_2.html#cb163-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb163-3"><a href="3-Chapter_2.html#cb163-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb163-4"><a href="3-Chapter_2.html#cb163-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore|Cscore|Mult&quot;</span>, Variable))</span></code></pre></div>
<pre><code>                Variable   Estimate Std..Error   z.value     Pr...z..
1           Educ1:Cscore  0.0000000         NA        NA           NA
2           Educ2:Cscore -0.4320760  0.2209849 -1.955228 5.055614e-02
3           Educ3:Cscore -1.2669500  0.1930731 -6.562024 5.308234e-11
4           Educ4:Cscore  0.0000000         NA        NA           NA
5    Mult(., Educ, Occ). -6.2884241         NA        NA           NA
6  Mult(1, ., Occ).Educ1 -1.1569262         NA        NA           NA
7  Mult(1, ., Occ).Educ2 -0.1102802         NA        NA           NA
8  Mult(1, ., Occ).Educ3  0.8999851         NA        NA           NA
9  Mult(1, ., Occ).Educ4  0.2945073         NA        NA           NA
10 Mult(1, Educ, .).Occ1  0.1499906         NA        NA           NA
11 Mult(1, Educ, .).Occ2 -0.1418034         NA        NA           NA
12 Mult(1, Educ, .).Occ3 -0.2340855         NA        NA           NA
13 Mult(1, Educ, .).Occ4 -0.3754668         NA        NA           NA
14 Mult(1, Educ, .).Occ5 -0.2185193         NA        NA           NA</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="3-Chapter_2.html#cb165-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb165-2"><a href="3-Chapter_2.html#cb165-2"></a><span class="kw">data.frame</span>(<span class="dt">var =</span> <span class="kw">names</span>(RplusRC<span class="op">$</span>coefficients),</span>
<span id="cb165-3"><a href="3-Chapter_2.html#cb165-3"></a>           <span class="dt">estimate =</span> RplusRC<span class="op">$</span>coefficients) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb165-4"><a href="3-Chapter_2.html#cb165-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> estimate,</span>
<span id="cb165-5"><a href="3-Chapter_2.html#cb165-5"></a>         <span class="dt">number =</span> <span class="kw">row_number</span>())</span></code></pre></div>
<pre><code>                     var   estimate number
1            (Intercept)  5.1607370      1
2                  Educ2 -0.4288684      2
3                  Educ3  3.0753140      3
4                  Educ4 -0.6896410      4
5                   Occ2  0.3985413      5
6                   Occ3 -1.4990042      6
7                   Occ4  1.1571325      7
8                   Occ5 -2.1249102      8
9           Educ1:Cscore         NA      9
10          Educ2:Cscore -0.4320760     10
11          Educ3:Cscore -1.2669500     11
12          Educ4:Cscore         NA     12
13   Mult(., Educ, Occ). -6.2884241     13
14 Mult(1, ., Occ).Educ1 -1.1569262     14
15 Mult(1, ., Occ).Educ2 -0.1102802     15
16 Mult(1, ., Occ).Educ3  0.8999851     16
17 Mult(1, ., Occ).Educ4  0.2945073     17
18 Mult(1, Educ, .).Occ1  0.1499906     18
19 Mult(1, Educ, .).Occ2 -0.1418034     19
20 Mult(1, Educ, .).Occ3 -0.2340855     20
21 Mult(1, Educ, .).Occ4 -0.3754668     21
22 Mult(1, Educ, .).Occ5 -0.2185193     22</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="3-Chapter_2.html#cb167-1"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RplusRC, <span class="kw">pickCoef</span>(RplusRC, <span class="st">&quot;[.]Educ&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb167-2"><a href="3-Chapter_2.html#cb167-2"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb167-3"><a href="3-Chapter_2.html#cb167-3"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RplusRC, <span class="kw">pickCoef</span>(RplusRC, <span class="st">&quot;[.]Occ&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb167-4"><a href="3-Chapter_2.html#cb167-4"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb167-5"><a href="3-Chapter_2.html#cb167-5"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],nu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)])</span>
<span id="cb167-6"><a href="3-Chapter_2.html#cb167-6"></a></span>
<span id="cb167-7"><a href="3-Chapter_2.html#cb167-7"></a>RplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb167-8"><a href="3-Chapter_2.html#cb167-8"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Educ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb167-9"><a href="3-Chapter_2.html#cb167-9"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">22</span>),</span>
<span id="cb167-10"><a href="3-Chapter_2.html#cb167-10"></a>      <span class="dt">constrainTo =</span> con,</span>
<span id="cb167-11"><a href="3-Chapter_2.html#cb167-11"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb167-12"><a href="3-Chapter_2.html#cb167-12"></a>      <span class="dt">data =</span> ., </span>
<span id="cb167-13"><a href="3-Chapter_2.html#cb167-13"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................
Done</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="3-Chapter_2.html#cb169-1"></a><span class="kw">summary</span>(RplusRC)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb169-2"><a href="3-Chapter_2.html#cb169-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb169-3"><a href="3-Chapter_2.html#cb169-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb169-4"><a href="3-Chapter_2.html#cb169-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore|Cscore|Mult&quot;</span>, Variable))</span></code></pre></div>
<pre><code>                Variable    Estimate Std..Error    z.value     Pr...z..
1           Educ1:Cscore  0.00000000         NA         NA           NA
2           Educ2:Cscore -0.43207600  0.2209849 -1.9552282 5.055614e-02
3           Educ3:Cscore -1.26695003  0.1930731 -6.5620238 5.308234e-11
4           Educ4:Cscore  0.00000000         NA         NA           NA
5    Mult(., Educ, Occ). -3.67046405  0.5474332 -6.7048620 2.015968e-11
6  Mult(1, ., Occ).Educ1 -0.75983648         NA         NA           NA
7  Mult(1, ., Occ).Educ2 -0.06145542  0.1367987 -0.4492399 6.532586e-01
8  Mult(1, ., Occ).Educ3  0.61265036  0.1325427  4.6222852 3.795357e-06
9  Mult(1, ., Occ).Educ4  0.20864153         NA         NA           NA
10 Mult(1, Educ, .).Occ1  0.80614447         NA         NA           NA
11 Mult(1, Educ, .).Occ2  0.05693272  0.1225191  0.4646846 6.421573e-01
12 Mult(1, Educ, .).Occ3 -0.18001127  0.1630841 -1.1037941 2.696825e-01
13 Mult(1, Educ, .).Occ4 -0.54302264  0.2004941 -2.7084221 6.760398e-03
14 Mult(1, Educ, .).Occ5 -0.14004328         NA         NA           NA</code></pre>
<ul>
<li>表2.7C</li>
</ul>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="3-Chapter_2.html#cb171-1"></a>CplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb171-2"><a href="3-Chapter_2.html#cb171-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb171-3"><a href="3-Chapter_2.html#cb171-3"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">13</span>),</span>
<span id="cb171-4"><a href="3-Chapter_2.html#cb171-4"></a>      <span class="dt">constrainTo =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb171-5"><a href="3-Chapter_2.html#cb171-5"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb171-6"><a href="3-Chapter_2.html#cb171-6"></a>      <span class="dt">data =</span> ., </span>
<span id="cb171-7"><a href="3-Chapter_2.html#cb171-7"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
...............................
Done</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="3-Chapter_2.html#cb173-1"></a><span class="kw">summary</span>(CplusRC)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Educ + Occ + Rscore:Occ + Mult(1, Educ, 
    Occ), constrain = c(9, 13), constrainTo = c(0, 0), family = poisson, 
    data = ., tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98938  -0.14103  -0.01486   0.18280   2.20453  

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            6.19788         NA      NA       NA    
Educ2                 -1.63788         NA      NA       NA    
Educ3                 -0.14456         NA      NA       NA    
Educ4                 -2.20382         NA      NA       NA    
Occ2                  -2.71901         NA      NA       NA    
Occ3                  -5.73320         NA      NA       NA    
Occ4                  -3.94883         NA      NA       NA    
Occ5                  -4.95403         NA      NA       NA    
Occ1:Rscore            0.00000         NA      NA       NA    
Occ2:Rscore            1.26259    0.16970   7.440 1.00e-13 ***
Occ3:Rscore            1.28232    0.20937   6.125 9.08e-10 ***
Occ4:Rscore            1.41583    0.09054  15.638  &lt; 2e-16 ***
Occ5:Rscore            0.00000         NA      NA       NA    
Mult(., Educ, Occ).   -1.92743         NA      NA       NA    
Mult(1, ., Occ).Educ1 -0.07407         NA      NA       NA    
Mult(1, ., Occ).Educ2 -0.10893         NA      NA       NA    
Mult(1, ., Occ).Educ3 -0.09625         NA      NA       NA    
Mult(1, ., Occ).Educ4 -0.58300         NA      NA       NA    
Mult(1, Educ, .).Occ1  0.22691         NA      NA       NA    
Mult(1, Educ, .).Occ2 -1.12808         NA      NA       NA    
Mult(1, Educ, .).Occ3  0.19625         NA      NA       NA    
Mult(1, Educ, .).Occ4  0.55549         NA      NA       NA    
Mult(1, Educ, .).Occ5  3.06835         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 11.405 on 3 degrees of freedom
AIC: 161.78

Number of iterations: 88</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="3-Chapter_2.html#cb175-1"></a><span class="kw">summary</span>(CplusRC)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb175-2"><a href="3-Chapter_2.html#cb175-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb175-3"><a href="3-Chapter_2.html#cb175-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb175-4"><a href="3-Chapter_2.html#cb175-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore|Cscore|Mult&quot;</span>, Variable))</span></code></pre></div>
<pre><code>                Variable    Estimate Std..Error   z.value     Pr...z..
1            Occ1:Rscore  0.00000000         NA        NA           NA
2            Occ2:Rscore  1.26259006  0.1696974  7.440245 1.004990e-13
3            Occ3:Rscore  1.28231939  0.2093667  6.124752 9.082487e-10
4            Occ4:Rscore  1.41582828  0.0905404 15.637531 4.040916e-55
5            Occ5:Rscore  0.00000000         NA        NA           NA
6    Mult(., Educ, Occ). -1.92742530         NA        NA           NA
7  Mult(1, ., Occ).Educ1 -0.07406953         NA        NA           NA
8  Mult(1, ., Occ).Educ2 -0.10893395         NA        NA           NA
9  Mult(1, ., Occ).Educ3 -0.09624700         NA        NA           NA
10 Mult(1, ., Occ).Educ4 -0.58299718         NA        NA           NA
11 Mult(1, Educ, .).Occ1  0.22691481         NA        NA           NA
12 Mult(1, Educ, .).Occ2 -1.12808450         NA        NA           NA
13 Mult(1, Educ, .).Occ3  0.19625399         NA        NA           NA
14 Mult(1, Educ, .).Occ4  0.55549092         NA        NA           NA
15 Mult(1, Educ, .).Occ5  3.06835400         NA        NA           NA</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="3-Chapter_2.html#cb177-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb177-2"><a href="3-Chapter_2.html#cb177-2"></a><span class="kw">data.frame</span>(<span class="dt">var =</span> <span class="kw">names</span>(CplusRC<span class="op">$</span>coefficients),</span>
<span id="cb177-3"><a href="3-Chapter_2.html#cb177-3"></a>           <span class="dt">estimate =</span> CplusRC<span class="op">$</span>coefficients) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb177-4"><a href="3-Chapter_2.html#cb177-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> estimate,</span>
<span id="cb177-5"><a href="3-Chapter_2.html#cb177-5"></a>         <span class="dt">number =</span> <span class="kw">row_number</span>())</span></code></pre></div>
<pre><code>                     var    estimate number
1            (Intercept)  6.19788033      1
2                  Educ2 -1.63788486      2
3                  Educ3 -0.14455710      3
4                  Educ4 -2.20382367      4
5                   Occ2 -2.71901340      5
6                   Occ3 -5.73320004      6
7                   Occ4 -3.94883232      7
8                   Occ5 -4.95403203      8
9            Occ1:Rscore          NA      9
10           Occ2:Rscore  1.26259006     10
11           Occ3:Rscore  1.28231939     11
12           Occ4:Rscore  1.41582828     12
13           Occ5:Rscore          NA     13
14   Mult(., Educ, Occ). -1.92742530     14
15 Mult(1, ., Occ).Educ1 -0.07406953     15
16 Mult(1, ., Occ).Educ2 -0.10893395     16
17 Mult(1, ., Occ).Educ3 -0.09624700     17
18 Mult(1, ., Occ).Educ4 -0.58299718     18
19 Mult(1, Educ, .).Occ1  0.22691481     19
20 Mult(1, Educ, .).Occ2 -1.12808450     20
21 Mult(1, Educ, .).Occ3  0.19625399     21
22 Mult(1, Educ, .).Occ4  0.55549092     22
23 Mult(1, Educ, .).Occ5  3.06835400     23</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="3-Chapter_2.html#cb179-1"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(CplusRC, <span class="kw">pickCoef</span>(CplusRC, <span class="st">&quot;[.]Educ&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb179-2"><a href="3-Chapter_2.html#cb179-2"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb179-3"><a href="3-Chapter_2.html#cb179-3"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(CplusRC, <span class="kw">pickCoef</span>(CplusRC, <span class="st">&quot;[.]Occ&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb179-4"><a href="3-Chapter_2.html#cb179-4"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb179-5"><a href="3-Chapter_2.html#cb179-5"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],nu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)])</span>
<span id="cb179-6"><a href="3-Chapter_2.html#cb179-6"></a></span>
<span id="cb179-7"><a href="3-Chapter_2.html#cb179-7"></a>CplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb179-8"><a href="3-Chapter_2.html#cb179-8"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb179-9"><a href="3-Chapter_2.html#cb179-9"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">23</span>),</span>
<span id="cb179-10"><a href="3-Chapter_2.html#cb179-10"></a>      <span class="dt">constrainTo =</span> con,</span>
<span id="cb179-11"><a href="3-Chapter_2.html#cb179-11"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb179-12"><a href="3-Chapter_2.html#cb179-12"></a>      <span class="dt">data =</span> ., </span>
<span id="cb179-13"><a href="3-Chapter_2.html#cb179-13"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations......................................................
Done</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="3-Chapter_2.html#cb181-1"></a><span class="kw">summary</span>(CplusRC)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb181-2"><a href="3-Chapter_2.html#cb181-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb181-3"><a href="3-Chapter_2.html#cb181-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb181-4"><a href="3-Chapter_2.html#cb181-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore|Cscore|Mult&quot;</span>, Variable))</span></code></pre></div>
<pre><code>                Variable     Estimate Std..Error   z.value     Pr...z..
1            Occ1:Rscore  0.000000000         NA        NA           NA
2            Occ2:Rscore  1.262590058 0.16969738  7.440245 1.004990e-13
3            Occ3:Rscore  1.282319390 0.20936674  6.124752 9.082487e-10
4            Occ4:Rscore  1.415828283 0.09054040 15.637531 4.040916e-55
5            Occ5:Rscore  0.000000000         NA        NA           NA
6    Mult(., Educ, Occ). -2.509132039 0.47337666 -5.300498 1.154873e-07
7  Mult(1, ., Occ).Educ1  0.332914652         NA        NA           NA
8  Mult(1, ., Occ).Educ2  0.250882838 0.17043562  1.472009 1.410183e-01
9  Mult(1, ., Occ).Educ3  0.280733721 0.25875316  1.084948 2.779447e-01
10 Mult(1, ., Occ).Educ4 -0.864531211         NA        NA           NA
11 Mult(1, Educ, .).Occ1 -0.116510615         NA        NA           NA
12 Mult(1, Educ, .).Occ2 -0.558888360 0.15090381 -3.703607 2.125557e-04
13 Mult(1, Educ, .).Occ3 -0.126520705 0.12280113 -1.030289 3.028742e-01
14 Mult(1, Educ, .).Occ4 -0.009237675 0.06533009 -0.141400 8.875539e-01
15 Mult(1, Educ, .).Occ5  0.811157355         NA        NA           NA</code></pre>
<ul>
<li>表2.7D</li>
</ul>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="3-Chapter_2.html#cb183-1"></a>RplusCplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb183-2"><a href="3-Chapter_2.html#cb183-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Educ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb183-3"><a href="3-Chapter_2.html#cb183-3"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">17</span>), <span class="dt">constrainTo =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb183-4"><a href="3-Chapter_2.html#cb183-4"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb183-5"><a href="3-Chapter_2.html#cb183-5"></a>      <span class="dt">data =</span> ., </span>
<span id="cb183-6"><a href="3-Chapter_2.html#cb183-6"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations................................
Done</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="3-Chapter_2.html#cb185-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb185-2"><a href="3-Chapter_2.html#cb185-2"></a><span class="kw">data.frame</span>(<span class="dt">var =</span> <span class="kw">names</span>(CplusRC<span class="op">$</span>coefficients),</span>
<span id="cb185-3"><a href="3-Chapter_2.html#cb185-3"></a>           <span class="dt">estimate =</span> CplusRC<span class="op">$</span>coefficients) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb185-4"><a href="3-Chapter_2.html#cb185-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> estimate,</span>
<span id="cb185-5"><a href="3-Chapter_2.html#cb185-5"></a>         <span class="dt">number =</span> <span class="kw">row_number</span>())</span></code></pre></div>
<pre><code>                     var     estimate number
1            (Intercept)  6.132951036      1
2                  Educ2 -1.598655285      2
3                  Educ3 -0.119602932      3
4                  Educ4 -1.631176445      4
5                   Occ2 -3.281987830      5
6                   Occ3 -5.745938986      6
7                   Occ4 -3.812315688      7
8                   Occ5 -3.773472310      8
9            Occ1:Rscore           NA      9
10           Occ2:Rscore  1.262590058     10
11           Occ3:Rscore  1.282319390     11
12           Occ4:Rscore  1.415828283     12
13           Occ5:Rscore           NA     13
14   Mult(., Educ, Occ). -2.509132039     14
15 Mult(1, ., Occ).Educ1           NA     15
16 Mult(1, ., Occ).Educ2  0.250882838     16
17 Mult(1, ., Occ).Educ3  0.280733721     17
18 Mult(1, ., Occ).Educ4           NA     18
19 Mult(1, Educ, .).Occ1           NA     19
20 Mult(1, Educ, .).Occ2 -0.558888360     20
21 Mult(1, Educ, .).Occ3 -0.126520705     21
22 Mult(1, Educ, .).Occ4 -0.009237675     22
23 Mult(1, Educ, .).Occ5           NA     23</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="3-Chapter_2.html#cb187-1"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RplusCplusRC, <span class="kw">pickCoef</span>(RplusCplusRC, <span class="st">&quot;[.]Educ&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb187-2"><a href="3-Chapter_2.html#cb187-2"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb187-3"><a href="3-Chapter_2.html#cb187-3"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RplusCplusRC, <span class="kw">pickCoef</span>(RplusCplusRC, <span class="st">&quot;[.]Occ&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb187-4"><a href="3-Chapter_2.html#cb187-4"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb187-5"><a href="3-Chapter_2.html#cb187-5"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],nu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)])</span>
<span id="cb187-6"><a href="3-Chapter_2.html#cb187-6"></a></span>
<span id="cb187-7"><a href="3-Chapter_2.html#cb187-7"></a>RplusCplusRC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb187-8"><a href="3-Chapter_2.html#cb187-8"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Educ <span class="op">+</span><span class="st"> </span>Rscore<span class="op">:</span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb187-9"><a href="3-Chapter_2.html#cb187-9"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">22</span>,<span class="dv">23</span>,<span class="dv">27</span>), </span>
<span id="cb187-10"><a href="3-Chapter_2.html#cb187-10"></a>      <span class="dt">constrainTo =</span> con,</span>
<span id="cb187-11"><a href="3-Chapter_2.html#cb187-11"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb187-12"><a href="3-Chapter_2.html#cb187-12"></a>      <span class="dt">data =</span> ., </span>
<span id="cb187-13"><a href="3-Chapter_2.html#cb187-13"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.......................
Done</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="3-Chapter_2.html#cb189-1"></a>mu</span></code></pre></div>
<pre><code>                         Estimate Std. Error
Mult(1, ., Occ).Educ1  0.76639941 0.03714637
Mult(1, ., Occ).Educ2  0.05505913 0.08952794
Mult(1, ., Occ).Educ3 -0.60073372 0.04744381
Mult(1, ., Occ).Educ4 -0.22072481 0.06764890</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="3-Chapter_2.html#cb191-1"></a>nu</span></code></pre></div>
<pre><code>                         Estimate Std. Error
Mult(1, Educ, .).Occ1  0.83832072 0.02535129
Mult(1, Educ, .).Occ2 -0.04397713 0.08855421
Mult(1, Educ, .).Occ3 -0.11946443 0.09158773
Mult(1, Educ, .).Occ4 -0.50065982 0.06550415
Mult(1, Educ, .).Occ5 -0.17421935 0.12622465</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="3-Chapter_2.html#cb193-1"></a><span class="kw">summary</span>(RplusCplusRC)<span class="op">$</span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb193-2"><a href="3-Chapter_2.html#cb193-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb193-3"><a href="3-Chapter_2.html#cb193-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb193-4"><a href="3-Chapter_2.html#cb193-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Rscore|Cscore|Mult&quot;</span>, Variable))</span></code></pre></div>
<pre><code>                Variable    Estimate Std..Error    z.value     Pr...z..
1           Educ1:Cscore  0.00000000         NA         NA           NA
2           Educ2:Cscore -0.29016794  0.1835938 -1.5804884 1.139951e-01
3           Educ3:Cscore -0.95452353  0.2168230 -4.4023158 1.071015e-05
4           Educ4:Cscore  0.00000000         NA         NA           NA
5            Occ1:Rscore  0.00000000         NA         NA           NA
6            Occ2:Rscore  0.00000000         NA         NA           NA
7            Occ3:Rscore  0.39725281  0.1673266  2.3741161 1.759102e-02
8            Occ4:Rscore  0.32684292  0.1614939  2.0238715 4.298337e-02
9            Occ5:Rscore  0.00000000         NA         NA           NA
10   Mult(., Educ, Occ).  2.85715993  0.5343817  5.3466654 8.958940e-08
11 Mult(1, ., Occ).Educ1  0.76639941         NA         NA           NA
12 Mult(1, ., Occ).Educ2  0.05505913  0.1291228  0.4264091 6.698098e-01
13 Mult(1, ., Occ).Educ3 -0.60073372  0.1297703 -4.6292078 3.670672e-06
14 Mult(1, ., Occ).Educ4 -0.22072481         NA         NA           NA
15 Mult(1, Educ, .).Occ1  0.83832072         NA         NA           NA
16 Mult(1, Educ, .).Occ2 -0.04397713  0.1677272 -0.2621944 7.931715e-01
17 Mult(1, Educ, .).Occ3 -0.11946443  0.1842187 -0.6484923 5.166666e-01
18 Mult(1, Educ, .).Occ4 -0.50065982  0.2149854 -2.3288081 1.986923e-02
19 Mult(1, Educ, .).Occ5 -0.17421935         NA         NA           NA</code></pre>
<ul>
<li>表2.7E</li>
</ul>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="3-Chapter_2.html#cb195-1"></a>RC2 &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb195-2"><a href="3-Chapter_2.html#cb195-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">instances</span>(<span class="kw">Mult</span>(Educ, Occ), <span class="dt">instances =</span> <span class="dv">2</span>),</span>
<span id="cb195-3"><a href="3-Chapter_2.html#cb195-3"></a>      <span class="dt">family =</span> poisson, <span class="dt">data =</span> ., <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.............................................
Done</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="3-Chapter_2.html#cb197-1"></a><span class="kw">summary</span>(RC2)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Educ + Occ + instances(Mult(Educ, Occ), 
    instances = 2), family = poisson, data = ., tolerance = 1e-12)

Deviance Residuals: 
      Min         1Q     Median         3Q        Max  
-0.631356  -0.030234  -0.004363   0.050323   0.320666  

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                   5.05433         NA      NA       NA
Educ2                        -0.88502         NA      NA       NA
Educ3                         1.11149         NA      NA       NA
Educ4                         0.28785         NA      NA       NA
Occ2                          0.30875         NA      NA       NA
Occ3                         -2.19953         NA      NA       NA
Occ4                          0.06441         NA      NA       NA
Occ5                         -3.99275         NA      NA       NA
Mult(., Occ, inst = 1).Educ1  1.36064         NA      NA       NA
Mult(., Occ, inst = 1).Educ2  0.26855         NA      NA       NA
Mult(., Occ, inst = 1).Educ3 -0.07954         NA      NA       NA
Mult(., Occ, inst = 1).Educ4 -1.16504         NA      NA       NA
Mult(Educ, ., inst = 1).Occ1  0.89943         NA      NA       NA
Mult(Educ, ., inst = 1).Occ2 -0.12282         NA      NA       NA
Mult(Educ, ., inst = 1).Occ3 -0.65859         NA      NA       NA
Mult(Educ, ., inst = 1).Occ4 -0.99610         NA      NA       NA
Mult(Educ, ., inst = 1).Occ5 -0.17245         NA      NA       NA
Mult(., Occ, inst = 2).Educ1 -1.38657         NA      NA       NA
Mult(., Occ, inst = 2).Educ2 -0.55612         NA      NA       NA
Mult(., Occ, inst = 2).Educ3  0.92794         NA      NA       NA
Mult(., Occ, inst = 2).Educ4 -1.60100         NA      NA       NA
Mult(Educ, ., inst = 2).Occ1  0.02053         NA      NA       NA
Mult(Educ, ., inst = 2).Occ2  0.45994         NA      NA       NA
Mult(Educ, ., inst = 2).Occ3  0.19190         NA      NA       NA
Mult(Educ, ., inst = 2).Occ4  0.14706         NA      NA       NA
Mult(Educ, ., inst = 2).Occ5 -0.58844         NA      NA       NA

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 0.6001 on 2 degrees of freedom
AIC: 152.98

Number of iterations: 45</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="3-Chapter_2.html#cb199-1"></a>RCmodel_coef &lt;-<span class="st"> </span><span class="cf">function</span>(RCmodel, row, col, m, data){</span>
<span id="cb199-2"><a href="3-Chapter_2.html#cb199-2"></a>  NI &lt;-<span class="st"> </span>RCmodel<span class="op">$</span>xlevels[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">length</span>()</span>
<span id="cb199-3"><a href="3-Chapter_2.html#cb199-3"></a>  NJ &lt;-<span class="st"> </span>RCmodel<span class="op">$</span>xlevels[[<span class="dv">2</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">length</span>()</span>
<span id="cb199-4"><a href="3-Chapter_2.html#cb199-4"></a>  iflag &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb199-5"><a href="3-Chapter_2.html#cb199-5"></a>  y &lt;-<span class="st"> </span><span class="kw">length</span>(RCmodel<span class="op">$</span>y)</span>
<span id="cb199-6"><a href="3-Chapter_2.html#cb199-6"></a>  X &lt;-<span class="st"> </span><span class="kw">gl</span>(NI,NJ,<span class="dt">length =</span> y)</span>
<span id="cb199-7"><a href="3-Chapter_2.html#cb199-7"></a>  Y &lt;-<span class="st"> </span><span class="kw">gl</span>(NJ,<span class="dv">1</span>,<span class="dt">length =</span> y)</span>
<span id="cb199-8"><a href="3-Chapter_2.html#cb199-8"></a>  IX &lt;-<span class="st"> </span><span class="kw">pickCoef</span>(RCmodel, <span class="kw">paste0</span>(<span class="st">&quot;[.]&quot;</span>,<span class="kw">deparse</span>(<span class="kw">substitute</span>(row))))</span>
<span id="cb199-9"><a href="3-Chapter_2.html#cb199-9"></a>  IY &lt;-<span class="st"> </span><span class="kw">pickCoef</span>(RCmodel, <span class="kw">paste0</span>(<span class="st">&quot;[.]&quot;</span>,<span class="kw">deparse</span>(<span class="kw">substitute</span>(col))))</span>
<span id="cb199-10"><a href="3-Chapter_2.html#cb199-10"></a>  X &lt;-<span class="st"> </span>RCmodel<span class="op">$</span>coefficients[IX]</span>
<span id="cb199-11"><a href="3-Chapter_2.html#cb199-11"></a>  Y &lt;-<span class="st"> </span>RCmodel<span class="op">$</span>coefficients[IY]</span>
<span id="cb199-12"><a href="3-Chapter_2.html#cb199-12"></a>  mu0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(X,<span class="dt">nrow =</span> NI,<span class="dt">ncol =</span> m)</span>
<span id="cb199-13"><a href="3-Chapter_2.html#cb199-13"></a>  nu0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(Y,<span class="dt">nrow =</span> NJ,<span class="dt">ncol =</span> m)</span>
<span id="cb199-14"><a href="3-Chapter_2.html#cb199-14"></a>  mu &lt;-<span class="st"> </span>mu0</span>
<span id="cb199-15"><a href="3-Chapter_2.html#cb199-15"></a>  nu &lt;-<span class="st"> </span>nu0</span>
<span id="cb199-16"><a href="3-Chapter_2.html#cb199-16"></a>  A &lt;-<span class="st"> </span>mu <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(nu) <span class="co"># [NI, M] [M. NJ]</span></span>
<span id="cb199-17"><a href="3-Chapter_2.html#cb199-17"></a>  R1 &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span>,NI)</span>
<span id="cb199-18"><a href="3-Chapter_2.html#cb199-18"></a>  C1 &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span>,NJ)</span>
<span id="cb199-19"><a href="3-Chapter_2.html#cb199-19"></a>  Rone &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">1</span>,NI<span class="op">^</span><span class="dv">2</span>),<span class="dt">nrow =</span> NI)</span>
<span id="cb199-20"><a href="3-Chapter_2.html#cb199-20"></a>  Cone &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">1</span>,NJ<span class="op">^</span><span class="dv">2</span>),<span class="dt">nrow =</span> NJ)</span>
<span id="cb199-21"><a href="3-Chapter_2.html#cb199-21"></a>  rowP &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,NI))</span>
<span id="cb199-22"><a href="3-Chapter_2.html#cb199-22"></a>  colP &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,NJ));</span>
<span id="cb199-23"><a href="3-Chapter_2.html#cb199-23"></a>  data &lt;-<span class="st"> </span>RC2<span class="op">$</span>model</span>
<span id="cb199-24"><a href="3-Chapter_2.html#cb199-24"></a>  <span class="kw">list</span>(y,X,Y,IX,IY,data)</span>
<span id="cb199-25"><a href="3-Chapter_2.html#cb199-25"></a>  <span class="cf">if</span> (iflag <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb199-26"><a href="3-Chapter_2.html#cb199-26"></a>    rowP &lt;-<span class="st"> </span><span class="kw">with</span>(data, <span class="kw">tapply</span>(freq,row,sum)<span class="op">/</span><span class="kw">sum</span>(freq))</span>
<span id="cb199-27"><a href="3-Chapter_2.html#cb199-27"></a>    colP &lt;-<span class="st"> </span><span class="kw">with</span>(data, <span class="kw">tapply</span>(freq,col,sum)<span class="op">/</span><span class="kw">sum</span>(freq))}</span>
<span id="cb199-28"><a href="3-Chapter_2.html#cb199-28"></a>  DR &lt;-<span class="st"> </span><span class="kw">diag</span>(rowP<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),NI)</span>
<span id="cb199-29"><a href="3-Chapter_2.html#cb199-29"></a>  DC &lt;-<span class="st"> </span><span class="kw">diag</span>(colP<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),NJ)</span>
<span id="cb199-30"><a href="3-Chapter_2.html#cb199-30"></a>  RWsqr &lt;-<span class="st"> </span><span class="kw">diag</span>(rowP<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),NI)</span>
<span id="cb199-31"><a href="3-Chapter_2.html#cb199-31"></a>  CWsqr &lt;-<span class="st"> </span><span class="kw">diag</span>(colP<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),NJ)</span>
<span id="cb199-32"><a href="3-Chapter_2.html#cb199-32"></a>  RW &lt;-<span class="st"> </span>RWsqr<span class="op">^</span><span class="dv">2</span></span>
<span id="cb199-33"><a href="3-Chapter_2.html#cb199-33"></a>  CW &lt;-<span class="st"> </span>CWsqr<span class="op">^</span><span class="dv">2</span></span>
<span id="cb199-34"><a href="3-Chapter_2.html#cb199-34"></a>  L &lt;-<span class="st"> </span>(R1 <span class="op">-</span><span class="st"> </span>(Rone <span class="op">%*%</span><span class="st"> </span>RW)<span class="op">/</span><span class="kw">sum</span>(RW)) <span class="op">%*%</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(C1 <span class="op">-</span><span class="st"> </span>(Cone <span class="op">%*%</span><span class="st"> </span>CW)<span class="op">/</span><span class="kw">sum</span>(CW))</span>
<span id="cb199-35"><a href="3-Chapter_2.html#cb199-35"></a>  phiv &lt;-<span class="st"> </span><span class="kw">svd</span>(RWsqr <span class="op">%*%</span><span class="st"> </span>L <span class="op">%*%</span><span class="st"> </span>CWsqr)<span class="op">$</span>d[<span class="dv">1</span><span class="op">:</span>m]</span>
<span id="cb199-36"><a href="3-Chapter_2.html#cb199-36"></a>  mu &lt;-<span class="st"> </span><span class="kw">svd</span>(RWsqr <span class="op">%*%</span><span class="st"> </span>L <span class="op">%*%</span><span class="st"> </span>CWsqr)<span class="op">$</span>u[,<span class="dv">1</span><span class="op">:</span>m]</span>
<span id="cb199-37"><a href="3-Chapter_2.html#cb199-37"></a>  nu &lt;-<span class="st"> </span><span class="kw">svd</span>(RWsqr <span class="op">%*%</span><span class="st"> </span>L <span class="op">%*%</span><span class="st"> </span>CWsqr)<span class="op">$</span>v[,<span class="dv">1</span><span class="op">:</span>m]</span>
<span id="cb199-38"><a href="3-Chapter_2.html#cb199-38"></a>  mu &lt;-<span class="st"> </span>DR <span class="op">%*%</span><span class="st"> </span>mu</span>
<span id="cb199-39"><a href="3-Chapter_2.html#cb199-39"></a>  nu &lt;-<span class="st"> </span>DC <span class="op">%*%</span><span class="st"> </span>nu</span>
<span id="cb199-40"><a href="3-Chapter_2.html#cb199-40"></a>  phi &lt;-<span class="st"> </span><span class="kw">diag</span>(phiv, m)</span>
<span id="cb199-41"><a href="3-Chapter_2.html#cb199-41"></a>  L2 &lt;-<span class="st"> </span>RCmodel<span class="op">$</span>deviance</span>
<span id="cb199-42"><a href="3-Chapter_2.html#cb199-42"></a>  df &lt;-<span class="st"> </span>RCmodel<span class="op">$</span>df.residual</span>
<span id="cb199-43"><a href="3-Chapter_2.html#cb199-43"></a>  p.value &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(L2,df)</span>
<span id="cb199-44"><a href="3-Chapter_2.html#cb199-44"></a>  fit.freq &lt;-<span class="st"> </span><span class="kw">predict</span>(RCmodel, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)</span>
<span id="cb199-45"><a href="3-Chapter_2.html#cb199-45"></a>  </span>
<span id="cb199-46"><a href="3-Chapter_2.html#cb199-46"></a>  <span class="kw">print</span>(<span class="kw">list</span>(<span class="dt">model =</span> RCmodel, </span>
<span id="cb199-47"><a href="3-Chapter_2.html#cb199-47"></a>     <span class="dt">L2 =</span> L2, </span>
<span id="cb199-48"><a href="3-Chapter_2.html#cb199-48"></a>     <span class="dt">df =</span> df,</span>
<span id="cb199-49"><a href="3-Chapter_2.html#cb199-49"></a>     <span class="dt">p.value =</span> p.value,</span>
<span id="cb199-50"><a href="3-Chapter_2.html#cb199-50"></a>     <span class="dt">obs_freq =</span> <span class="kw">summary</span>(RC2)<span class="op">$</span>y, </span>
<span id="cb199-51"><a href="3-Chapter_2.html#cb199-51"></a>     <span class="dt">fit.freq =</span> fit.freq,</span>
<span id="cb199-52"><a href="3-Chapter_2.html#cb199-52"></a>     <span class="dt">phi =</span> phi, </span>
<span id="cb199-53"><a href="3-Chapter_2.html#cb199-53"></a>     <span class="dt">mu =</span> mu, </span>
<span id="cb199-54"><a href="3-Chapter_2.html#cb199-54"></a>     <span class="dt">nu =</span> nu,</span>
<span id="cb199-55"><a href="3-Chapter_2.html#cb199-55"></a>     <span class="kw">cor</span>(mu) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>),</span>
<span id="cb199-56"><a href="3-Chapter_2.html#cb199-56"></a>     <span class="kw">cor</span>(nu) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>)))</span>
<span id="cb199-57"><a href="3-Chapter_2.html#cb199-57"></a>  }</span>
<span id="cb199-58"><a href="3-Chapter_2.html#cb199-58"></a></span>
<span id="cb199-59"><a href="3-Chapter_2.html#cb199-59"></a><span class="kw">RCmodel_coef</span>(RC2, <span class="dt">row =</span> Educ, <span class="dt">col =</span> Occ, <span class="dt">m =</span>  <span class="dv">2</span>)</span></code></pre></div>
<pre><code>$model

Call:
gnm(formula = Freq ~ Educ + Occ + instances(Mult(Educ, Occ), 
    instances = 2), family = poisson, data = ., tolerance = 1e-12)

Coefficients:
                 (Intercept)                         Educ2  
                     5.05433                      -0.88502  
                       Educ3                         Educ4  
                     1.11149                       0.28785  
                        Occ2                          Occ3  
                     0.30875                      -2.19953  
                        Occ4                          Occ5  
                     0.06441                      -3.99275  
Mult(., Occ, inst = 1).Educ1  Mult(., Occ, inst = 1).Educ2  
                     1.36064                       0.26855  
Mult(., Occ, inst = 1).Educ3  Mult(., Occ, inst = 1).Educ4  
                    -0.07954                      -1.16504  
Mult(Educ, ., inst = 1).Occ1  Mult(Educ, ., inst = 1).Occ2  
                     0.89943                      -0.12282  
Mult(Educ, ., inst = 1).Occ3  Mult(Educ, ., inst = 1).Occ4  
                    -0.65859                      -0.99610  
Mult(Educ, ., inst = 1).Occ5  Mult(., Occ, inst = 2).Educ1  
                    -0.17245                      -1.38657  
Mult(., Occ, inst = 2).Educ2  Mult(., Occ, inst = 2).Educ3  
                    -0.55612                       0.92794  
Mult(., Occ, inst = 2).Educ4  Mult(Educ, ., inst = 2).Occ1  
                    -1.60100                       0.02053  
Mult(Educ, ., inst = 2).Occ2  Mult(Educ, ., inst = 2).Occ3  
                     0.45994                       0.19190  
Mult(Educ, ., inst = 2).Occ4  Mult(Educ, ., inst = 2).Occ5  
                     0.14706                      -0.58844  

Deviance:            0.6001022 
Pearson chi-squared: 0.5746549 
Residual df:         2 

$L2
[1] 0.6001022

$df
[1] 2

$p.value
[1] 0.7407804

$obs_freq
NULL

$fit.freq
$fit.freq$fit
          1           2           3           4           5           6 
 517.836063   95.414391    5.433736   35.145848    5.169961   81.405000 
          7           8           9          10          11          12 
  65.976261    5.398934   48.639687    1.580117  451.846566 1003.387842 
         13          14          15          16          17          18 
  66.470016  630.136504    5.159072   70.912370  157.221505   36.697314 
         19          20 
 562.077961   12.090850 

$fit.freq$se.fit
        1         2         3         4         5         6         7         8 
22.748933  9.732333  2.174395  5.860792  2.230227  8.912865  7.856714  1.044826 
        9        10        11        12        13        14        15        16 
 6.616317  0.619348 21.250045 31.666672  8.114913 25.088611  2.233235  8.415482 
       17        18        19        20 
12.530867  6.041164 23.703381  3.469126 

$fit.freq$residual.scale
[1] 1


$phi
         [,1]     [,2]
[1,] 2.600861 0.000000
[2,] 0.000000 1.521971

$mu
            [,1]        [,2]
[1,]  0.74345129  0.27619989
[2,]  0.08846472 -0.06103682
[3,] -0.19984223 -0.77722344
[4,] -0.63207378  0.56206037

$nu
            [,1]         [,2]
[1,]  0.76509960 -0.137064850
[2,]  0.01966104 -0.548959995
[3,] -0.32245067 -0.119769392
[4,] -0.55005650 -0.009934123
[5,]  0.08774653  0.815728360

[[10]]
     [,1] [,2]
[1,]    1    0
[2,]    0    1

[[11]]
     [,1] [,2]
[1,]    1    0
[2,]    0    1</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="3-Chapter_2.html#cb201-1"></a><span class="kw">library</span>(logmult)</span>
<span id="cb201-2"><a href="3-Chapter_2.html#cb201-2"></a></span>
<span id="cb201-3"><a href="3-Chapter_2.html#cb201-3"></a><span class="co">## 表2.3B</span></span>
<span id="cb201-4"><a href="3-Chapter_2.html#cb201-4"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">518</span>,  <span class="dv">95</span>, <span class="dv">6</span>, <span class="dv">35</span>, <span class="dv">5</span>,</span>
<span id="cb201-5"><a href="3-Chapter_2.html#cb201-5"></a>         　 <span class="dv">81</span>,  <span class="dv">67</span>, <span class="dv">4</span>, <span class="dv">49</span>, <span class="dv">2</span>,</span>
<span id="cb201-6"><a href="3-Chapter_2.html#cb201-6"></a>          <span class="dv">452</span>,<span class="dv">1003</span>,<span class="dv">67</span>,<span class="dv">630</span>, <span class="dv">5</span>,</span>
<span id="cb201-7"><a href="3-Chapter_2.html#cb201-7"></a>           <span class="dv">71</span>, <span class="dv">157</span>,<span class="dv">37</span>,<span class="dv">562</span>,<span class="dv">12</span>)</span>
<span id="cb201-8"><a href="3-Chapter_2.html#cb201-8"></a></span>
<span id="cb201-9"><a href="3-Chapter_2.html#cb201-9"></a><span class="co"># データを表形式に変換</span></span>
<span id="cb201-10"><a href="3-Chapter_2.html#cb201-10"></a>tab_<span class="fl">2.3</span>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(Freq, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">5</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.table</span>()</span>
<span id="cb201-11"><a href="3-Chapter_2.html#cb201-11"></a></span>
<span id="cb201-12"><a href="3-Chapter_2.html#cb201-12"></a><span class="kw">anoas</span>(tab_<span class="fl">2.3</span>B)</span></code></pre></div>
<pre><code>Fitting independence model...
Fitting model with 1 dimension...
Initialising
Running start-up iterations..
Running main iterations......................................................
Done
Fitting model with 2 dimensions...
Initialising
Running start-up iterations..
Running main iterations..........
Done
Fitting model with 3 dimensions...
Initialising
Running start-up iterations..
Running main iterations....
Done</code></pre>
<pre><code>       Res. Df           Res. Dev    Dev./Indep. (%)       Dissim. (%)
Indep.      12 1373.1757656522450 100.00000000000000 23.86157529528986
RC(1)        6  125.0597485501468   9.10733728910112  6.43603909812938
RC(2)        2    0.6001022352681   0.04370177877288  0.09351658022789
RC(3)        0    0.0000000000002   0.00000000000001  0.00000000000003
                      BIC                AIC    Dev. Df
Indep. 1274.0809153306568 1349.1757656522450      NA NA
RC(1)    75.5123233893527  113.0597485501468 -1248.1 -6
RC(2)   -15.9157061516633   -3.3998977647319  -124.5 -4
RC(3)     0.0000000000002    0.0000000000002    -0.6 -2</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="3-Chapter_2.html#cb204-1"></a>RC2 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb204-2"><a href="3-Chapter_2.html#cb204-2"></a>RC2 &lt;-<span class="st"> </span><span class="kw">rc</span>(tab_<span class="fl">2.3</span>B, <span class="dt">nd =</span> <span class="dv">2</span>, <span class="dt">weighting =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">se =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb204-3"><a href="3-Chapter_2.html#cb204-3"></a>             <span class="dt">nreplicates =</span> <span class="dv">500</span>, <span class="dt">ncpus =</span> <span class="kw">getOption</span>(<span class="st">&quot;boot.ncpus&quot;</span>))</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.......
Done
Computing bootstrap standard errors...
.</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="3-Chapter_2.html#cb206-1"></a>RC2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>() <span class="op">%$%</span><span class="st"> </span>coefficients <span class="op">%&gt;%</span></span>
<span id="cb206-2"><a href="3-Chapter_2.html#cb206-2"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb206-3"><a href="3-Chapter_2.html#cb206-3"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;Parameter&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb206-4"><a href="3-Chapter_2.html#cb206-4"></a><span class="st">  </span><span class="kw">arrange</span>(Parameter)</span></code></pre></div>
<pre><code>       Parameter   Normalized    Adjusted Std..error      Pr...z..
1           Dim1  2.600861491          NA 1.40757047  6.463614e-02
2  Dim1:ColumnsA  0.765099600  1.23389040 0.05015997  1.567829e-52
3  Dim1:ColumnsB  0.019661041  0.03170773 0.04507525  6.627042e-01
4  Dim1:ColumnsC -0.322450671 -0.52002222 0.10427799  1.986643e-03
5  Dim1:ColumnsD -0.550056503 -0.88708639 0.07752674  1.292997e-12
6  Dim1:ColumnsE  0.087746534  0.14151047 0.10893824  4.205482e-01
7     Dim1:RowsA  0.743451285  1.19897776 0.01968881  0.000000e+00
8     Dim1:RowsB  0.088464723  0.14266871 0.04212280  3.571457e-02
9     Dim1:RowsC -0.199842228 -0.32228929 0.03041533  5.016536e-11
10    Dim1:RowsD -0.632073780 -1.01935718 0.02644224 2.786797e-126
11          Dim2  1.521970931          NA 2.78490056  5.847167e-01
12 Dim2:ColumnsA -0.137064849 -0.16909442 0.05184356  8.197715e-03
13 Dim2:ColumnsB -0.548959996 -0.67724199 0.08105459  1.263839e-11
14 Dim2:ColumnsC -0.119769391 -0.14775733 0.09360023  2.006914e-01
15 Dim2:ColumnsD -0.009934124 -0.01225555 0.07368838  8.927600e-01
16 Dim2:ColumnsE  0.815728359  1.00634928 0.05170347  4.476139e-56
17    Dim2:RowsA  0.276199889  0.34074279 0.09614157  4.067928e-03
18    Dim2:RowsB -0.061036819 -0.07530002 0.14729920  6.786009e-01
19    Dim2:RowsC -0.777223437 -0.95884646 0.06966444  6.643062e-29
20    Dim2:RowsD  0.562060367  0.69340368 0.06870992  2.833899e-16</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="3-Chapter_2.html#cb208-1"></a><span class="co"># getS3method(&quot;assoc&quot;,&quot;rc&quot;)</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2-Chapter_1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="4-Chapter_3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Association_Models.pdf", "Association_Models.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
