<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 補足のノート | 『カテゴリカルデータの連関モデル』サポートページ</title>
  <meta name="description" content="8 補足のノート | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="8 補足のノート | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 補足のノート | 『カテゴリカルデータの連関モデル』サポートページ" />
  
  
  

<meta name="author" content="藤原翔（Sho Fujihara）" />


<meta name="date" content="2020-09-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="7-Chapter_6.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="1-Introduction.html"><a href="1-Introduction.html"><i class="fa fa-check"></i><b>1</b> はじめに</a><ul>
<li class="chapter" data-level="1.1" data-path="1-Introduction.html"><a href="1-Introduction.html#本ページの目的"><i class="fa fa-check"></i><b>1.1</b> 本ページの目的</a></li>
<li class="chapter" data-level="1.2" data-path="1-Introduction.html"><a href="1-Introduction.html#正誤表"><i class="fa fa-check"></i><b>1.2</b> 正誤表</a></li>
<li class="chapter" data-level="1.3" data-path="1-Introduction.html"><a href="1-Introduction.html#rのインストール"><i class="fa fa-check"></i><b>1.3</b> Rのインストール</a></li>
<li class="chapter" data-level="1.4" data-path="1-Introduction.html"><a href="1-Introduction.html#l_rm-emのインストール"><i class="fa fa-check"></i><b>1.4</b> <span class="math inline">\(l_{\rm EM}\)</span>のインストール</a></li>
<li class="chapter" data-level="1.5" data-path="1-Introduction.html"><a href="1-Introduction.html#シリーズ編者による序文"><i class="fa fa-check"></i><b>1.5</b> シリーズ編者による序文</a><ul>
<li class="chapter" data-level="1.5.1" data-path="1-Introduction.html"><a href="1-Introduction.html#独立性の検定"><i class="fa fa-check"></i><b>1.5.1</b> 独立性の検定</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-Introduction.html"><a href="1-Introduction.html#一様連関モデル"><i class="fa fa-check"></i><b>1.5.2</b> 一様連関モデル</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="1-Introduction.html"><a href="1-Introduction.html#度数行変数列変数のデータからクロス表を作成"><i class="fa fa-check"></i><b>1.6</b> 度数，行変数，列変数のデータからクロス表を作成</a></li>
<li class="chapter" data-level="1.7" data-path="1-Introduction.html"><a href="1-Introduction.html#練習問題"><i class="fa fa-check"></i><b>1.7</b> 練習問題</a></li>
<li class="chapter" data-level="1.8" data-path="1-Introduction.html"><a href="1-Introduction.html#参考文献"><i class="fa fa-check"></i><b>1.8</b> 参考文献</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-Chapter_1.html"><a href="2-Chapter_1.html"><i class="fa fa-check"></i><b>2</b> 第1章</a></li>
<li class="chapter" data-level="3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html"><i class="fa fa-check"></i><b>3</b> 第2章</a><ul>
<li class="chapter" data-level="3.1" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.1-p.8"><i class="fa fa-check"></i><b>3.1</b> 表2.1 (p.8)</a></li>
<li class="chapter" data-level="3.2" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.3-p.32"><i class="fa fa-check"></i><b>3.2</b> 表2.3 (p.32)</a></li>
<li class="chapter" data-level="3.3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4a"><i class="fa fa-check"></i><b>3.3</b> 表2.4A</a></li>
<li class="chapter" data-level="3.4" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4b"><i class="fa fa-check"></i><b>3.4</b> 表2.4B</a></li>
<li class="chapter" data-level="3.5" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.5a"><i class="fa fa-check"></i><b>3.5</b> 表2.5A</a></li>
<li class="chapter" data-level="3.6" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#logmultパッケージの利用"><i class="fa fa-check"></i><b>3.6</b> logmultパッケージの利用</a></li>
<li class="chapter" data-level="3.7" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6a"><i class="fa fa-check"></i><b>3.7</b> 表2.6A</a></li>
<li class="chapter" data-level="3.8" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6b"><i class="fa fa-check"></i><b>3.8</b> 表2.6B</a></li>
<li class="chapter" data-level="3.9" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6c"><i class="fa fa-check"></i><b>3.9</b> 表2.6C</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html"><i class="fa fa-check"></i><b>4</b> 第3章</a><ul>
<li class="chapter" data-level="4.1" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1a"><i class="fa fa-check"></i><b>4.1</b> 表3.1A</a></li>
<li class="chapter" data-level="4.2" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1b"><i class="fa fa-check"></i><b>4.2</b> 表3.1B</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-Chapter_4.html"><a href="5-Chapter_4.html"><i class="fa fa-check"></i><b>5</b> 第4章</a></li>
<li class="chapter" data-level="6" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html"><i class="fa fa-check"></i><b>6</b> 第5章</a><ul>
<li class="chapter" data-level="6.1" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html#表5.1"><i class="fa fa-check"></i><b>6.1</b> 表5.1</a></li>
<li class="chapter" data-level="6.2" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html#表5.4"><i class="fa fa-check"></i><b>6.2</b> 表5.4</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-Chapter_6.html"><a href="7-Chapter_6.html"><i class="fa fa-check"></i><b>7</b> 第6章</a></li>
<li class="chapter" data-level="8" data-path="8-Note.html"><a href="8-Note.html"><i class="fa fa-check"></i><b>8</b> 補足のノート</a><ul>
<li class="chapter" data-level="8.1" data-path="8-Note.html"><a href="8-Note.html#集計データの作成"><i class="fa fa-check"></i><b>8.1</b> 集計データの作成</a></li>
<li class="chapter" data-level="8.2" data-path="8-Note.html"><a href="8-Note.html#glmとgnmの結果の比較"><i class="fa fa-check"></i><b>8.2</b> GLMとGNMの結果の比較</a></li>
<li class="chapter" data-level="8.3" data-path="8-Note.html"><a href="8-Note.html#モザイクプロット"><i class="fa fa-check"></i><b>8.3</b> モザイクプロット</a></li>
<li class="chapter" data-level="8.4" data-path="8-Note.html"><a href="8-Note.html#正規化"><i class="fa fa-check"></i><b>8.4</b> 正規化</a></li>
<li class="chapter" data-level="8.5" data-path="8-Note.html"><a href="8-Note.html#初期値"><i class="fa fa-check"></i><b>8.5</b> 初期値</a></li>
</ul></li>
<li class="divider"></li>
<li></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="補足のノート" class="section level1">
<h1><span class="header-section-number">8</span> 補足のノート</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="8-Note.html#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="8-Note.html#cb1-2"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb1-3"><a href="8-Note.html#cb1-3"></a><span class="kw">library</span>(gnm)</span>
<span id="cb1-4"><a href="8-Note.html#cb1-4"></a><span class="kw">library</span>(vcd)</span></code></pre></div>
<div id="集計データの作成" class="section level2">
<h2><span class="header-section-number">8.1</span> 集計データの作成</h2>
<ul>
<li><p>度数はまず1行目について数値を並べ（1行1列から1行<span class="math inline">\(I\)</span>列まで），次に2行目について数値を並べる（2行1列から2行<span class="math inline">\(I\)</span>列まで）．これを<code>Freq</code>とする．</p></li>
<li><p>例として「編者による序文」の親の職業と精神的健康の例で考えてみる．これは<span class="math inline">\(6\times4\)</span>のクロス表なので，まず1行1列から1行4列までの数字を入力し，次に2行1列から2行4列まで入力する．これを3行目から6行目まで繰り返す．表との対応を考えて適当な改行をいれるのもよい．ただしRは改行を入れても入れなくても，単に数値の列（ベクトル）として扱う．</p></li>
<li><p><code>gl</code>によって変数を作成する．度数がどの行と列に対応しているのかに注意してほしい．</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="8-Note.html#cb2-1"></a><span class="co"># 1行1列から1行4列，・・・・，6行1列から6行4列まで順に入力</span></span>
<span id="cb2-2"><a href="8-Note.html#cb2-2"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">64</span>, <span class="dv">94</span>, <span class="dv">58</span>, <span class="dv">46</span>, <span class="dv">57</span>, <span class="dv">94</span>, <span class="dv">54</span>, <span class="dv">40</span>, <span class="dv">57</span>, <span class="dv">105</span>, <span class="dv">65</span>, <span class="dv">60</span>, <span class="dv">72</span>, <span class="dv">141</span>, <span class="dv">77</span>, <span class="dv">94</span>, <span class="dv">36</span>,  <span class="dv">97</span>, <span class="dv">54</span>, <span class="dv">78</span>, <span class="dv">21</span>, <span class="dv">71</span>, <span class="dv">54</span>, <span class="dv">71</span>)</span>
<span id="cb2-3"><a href="8-Note.html#cb2-3"></a></span>
<span id="cb2-4"><a href="8-Note.html#cb2-4"></a><span class="co"># 表ようにして入力</span></span>
<span id="cb2-5"><a href="8-Note.html#cb2-5"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">64</span>,  <span class="dv">94</span>, <span class="dv">58</span>, <span class="dv">46</span>, </span>
<span id="cb2-6"><a href="8-Note.html#cb2-6"></a>           <span class="dv">57</span>,  <span class="dv">94</span>, <span class="dv">54</span>, <span class="dv">40</span>,</span>
<span id="cb2-7"><a href="8-Note.html#cb2-7"></a>           <span class="dv">57</span>, <span class="dv">105</span>, <span class="dv">65</span>, <span class="dv">60</span>,</span>
<span id="cb2-8"><a href="8-Note.html#cb2-8"></a>           <span class="dv">72</span>, <span class="dv">141</span>, <span class="dv">77</span>, <span class="dv">94</span>,</span>
<span id="cb2-9"><a href="8-Note.html#cb2-9"></a>           <span class="dv">36</span>,  <span class="dv">97</span>, <span class="dv">54</span>, <span class="dv">78</span>,</span>
<span id="cb2-10"><a href="8-Note.html#cb2-10"></a>           <span class="dv">21</span>,  <span class="dv">71</span>, <span class="dv">54</span>, <span class="dv">71</span>)</span></code></pre></div>
<ul>
<li>行カテゴリと列カテゴリの数は<span class="math inline">\(I\)</span>や<span class="math inline">\(J\)</span>となっている．</li>
<li><code>I</code>を使いたいが，Rの関数にすでに用意されているので別の名前を考える．ここでは<code>NI</code>と<code>NJ</code>とする．</li>
<li>例のデータでは，行カテゴリ数<span class="math inline">\(I = 4\)</span>，列カテゴリ数<span class="math inline">\(J = 5\)</span>である．</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="8-Note.html#cb3-1"></a>NI &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb3-2"><a href="8-Note.html#cb3-2"></a>NJ &lt;-<span class="st"> </span><span class="dv">6</span></span></code></pre></div>
<ul>
<li>では，<code>Freq</code>に対応する行カテゴリと列カテゴリを並べてみる．先程の入力のルールにしたがうと，行については1行1列から1行4列までの数字を入力しているので<code>1,1,1,1</code>となり，次に<code>2,2,2,2</code>となる．これを繰り返し最後は<code>6,6,6,6</code>となる．列については，<code>1,2,3,4</code>が6回繰り返される．</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="8-Note.html#cb4-1"></a>Row &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>)</span>
<span id="cb4-2"><a href="8-Note.html#cb4-2"></a>Col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb4-3"><a href="8-Note.html#cb4-3"></a><span class="kw">class</span>(Row)</span></code></pre></div>
<pre><code>[1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="8-Note.html#cb6-1"></a><span class="kw">class</span>(Col)</span></code></pre></div>
<pre><code>[1] &quot;numeric&quot;</code></pre>
<ul>
<li>属性が数値になっているので<code>as.factor</code>（または<code>factor</code>）で因子（factor）に変換する．</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="8-Note.html#cb8-1"></a>Row &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Row)</span>
<span id="cb8-2"><a href="8-Note.html#cb8-2"></a>Col &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Col)</span>
<span id="cb8-3"><a href="8-Note.html#cb8-3"></a><span class="kw">class</span>(Row);<span class="kw">class</span>(Col)</span></code></pre></div>
<pre><code>[1] &quot;factor&quot;</code></pre>
<pre><code>[1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="8-Note.html#cb11-1"></a>Row;Col</span></code></pre></div>
<pre><code> [1] 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5 6 6 6 6
Levels: 1 2 3 4 5 6</code></pre>
<pre><code> [1] 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4
Levels: 1 2 3 4</code></pre>
<ul>
<li>単純な数値の列を作成したければ<code>rep</code>関数が便利である．これは整数（integer）となる．</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="8-Note.html#cb14-1"></a>Row &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">each =</span> <span class="dv">5</span>)</span>
<span id="cb14-2"><a href="8-Note.html#cb14-2"></a>Col &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb14-3"><a href="8-Note.html#cb14-3"></a><span class="kw">class</span>(Row); <span class="kw">class</span>(Col)</span></code></pre></div>
<pre><code>[1] &quot;integer&quot;</code></pre>
<pre><code>[1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="8-Note.html#cb17-1"></a>Row &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Row)</span>
<span id="cb17-2"><a href="8-Note.html#cb17-2"></a>Col &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Col)</span>
<span id="cb17-3"><a href="8-Note.html#cb17-3"></a><span class="kw">class</span>(Row); <span class="kw">class</span>(Col)</span></code></pre></div>
<pre><code>[1] &quot;factor&quot;</code></pre>
<pre><code>[1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="8-Note.html#cb20-1"></a>Row; Col</span></code></pre></div>
<pre><code> [1] 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4
Levels: 1 2 3 4</code></pre>
<pre><code> [1] 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
Levels: 1 2 3 4 5</code></pre>
<ul>
<li><code>gl</code>はGenerate Factor Levelsという関数で，<code>rep</code>に似ているが，数値ではなく因子を結果として出力する．</li>
<li>1から<code>n</code>までの数字をぞれぞれ<code>k</code>回繰り返して出力する．</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="8-Note.html#cb23-1"></a>Row &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">6</span>, <span class="dt">k =</span> <span class="dv">4</span>)</span>
<span id="cb23-2"><a href="8-Note.html#cb23-2"></a>Col &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">24</span>)</span>
<span id="cb23-3"><a href="8-Note.html#cb23-3"></a><span class="kw">class</span>(Row); <span class="kw">class</span>(Col)</span></code></pre></div>
<pre><code>[1] &quot;factor&quot;</code></pre>
<pre><code>[1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="8-Note.html#cb26-1"></a>Row; Col</span></code></pre></div>
<pre><code> [1] 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5 6 6 6 6
Levels: 1 2 3 4 5 6</code></pre>
<pre><code> [1] 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4
Levels: 1 2 3 4</code></pre>
<ul>
<li><code>Freq</code>，<code>Row</code>，<code>Col</code>からデータを作成する．<code>data.frame</code>と<code>tibble</code>のどちらでもよいが，
<code>tibble</code>の場合は表示させた後に，データの構造（<code>&lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;</code>）が表示される．</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="8-Note.html#cb29-1"></a>d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Freq, Row, Col)</span>
<span id="cb29-2"><a href="8-Note.html#cb29-2"></a>d</span></code></pre></div>
<pre><code>   Freq Row Col
1    64   1   1
2    94   1   2
3    58   1   3
4    46   1   4
5    57   2   1
6    94   2   2
7    54   2   3
8    40   2   4
9    57   3   1
10  105   3   2
11   65   3   3
12   60   3   4
13   72   4   1
14  141   4   2
15   77   4   3
16   94   4   4
17   36   5   1
18   97   5   2
19   54   5   3
20   78   5   4
21   21   6   1
22   71   6   2
23   54   6   3
24   71   6   4</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="8-Note.html#cb31-1"></a><span class="co"># tibble でもよい</span></span>
<span id="cb31-2"><a href="8-Note.html#cb31-2"></a>d &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, Row, Col)</span>
<span id="cb31-3"><a href="8-Note.html#cb31-3"></a>d</span></code></pre></div>
<pre><code># A tibble: 24 x 3
    Freq Row   Col  
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
 1    64 1     1    
 2    94 1     2    
 3    58 1     3    
 4    46 1     4    
 5    57 2     1    
 6    94 2     2    
 7    54 2     3    
 8    40 2     4    
 9    57 3     1    
10   105 3     2    
11    65 3     3    
12    60 3     4    
13    72 4     1    
14   141 4     2    
15    77 4     3    
16    94 4     4    
17    36 5     1    
18    97 5     2    
19    54 5     3    
20    78 5     4    
21    21 6     1    
22    71 6     2    
23    54 6     3    
24    71 6     4    </code></pre>
<ul>
<li>以上をまとめると次のようになる．</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="8-Note.html#cb33-1"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">64</span>, <span class="dv">94</span>, <span class="dv">58</span>, <span class="dv">46</span>, <span class="dv">57</span>, <span class="dv">94</span>, <span class="dv">54</span>, <span class="dv">40</span>, <span class="dv">57</span>, <span class="dv">105</span>, <span class="dv">65</span>, <span class="dv">60</span>, <span class="dv">72</span>, <span class="dv">141</span>, <span class="dv">77</span>, <span class="dv">94</span>, <span class="dv">36</span>,  <span class="dv">97</span>, <span class="dv">54</span>, <span class="dv">78</span>, <span class="dv">21</span>, <span class="dv">71</span>, <span class="dv">54</span>, <span class="dv">71</span>)</span>
<span id="cb33-2"><a href="8-Note.html#cb33-2"></a>NI &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb33-3"><a href="8-Note.html#cb33-3"></a>NJ &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb33-4"><a href="8-Note.html#cb33-4"></a>Row &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> NI, <span class="dt">k =</span> NJ, <span class="dt">length =</span> NI <span class="op">*</span><span class="st"> </span>NJ)</span>
<span id="cb33-5"><a href="8-Note.html#cb33-5"></a>Col &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> NJ, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> NI <span class="op">*</span><span class="st"> </span>NJ)</span>
<span id="cb33-6"><a href="8-Note.html#cb33-6"></a>d &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, Row, Col)</span>
<span id="cb33-7"><a href="8-Note.html#cb33-7"></a>d</span></code></pre></div>
<pre><code># A tibble: 24 x 3
    Freq Row   Col  
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
 1    64 1     1    
 2    94 1     2    
 3    58 1     3    
 4    46 1     4    
 5    57 1     5    
 6    94 1     6    
 7    54 2     1    
 8    40 2     2    
 9    57 2     3    
10   105 2     4    
11    65 2     5    
12    60 2     6    
13    72 3     1    
14   141 3     2    
15    77 3     3    
16    94 3     4    
17    36 3     5    
18    97 3     6    
19    54 4     1    
20    78 4     2    
21    21 4     3    
22    71 4     4    
23    54 4     5    
24    71 4     6    </code></pre>
</div>
<div id="glmとgnmの結果の比較" class="section level2">
<h2><span class="header-section-number">8.2</span> GLMとGNMの結果の比較</h2>
<ul>
<li>glmとgnmでは適合度や係数は同じだが，出力されるものが異なる．</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="8-Note.html#cb35-1"></a>fit_glm &lt;-<span class="st"> </span><span class="kw">glm</span>(Freq <span class="op">~</span><span class="st"> </span>Row <span class="op">+</span><span class="st"> </span>Col, <span class="dt">data =</span> d, <span class="dt">family =</span> poisson)</span>
<span id="cb35-2"><a href="8-Note.html#cb35-2"></a>fit_gnm &lt;-<span class="st"> </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Row <span class="op">+</span><span class="st"> </span>Col, <span class="dt">data =</span> d, <span class="dt">family =</span> poisson)</span>
<span id="cb35-3"><a href="8-Note.html#cb35-3"></a>fit_glm</span></code></pre></div>
<pre><code>
Call:  glm(formula = Freq ~ Row + Col, family = poisson, data = d)

Coefficients:
(Intercept)         Row2         Row3         Row4         Col2         Col3  
    4.10604     -0.08065      0.22460     -0.16838      0.36930     -0.13588  
       Col4         Col5         Col6  
    0.25857     -0.14058      0.27738  

Degrees of Freedom: 23 Total (i.e. Null);  15 Residual
Null Deviance:	    217.4 
Residual Deviance: 112 	AIC: 274.2</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="8-Note.html#cb37-1"></a>fit_gnm</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Row + Col, family = poisson, data = d)

Coefficients:
(Intercept)         Row2         Row3         Row4         Col2         Col3  
    4.10604     -0.08065      0.22460     -0.16838      0.36930     -0.13588  
       Col4         Col5         Col6  
    0.25857     -0.14058      0.27738  

Deviance:            112.0398 
Pearson chi-squared: 102.2928 
Residual df:         15 </code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="8-Note.html#cb39-1"></a><span class="kw">names</span>(fit_glm)</span></code></pre></div>
<pre><code> [1] &quot;coefficients&quot;      &quot;residuals&quot;         &quot;fitted.values&quot;    
 [4] &quot;effects&quot;           &quot;R&quot;                 &quot;rank&quot;             
 [7] &quot;qr&quot;                &quot;family&quot;            &quot;linear.predictors&quot;
[10] &quot;deviance&quot;          &quot;aic&quot;               &quot;null.deviance&quot;    
[13] &quot;iter&quot;              &quot;weights&quot;           &quot;prior.weights&quot;    
[16] &quot;df.residual&quot;       &quot;df.null&quot;           &quot;y&quot;                
[19] &quot;converged&quot;         &quot;boundary&quot;          &quot;model&quot;            
[22] &quot;call&quot;              &quot;formula&quot;           &quot;terms&quot;            
[25] &quot;data&quot;              &quot;offset&quot;            &quot;control&quot;          
[28] &quot;method&quot;            &quot;contrasts&quot;         &quot;xlevels&quot;          </code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="8-Note.html#cb41-1"></a><span class="kw">names</span>(fit_gnm)</span></code></pre></div>
<pre><code> [1] &quot;call&quot;          &quot;formula&quot;       &quot;terms&quot;         &quot;data&quot;         
 [5] &quot;eliminate&quot;     &quot;ofInterest&quot;    &quot;na.action&quot;     &quot;xlevels&quot;      
 [9] &quot;offset&quot;        &quot;tolerance&quot;     &quot;iterStart&quot;     &quot;iterMax&quot;      
[13] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;fitted.values&quot; &quot;rank&quot;         
[17] &quot;family&quot;        &quot;predictors&quot;    &quot;deviance&quot;      &quot;aic&quot;          
[21] &quot;iter&quot;          &quot;weights&quot;       &quot;prior.weights&quot; &quot;df.residual&quot;  
[25] &quot;y&quot;             &quot;converged&quot;     &quot;constrain&quot;     &quot;constrainTo&quot;  
[29] &quot;x&quot;             &quot;model&quot;        </code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="8-Note.html#cb43-1"></a><span class="kw">summary</span>(fit_glm)</span></code></pre></div>
<pre><code>
Call:
glm(formula = Freq ~ Row + Col, family = poisson, data = d)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.0571  -0.4520   0.4274   1.1667   3.5712  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  4.10604    0.07692  53.378  &lt; 2e-16 ***
Row2        -0.08065    0.07104  -1.135 0.256237    
Row3         0.22460    0.06600   3.403 0.000666 ***
Row4        -0.16838    0.07271  -2.316 0.020573 *  
Col2         0.36930    0.08325   4.436 9.17e-06 ***
Col3        -0.13588    0.09377  -1.449 0.147336    
Col4         0.25857    0.08522   3.034 0.002413 ** 
Col5        -0.14058    0.09389  -1.497 0.134314    
Col6         0.27738    0.08488   3.268 0.001083 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 217.40  on 23  degrees of freedom
Residual deviance: 112.04  on 15  degrees of freedom
AIC: 274.21

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="8-Note.html#cb45-1"></a><span class="kw">summary</span>(fit_gnm)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Row + Col, family = poisson, data = d)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.0571  -0.4520   0.4274   1.1667   3.5712  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  4.10604    0.07692  53.378  &lt; 2e-16 ***
Row2        -0.08065    0.07104  -1.135 0.256237    
Row3         0.22460    0.06600   3.403 0.000666 ***
Row4        -0.16838    0.07271  -2.316 0.020573 *  
Col2         0.36930    0.08325   4.436 9.17e-06 ***
Col3        -0.13588    0.09377  -1.449 0.147336    
Col4         0.25857    0.08522   3.034 0.002413 ** 
Col5        -0.14058    0.09389  -1.497 0.134314    
Col6         0.27738    0.08488   3.268 0.001083 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 112.04 on 15 degrees of freedom
AIC: 274.21

Number of iterations: 4</code></pre>
<ul>
<li>独立モデルと飽和モデル</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="8-Note.html#cb47-1"></a>fit_O &lt;-<span class="st"> </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Row <span class="op">+</span><span class="st"> </span>Col, <span class="dt">data =</span> d, <span class="dt">family =</span> poisson)</span>
<span id="cb47-2"><a href="8-Note.html#cb47-2"></a>fit_S &lt;-<span class="st"> </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Row <span class="op">+</span><span class="st"> </span>Col <span class="op">+</span><span class="st"> </span>Row<span class="op">:</span>Col, <span class="dt">data =</span> d, <span class="dt">family =</span> poisson)</span>
<span id="cb47-3"><a href="8-Note.html#cb47-3"></a><span class="kw">anova</span>(fit_O, fit_S)</span></code></pre></div>
<pre><code>Analysis of Deviance Table

Model 1: Freq ~ Row + Col
Model 2: Freq ~ Row + Col + Row:Col
  Resid. Df Resid. Dev Df Deviance
1        15     112.04            
2         0       0.00 15   112.04</code></pre>
<ul>
<li>期待度数を保存すれば期待度数についてのクロス表を作成することができる．飽和モデルの場合は，観測度数のクロス表と一致する．また独立モデルでの期待度数をみると，行によって列の幅が異なっていない（列によって行の幅がことなっていない）ことがわかる．</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="8-Note.html#cb49-1"></a>d <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">O_Freq =</span> fit_O<span class="op">$</span>fitted.values,</span>
<span id="cb49-2"><a href="8-Note.html#cb49-2"></a>              <span class="dt">S_Freq =</span> fit_S<span class="op">$</span>fitted.values)</span>
<span id="cb49-3"><a href="8-Note.html#cb49-3"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>Row <span class="op">+</span><span class="st"> </span>Col, <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mosaic</span>(<span class="dt">shade =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="8-Note_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="8-Note.html#cb50-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">xtabs</span>(O_Freq <span class="op">~</span><span class="st"> </span>Row <span class="op">+</span><span class="st"> </span>Col, <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mosaic</span>(<span class="dt">shade =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="8-Note_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="8-Note.html#cb51-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">xtabs</span>(S_Freq <span class="op">~</span><span class="st"> </span>Row <span class="op">+</span><span class="st"> </span>Col, <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mosaic</span>(<span class="dt">shade =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="8-Note_files/figure-html/unnamed-chunk-14-3.png" width="672" /></p>
</div>
<div id="モザイクプロット" class="section level2">
<h2><span class="header-section-number">8.3</span> モザイクプロット</h2>
<ul>
<li><code>mentalHealth</code>が用意されているのでこれを使ってみる．</li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="8-Note.html#cb52-1"></a>mentalHealth</span></code></pre></div>
<pre><code>   count SES      MHS
1     64   A     well
2     94   A     mild
3     58   A moderate
4     46   A impaired
5     57   B     well
6     94   B     mild
7     54   B moderate
8     40   B impaired
9     57   C     well
10   105   C     mild
11    65   C moderate
12    60   C impaired
13    72   D     well
14   141   D     mild
15    77   D moderate
16    94   D impaired
17    36   E     well
18    97   E     mild
19    54   E moderate
20    78   E impaired
21    21   F     well
22    71   F     mild
23    54   F moderate
24    71   F impaired</code></pre>
<ul>
<li><code>xtabs</code>は集計データからクロス表を作成する際に用いる．<code>xtabs(度数 ~ 行変数 + 列変数, data = データ名)</code>とすればよい．<code>mentalHealth</code>では<code>count</code>が度数を示している．</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="8-Note.html#cb54-1"></a>tab_mentalHealth &lt;-<span class="st"> </span><span class="kw">xtabs</span>(count <span class="op">~</span><span class="st"> </span>SES <span class="op">+</span><span class="st"> </span>MHS, <span class="dt">data =</span> mentalHealth)</span>
<span id="cb54-2"><a href="8-Note.html#cb54-2"></a>tab_mentalHealth</span></code></pre></div>
<pre><code>   MHS
SES well mild moderate impaired
  A   64   94       58       46
  B   57   94       54       40
  C   57  105       65       60
  D   72  141       77       94
  E   36   97       54       78
  F   21   71       54       71</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="8-Note.html#cb56-1"></a><span class="kw">mosaic</span>(tab_mentalHealth,</span>
<span id="cb56-2"><a href="8-Note.html#cb56-2"></a>       <span class="dt">shade =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="8-Note_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<ul>
<li>モデル適合度を表示するための関数</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="8-Note.html#cb57-1"></a>model.summary &lt;-<span class="st"> </span><span class="cf">function</span>(obj){</span>
<span id="cb57-2"><a href="8-Note.html#cb57-2"></a>  aic &lt;-<span class="st"> </span>obj<span class="op">$</span>deviance <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>df <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="co"># AIC(L2)</span></span>
<span id="cb57-3"><a href="8-Note.html#cb57-3"></a>  bic &lt;-<span class="st"> </span>obj<span class="op">$</span>deviance <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>df <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">sum</span>(obj<span class="op">$</span>y)) <span class="co">#BIC(L2)</span></span>
<span id="cb57-4"><a href="8-Note.html#cb57-4"></a>  delta &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(obj<span class="op">$</span>y <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>fitted.values)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(obj<span class="op">$</span>y))</span>
<span id="cb57-5"><a href="8-Note.html#cb57-5"></a>  p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(obj<span class="op">$</span>deviance, obj<span class="op">$</span>df, <span class="dt">lower.tail =</span> F)     <span class="co">#p&lt;-ifelse(p&lt;0.001,&quot;&lt;0.001&quot;,p)</span></span>
<span id="cb57-6"><a href="8-Note.html#cb57-6"></a>  result &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb57-7"><a href="8-Note.html#cb57-7"></a>  Model &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(obj))</span>
<span id="cb57-8"><a href="8-Note.html#cb57-8"></a>  result &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&quot;Model Description&quot;</span> =<span class="st"> </span>Model,</span>
<span id="cb57-9"><a href="8-Note.html#cb57-9"></a>              <span class="st">&quot;df&quot;</span> =<span class="st"> </span>obj<span class="op">$</span>df, </span>
<span id="cb57-10"><a href="8-Note.html#cb57-10"></a>              <span class="st">&quot;L2&quot;</span> =<span class="st"> </span>obj<span class="op">$</span>deviance, </span>
<span id="cb57-11"><a href="8-Note.html#cb57-11"></a>              <span class="co">#&quot;AIC(L2)&quot; = aic, </span></span>
<span id="cb57-12"><a href="8-Note.html#cb57-12"></a>              <span class="st">&quot;BIC&quot;</span> =<span class="st"> </span>bic, </span>
<span id="cb57-13"><a href="8-Note.html#cb57-13"></a>              <span class="st">&quot;Delta&quot;</span> =<span class="st"> </span>delta, </span>
<span id="cb57-14"><a href="8-Note.html#cb57-14"></a>              <span class="st">&quot;p&quot;</span> =<span class="st"> </span>p)</span>
<span id="cb57-15"><a href="8-Note.html#cb57-15"></a>  <span class="kw">return</span>(result)</span>
<span id="cb57-16"><a href="8-Note.html#cb57-16"></a>  }</span></code></pre></div>
<ul>
<li>変数と係数と係数の順番を表示するための関数</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="8-Note.html#cb58-1"></a><span class="co"># 変数と係数と係数の順番を表示</span></span>
<span id="cb58-2"><a href="8-Note.html#cb58-2"></a>var_num &lt;-<span class="st"> </span><span class="cf">function</span>(model){</span>
<span id="cb58-3"><a href="8-Note.html#cb58-3"></a><span class="kw">data.frame</span>(<span class="dt">var =</span> <span class="kw">names</span>(model<span class="op">$</span>coefficients),</span>
<span id="cb58-4"><a href="8-Note.html#cb58-4"></a>           <span class="dt">estimate =</span> model<span class="op">$</span>coefficients) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-5"><a href="8-Note.html#cb58-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> estimate,</span>
<span id="cb58-6"><a href="8-Note.html#cb58-6"></a>         <span class="dt">number =</span> <span class="kw">row_number</span>())</span>
<span id="cb58-7"><a href="8-Note.html#cb58-7"></a>}</span></code></pre></div>
</div>
<div id="正規化" class="section level2">
<h2><span class="header-section-number">8.4</span> 正規化</h2>
<ul>
<li>通常のRCモデルでは行スコアと列スコアが正規化されていない．</li>
<li>Agresti (2002)</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="8-Note.html#cb59-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb59-2"><a href="8-Note.html#cb59-2"></a><span class="co">##  Goodman Row-Column association model fits well (deviance 3.57, df 8)</span></span>
<span id="cb59-3"><a href="8-Note.html#cb59-3"></a>mentalHealth<span class="op">$</span>MHS &lt;-<span class="st"> </span><span class="kw">C</span>(mentalHealth<span class="op">$</span>MHS, treatment)</span>
<span id="cb59-4"><a href="8-Note.html#cb59-4"></a>mentalHealth<span class="op">$</span>SES &lt;-<span class="st"> </span><span class="kw">C</span>(mentalHealth<span class="op">$</span>SES, treatment)</span>
<span id="cb59-5"><a href="8-Note.html#cb59-5"></a></span>
<span id="cb59-6"><a href="8-Note.html#cb59-6"></a>O &lt;-<span class="st"> </span><span class="kw">gnm</span>(count <span class="op">~</span><span class="st"> </span>SES <span class="op">+</span><span class="st"> </span>MHS,</span>
<span id="cb59-7"><a href="8-Note.html#cb59-7"></a>         <span class="dt">family =</span> poisson, <span class="dt">data =</span> mentalHealth)</span>
<span id="cb59-8"><a href="8-Note.html#cb59-8"></a></span>
<span id="cb59-9"><a href="8-Note.html#cb59-9"></a>mult1 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(O, SES, MHS)</span>
<span id="cb59-10"><a href="8-Note.html#cb59-10"></a></span>
<span id="cb59-11"><a href="8-Note.html#cb59-11"></a>RC1 &lt;-<span class="st"> </span><span class="kw">gnm</span>(count <span class="op">~</span><span class="st"> </span>SES <span class="op">+</span><span class="st"> </span>MHS <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, SES, MHS),</span>
<span id="cb59-12"><a href="8-Note.html#cb59-12"></a>                <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(O), <span class="dv">1</span>, mult1),</span>
<span id="cb59-13"><a href="8-Note.html#cb59-13"></a>                <span class="dt">family =</span> poisson, <span class="dt">data =</span> mentalHealth)</span></code></pre></div>
<pre><code>Running main iterations..........
Done</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="8-Note.html#cb61-1"></a><span class="kw">summary</span>(RC1)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = count ~ SES + MHS + Mult(1, SES, MHS), family = poisson, 
    data = mentalHealth, start = c(coef(O), 1, mult1))

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.87231  -0.30982   0.01026   0.29898   0.87866  

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                  3.866262         NA      NA       NA
SESB                        -0.067328         NA      NA       NA
SESC                         0.103101         NA      NA       NA
SESD                         0.394428         NA      NA       NA
SESE                         0.005618         NA      NA       NA
SESF                        -0.227798         NA      NA       NA
MHSmild                      0.690089         NA      NA       NA
MHSmoderate                  0.177978         NA      NA       NA
MHSimpaired                  0.205737         NA      NA       NA
Mult(., SES, MHS).           1.009621         NA      NA       NA
Mult(1, ., MHS).SESA        -0.380306         NA      NA       NA
Mult(1, ., MHS).SESB        -0.383670         NA      NA       NA
Mult(1, ., MHS).SESC        -0.106430         NA      NA       NA
Mult(1, ., MHS).SESD         0.040661         NA      NA       NA
Mult(1, ., MHS).SESE         0.403979         NA      NA       NA
Mult(1, ., MHS).SESF         0.702468         NA      NA       NA
Mult(1, SES, .).MHSwell     -0.738572         NA      NA       NA
Mult(1, SES, .).MHSmild     -0.052542         NA      NA       NA
Mult(1, SES, .).MHSmoderate  0.071261         NA      NA       NA
Mult(1, SES, .).MHSimpaired  0.641064         NA      NA       NA

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 3.5706 on 8 degrees of freedom
AIC: 179.74

Number of iterations: 10</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="8-Note.html#cb63-1"></a><span class="kw">var_num</span>(RC1)</span></code></pre></div>
<pre><code>                           var    estimate number
1                  (Intercept)  3.86626244      1
2                         SESB -0.06732842      2
3                         SESC  0.10310129      3
4                         SESD  0.39442821      4
5                         SESE  0.00561777      5
6                         SESF -0.22779822      6
7                      MHSmild  0.69008918      7
8                  MHSmoderate  0.17797824      8
9                  MHSimpaired  0.20573705      9
10          Mult(., SES, MHS).  1.00962097     10
11        Mult(1, ., MHS).SESA -0.38030558     11
12        Mult(1, ., MHS).SESB -0.38367011     12
13        Mult(1, ., MHS).SESC -0.10642962     13
14        Mult(1, ., MHS).SESD  0.04066084     14
15        Mult(1, ., MHS).SESE  0.40397860     15
16        Mult(1, ., MHS).SESF  0.70246790     16
17     Mult(1, SES, .).MHSwell -0.73857153     17
18     Mult(1, SES, .).MHSmild -0.05254155     18
19 Mult(1, SES, .).MHSmoderate  0.07126103     19
20 Mult(1, SES, .).MHSimpaired  0.64106423     20</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="8-Note.html#cb65-1"></a><span class="co"># c(11,16,17,20)</span></span>
<span id="cb65-2"><a href="8-Note.html#cb65-2"></a></span>
<span id="cb65-3"><a href="8-Note.html#cb65-3"></a><span class="co">## Row scores and column scores are both unnormalized in this</span></span>
<span id="cb65-4"><a href="8-Note.html#cb65-4"></a><span class="co">## parameterization of the model </span></span>
<span id="cb65-5"><a href="8-Note.html#cb65-5"></a><span class="co">## The scores can be normalized as in Agresti&#39;s eqn (9.15):</span></span>
<span id="cb65-6"><a href="8-Note.html#cb65-6"></a>rowProbs &lt;-<span class="st"> </span><span class="kw">with</span>(mentalHealth, <span class="kw">tapply</span>(count, SES, sum) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(count))</span>
<span id="cb65-7"><a href="8-Note.html#cb65-7"></a>colProbs &lt;-<span class="st"> </span><span class="kw">with</span>(mentalHealth, <span class="kw">tapply</span>(count, MHS, sum) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(count))</span>
<span id="cb65-8"><a href="8-Note.html#cb65-8"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RC1, <span class="kw">pickCoef</span>(RC1, <span class="st">&quot;[.]SES&quot;</span>),</span>
<span id="cb65-9"><a href="8-Note.html#cb65-9"></a>                   <span class="dt">ref =</span> rowProbs, <span class="dt">scaleRef =</span> rowProbs,</span>
<span id="cb65-10"><a href="8-Note.html#cb65-10"></a>                   <span class="dt">scaleWeights =</span> rowProbs)</span>
<span id="cb65-11"><a href="8-Note.html#cb65-11"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RC1, <span class="kw">pickCoef</span>(RC1, <span class="st">&quot;[.]MHS&quot;</span>),</span>
<span id="cb65-12"><a href="8-Note.html#cb65-12"></a>                   <span class="dt">ref =</span> colProbs, <span class="dt">scaleRef =</span> colProbs,</span>
<span id="cb65-13"><a href="8-Note.html#cb65-13"></a>                   <span class="dt">scaleWeights =</span> colProbs)</span>
<span id="cb65-14"><a href="8-Note.html#cb65-14"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)], nu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span>
<span id="cb65-15"><a href="8-Note.html#cb65-15"></a>mu;nu</span></code></pre></div>
<pre><code>                        Estimate Std. Error
Mult(1, ., MHS).SESA -1.11233085  0.2990944
Mult(1, ., MHS).SESB -1.12143707  0.3138906
Mult(1, ., MHS).SESC -0.37107609  0.3194546
Mult(1, ., MHS).SESD  0.02702933  0.2734878
Mult(1, ., MHS).SESE  1.01036142  0.3149487
Mult(1, ., MHS).SESF  1.81823302  0.2824637</code></pre>
<pre><code>                              Estimate Std. Error
Mult(1, SES, .).MHSwell     -1.6775144  0.1941179
Mult(1, SES, .).MHSmild     -0.1403989  0.2002803
Mult(1, SES, .).MHSmoderate  0.1369926  0.2799954
Mult(1, SES, .).MHSimpaired  1.4136909  0.1724133</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="8-Note.html#cb68-1"></a><span class="kw">all.equal</span>(<span class="kw">sum</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>rowProbs), <span class="dv">0</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="8-Note.html#cb70-1"></a><span class="kw">all.equal</span>(<span class="kw">sum</span>(nu<span class="op">$</span>qvframe[,<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>colProbs), <span class="dv">0</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="8-Note.html#cb72-1"></a><span class="kw">all.equal</span>(<span class="kw">sum</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>rowProbs), <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="8-Note.html#cb74-1"></a><span class="kw">all.equal</span>(<span class="kw">sum</span>(nu<span class="op">$</span>qvframe[,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>colProbs), <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="8-Note.html#cb76-1"></a>RC1 &lt;-<span class="st"> </span><span class="kw">gnm</span>(count <span class="op">~</span><span class="st"> </span>SES <span class="op">+</span><span class="st"> </span>MHS <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, SES, MHS),</span>
<span id="cb76-2"><a href="8-Note.html#cb76-2"></a>                <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">20</span>),</span>
<span id="cb76-3"><a href="8-Note.html#cb76-3"></a>                <span class="dt">constrainTo =</span> con,</span>
<span id="cb76-4"><a href="8-Note.html#cb76-4"></a>                <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(O), <span class="ot">NA</span>, mult1),</span>
<span id="cb76-5"><a href="8-Note.html#cb76-5"></a>                <span class="dt">family =</span> poisson, <span class="dt">data =</span> mentalHealth)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...........
Done</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="8-Note.html#cb78-1"></a><span class="kw">summary</span>(RC1)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = count ~ SES + MHS + Mult(1, SES, MHS), constrain = c(11, 
    16, 17, 20), constrainTo = con, family = poisson, data = mentalHealth, 
    start = c(coef(O), NA, mult1))

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.87231  -0.30983   0.01026   0.29898   0.87866  

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  3.83919    0.10014  38.338  &lt; 2e-16 ***
SESB                        -0.06736    0.09033  -0.746   0.4558    
SESC                         0.10590    0.08929   1.186   0.2356    
SESD                         0.39873    0.08826   4.517 6.26e-06 ***
SESE                         0.01363    0.11020   0.124   0.9016    
SESF                        -0.21674    0.13232  -1.638   0.1014    
MHSmild                      0.71134    0.09556   7.444 9.77e-14 ***
MHSmoderate                  0.20306    0.10841   1.873   0.0611 .  
MHSimpaired                  0.24846    0.14842   1.674   0.0941 .  
Mult(., SES, MHS).           0.16649    0.03306   5.036 4.76e-07 ***
Mult(1, ., MHS).SESA        -1.11233         NA      NA       NA    
Mult(1, ., MHS).SESB        -1.12144    0.53209  -2.108   0.0351 *  
Mult(1, ., MHS).SESC        -0.37108    0.46573  -0.797   0.4256    
Mult(1, ., MHS).SESD         0.02703    0.42248   0.064   0.9490    
Mult(1, ., MHS).SESE         1.01036    0.50501   2.001   0.0454 *  
Mult(1, ., MHS).SESF         1.81823         NA      NA       NA    
Mult(1, SES, .).MHSwell     -1.67751         NA      NA       NA    
Mult(1, SES, .).MHSmild     -0.14040    0.34961  -0.402   0.6880    
Mult(1, SES, .).MHSmoderate  0.13699    0.39621   0.346   0.7295    
Mult(1, SES, .).MHSimpaired  1.41369         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 3.5706 on 8 degrees of freedom
AIC: 179.74

Number of iterations: 11</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="8-Note.html#cb80-1"></a>mu_unit &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RC1, <span class="kw">pickCoef</span>(RC1, <span class="st">&quot;[.]SES&quot;</span>),</span>
<span id="cb80-2"><a href="8-Note.html#cb80-2"></a>                   <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb80-3"><a href="8-Note.html#cb80-3"></a>                   <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb80-4"><a href="8-Note.html#cb80-4"></a>nu_unit &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(RC1, <span class="kw">pickCoef</span>(RC1, <span class="st">&quot;[.]MHS&quot;</span>),</span>
<span id="cb80-5"><a href="8-Note.html#cb80-5"></a>                   <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb80-6"><a href="8-Note.html#cb80-6"></a>                   <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb80-7"><a href="8-Note.html#cb80-7"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(mu_unit<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)], nu_unit<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span>
<span id="cb80-8"><a href="8-Note.html#cb80-8"></a>mu_unit;nu_unit;con</span></code></pre></div>
<pre><code>                         Estimate Std. Error
Mult(1, ., MHS).SESA -0.437796527  0.1127343
Mult(1, ., MHS).SESB -0.441250754  0.1141765
Mult(1, ., MHS).SESC -0.156615490  0.1224095
Mult(1, ., MHS).SESD -0.005601856  0.1126573
Mult(1, ., MHS).SESE  0.367406717  0.1240706
Mult(1, ., MHS).SESF  0.673857911  0.0932365</code></pre>
<pre><code>                               Estimate Std. Error
Mult(1, SES, .).MHSwell     -0.73265430 0.06465620
Mult(1, SES, .).MHSmild     -0.03347418 0.10831242
Mult(1, SES, .).MHSmoderate  0.09270177 0.12250920
Mult(1, SES, .).MHSimpaired  0.67342671 0.07862281</code></pre>
<pre><code>[1] -0.4377965  0.6738579 -0.7326543  0.6734267</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="8-Note.html#cb84-1"></a><span class="kw">all.equal</span>(<span class="kw">sum</span>(mu_unit<span class="op">$</span>qvframe[,<span class="dv">1</span>]), <span class="dv">0</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="8-Note.html#cb86-1"></a><span class="kw">all.equal</span>(<span class="kw">sum</span>(nu_unit<span class="op">$</span>qvframe[,<span class="dv">1</span>]), <span class="dv">0</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="8-Note.html#cb88-1"></a><span class="kw">all.equal</span>(<span class="kw">sum</span>(mu_unit<span class="op">$</span>qvframe[,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>), <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="8-Note.html#cb90-1"></a><span class="kw">all.equal</span>(<span class="kw">sum</span>(nu_unit<span class="op">$</span>qvframe[,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>), <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="8-Note.html#cb92-1"></a>RC1 &lt;-<span class="st"> </span><span class="kw">gnm</span>(count <span class="op">~</span><span class="st"> </span>SES <span class="op">+</span><span class="st"> </span>MHS <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, SES, MHS),</span>
<span id="cb92-2"><a href="8-Note.html#cb92-2"></a>                <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">20</span>),</span>
<span id="cb92-3"><a href="8-Note.html#cb92-3"></a>                <span class="dt">constrainTo =</span> con,</span>
<span id="cb92-4"><a href="8-Note.html#cb92-4"></a>                <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(O), <span class="ot">NA</span>, mult1),</span>
<span id="cb92-5"><a href="8-Note.html#cb92-5"></a>                <span class="dt">family =</span> poisson, </span>
<span id="cb92-6"><a href="8-Note.html#cb92-6"></a>                <span class="dt">data =</span> mentalHealth, </span>
<span id="cb92-7"><a href="8-Note.html#cb92-7"></a>                <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................
Done</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="8-Note.html#cb94-1"></a><span class="kw">summary</span>(RC1)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = count ~ SES + MHS + Mult(1, SES, MHS), constrain = c(11, 
    16, 17, 20), constrainTo = con, family = poisson, data = mentalHealth, 
    start = c(coef(O), NA, mult1), tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.87231  -0.30982   0.01026   0.29898   0.87866  

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  3.840354   0.100134  38.352  &lt; 2e-16 ***
SESB                        -0.067262   0.089460  -0.752   0.4521    
SESC                         0.097655   0.088726   1.101   0.2711    
SESD                         0.386057   0.087802   4.397 1.10e-05 ***
SESE                        -0.009979   0.110426  -0.090   0.9280    
SESF                        -0.249331   0.133563  -1.867   0.0619 .  
MHSmild                      0.722031   0.096153   7.509 5.95e-14 ***
MHSmoderate                  0.215685   0.108885   1.981   0.0476 *  
MHSimpaired                  0.269974   0.148273   1.821   0.0686 .  
Mult(., SES, MHS).           0.964896   0.191615   5.036 4.76e-07 ***
Mult(1, ., MHS).SESA        -0.437797         NA      NA       NA    
Mult(1, ., MHS).SESB        -0.441251   0.201840  -2.186   0.0288 *  
Mult(1, ., MHS).SESC        -0.156615   0.176666  -0.887   0.3753    
Mult(1, ., MHS).SESD        -0.005602   0.160260  -0.035   0.9721    
Mult(1, ., MHS).SESE         0.367407   0.191566   1.918   0.0551 .  
Mult(1, ., MHS).SESF         0.673858         NA      NA       NA    
Mult(1, SES, .).MHSwell     -0.732654         NA      NA       NA    
Mult(1, SES, .).MHSmild     -0.033474   0.159023  -0.210   0.8333    
Mult(1, SES, .).MHSmoderate  0.092701   0.180220   0.514   0.6070    
Mult(1, SES, .).MHSimpaired  0.673427         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 3.5706 on 8 degrees of freedom
AIC: 179.74

Number of iterations: 35</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="8-Note.html#cb96-1"></a>indep &lt;-<span class="st"> </span><span class="kw">gnm</span>(count <span class="op">~</span><span class="st"> </span>SES <span class="op">+</span><span class="st"> </span>MHS, <span class="dt">family =</span> poisson, <span class="dt">data =</span> mentalHealth)</span>
<span id="cb96-2"><a href="8-Note.html#cb96-2"></a>mult1 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(indep, SES, MHS)</span>
<span id="cb96-3"><a href="8-Note.html#cb96-3"></a><span class="co">## Now use mult1 as starting values for the RC1 association parameters</span></span>
<span id="cb96-4"><a href="8-Note.html#cb96-4"></a>RC1 &lt;-<span class="st"> </span><span class="kw">update</span>(indep, . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, SES, MHS),</span>
<span id="cb96-5"><a href="8-Note.html#cb96-5"></a>                   <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(indep), <span class="ot">NA</span>, mult1), <span class="dt">trace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>Initialising
Initial Deviance = 38.089282
Running start-up iterations
Start-up iteration 1. Deviance = 3.755746
Start-up iteration 2. Deviance = 3.681115
Running main iterations
Iteration 1. Deviance = 3.573067
Iteration 2. Deviance = 3.570683
Iteration 3. Deviance = 3.570572
Iteration 4. Deviance = 3.570563
Iteration 5. Deviance = 3.570563
Iteration 6. Deviance = 3.570562
Iteration 7. Deviance = 3.570562
Iteration 8. Deviance = 3.570562
Iteration 9. Deviance = 3.570562
Done</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="8-Note.html#cb98-1"></a><span class="co">## Similarly for the RC2 model:</span></span>
<span id="cb98-2"><a href="8-Note.html#cb98-2"></a>mult2 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(indep, SES, MHS, <span class="dt">d =</span> <span class="dv">2</span>)</span>
<span id="cb98-3"><a href="8-Note.html#cb98-3"></a></span>
<span id="cb98-4"><a href="8-Note.html#cb98-4"></a>RC2model &lt;-<span class="st"> </span><span class="kw">update</span>(indep, . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span><span class="kw">instances</span>(<span class="kw">Mult</span>(<span class="dv">1</span>, SES, MHS), <span class="dv">2</span>),</span>
<span id="cb98-5"><a href="8-Note.html#cb98-5"></a>                   <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(indep), <span class="ot">NA</span>, mult2[,<span class="dv">1</span>], <span class="ot">NA</span>, mult2[,<span class="dv">2</span>]), <span class="dt">trace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>Initialising
Initial Deviance = 33.954322
Running start-up iterations
Start-up iteration 1. Deviance = 1.025394
Start-up iteration 2. Deviance = 0.9464365
Running main iterations
Iteration 1. Deviance = 0.5804567
Iteration 2. Deviance = 0.5330751
Iteration 3. Deviance = 0.5244931
Iteration 4. Deviance = 0.5228986
Iteration 5. Deviance = 0.5226026
Iteration 6. Deviance = 0.5225478
Iteration 7. Deviance = 0.5225376
Iteration 8. Deviance = 0.5225357
Iteration 9. Deviance = 0.5225354
Iteration 10. Deviance = 0.5225353
Iteration 11. Deviance = 0.5225353
Iteration 12. Deviance = 0.5225353
Iteration 13. Deviance = 0.5225353
Iteration 14. Deviance = 0.5225353
Iteration 15. Deviance = 0.5225353
Iteration 16. Deviance = 0.5225353
Done</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="8-Note.html#cb100-1"></a><span class="kw">summary</span>(RC2model)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = count ~ SES + MHS + instances(Mult(1, SES, MHS), 
    2), family = poisson, data = mentalHealth, start = c(coef(indep), 
    NA, mult2[, 1], NA, mult2[, 2]), trace = TRUE)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.28503  -0.09563   0.02541   0.06725   0.39201  

Coefficients:
                                      Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            3.84110         NA      NA       NA
SESB                                  -0.06768         NA      NA       NA
SESC                                   0.10665         NA      NA       NA
SESD                                   0.39778         NA      NA       NA
SESE                                   0.01444         NA      NA       NA
SESF                                  -0.21866         NA      NA       NA
MHSmild                                0.70985         NA      NA       NA
MHSmoderate                            0.19844         NA      NA       NA
MHSimpaired                            0.24250         NA      NA       NA
Mult(., SES, MHS, inst = 1).           1.03916         NA      NA       NA
Mult(1, ., MHS, inst = 1).SESA        -0.40477         NA      NA       NA
Mult(1, ., MHS, inst = 1).SESB        -0.41380         NA      NA       NA
Mult(1, ., MHS, inst = 1).SESC        -0.13459         NA      NA       NA
Mult(1, ., MHS, inst = 1).SESD         0.02416         NA      NA       NA
Mult(1, ., MHS, inst = 1).SESE         0.36451         NA      NA       NA
Mult(1, ., MHS, inst = 1).SESF         0.68039         NA      NA       NA
Mult(1, SES, ., inst = 1).MHSwell     -0.75397         NA      NA       NA
Mult(1, SES, ., inst = 1).MHSmild     -0.06295         NA      NA       NA
Mult(1, SES, ., inst = 1).MHSmoderate  0.06246         NA      NA       NA
Mult(1, SES, ., inst = 1).MHSimpaired  0.62599         NA      NA       NA
Mult(., SES, MHS, inst = 2).           1.08518         NA      NA       NA
Mult(1, ., MHS, inst = 2).SESA        -0.08455         NA      NA       NA
Mult(1, ., MHS, inst = 2).SESB        -0.13438         NA      NA       NA
Mult(1, ., MHS, inst = 2).SESC        -0.07836         NA      NA       NA
Mult(1, ., MHS, inst = 2).SESD         0.22834         NA      NA       NA
Mult(1, ., MHS, inst = 2).SESE         0.18378         NA      NA       NA
Mult(1, ., MHS, inst = 2).SESF        -0.27823         NA      NA       NA
Mult(1, SES, ., inst = 2).MHSwell      0.19077         NA      NA       NA
Mult(1, SES, ., inst = 2).MHSmild      0.05320         NA      NA       NA
Mult(1, SES, ., inst = 2).MHSmoderate -0.40204         NA      NA       NA
Mult(1, SES, ., inst = 2).MHSimpaired  0.15992         NA      NA       NA

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 0.52254 on 3 degrees of freedom
AIC: 186.7

Number of iterations: 16</code></pre>
</div>
<div id="初期値" class="section level2">
<h2><span class="header-section-number">8.5</span> 初期値</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="8-Note.html#cb102-1"></a><span class="co"># データの準備</span></span>
<span id="cb102-2"><a href="8-Note.html#cb102-2"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">39</span>, <span class="dv">50</span>, <span class="dv">18</span>,  <span class="dv">4</span>,</span>
<span id="cb102-3"><a href="8-Note.html#cb102-3"></a>          <span class="dv">140</span>,<span class="dv">178</span>, <span class="dv">85</span>, <span class="dv">23</span>,</span>
<span id="cb102-4"><a href="8-Note.html#cb102-4"></a>          <span class="dv">108</span>,<span class="dv">195</span>, <span class="dv">97</span>, <span class="dv">23</span>,</span>
<span id="cb102-5"><a href="8-Note.html#cb102-5"></a>          <span class="dv">238</span>,<span class="dv">598</span>,<span class="dv">363</span>,<span class="dv">111</span>,</span>
<span id="cb102-6"><a href="8-Note.html#cb102-6"></a>           <span class="dv">78</span>,<span class="dv">250</span>,<span class="dv">150</span>, <span class="dv">55</span>,</span>
<span id="cb102-7"><a href="8-Note.html#cb102-7"></a>           <span class="dv">50</span>,<span class="dv">200</span>,<span class="dv">208</span>, <span class="dv">74</span>,</span>
<span id="cb102-8"><a href="8-Note.html#cb102-8"></a>            <span class="dv">8</span>, <span class="dv">29</span>, <span class="dv">46</span>, <span class="dv">21</span>)</span>
<span id="cb102-9"><a href="8-Note.html#cb102-9"></a></span>
<span id="cb102-10"><a href="8-Note.html#cb102-10"></a>tab_<span class="fl">2.3</span>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(Freq, <span class="dt">nrow =</span> <span class="dv">7</span>, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.table</span>()</span>
<span id="cb102-11"><a href="8-Note.html#cb102-11"></a></span>
<span id="cb102-12"><a href="8-Note.html#cb102-12"></a>polviews &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">7</span>, <span class="dt">k =</span> <span class="dv">4</span>)</span>
<span id="cb102-13"><a href="8-Note.html#cb102-13"></a>fefam &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">28</span>)</span>
<span id="cb102-14"><a href="8-Note.html#cb102-14"></a>freq_tab_<span class="fl">2.3</span>A &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, polviews, fefam)</span>
<span id="cb102-15"><a href="8-Note.html#cb102-15"></a>freq_tab_<span class="fl">2.3</span>A</span></code></pre></div>
<pre><code># A tibble: 28 x 3
    Freq polviews fefam
   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;
 1    39 1        1    
 2    50 1        2    
 3    18 1        3    
 4     4 1        4    
 5   140 2        1    
 6   178 2        2    
 7    85 2        3    
 8    23 2        4    
 9   108 3        1    
10   195 3        2    
11    97 3        3    
12    23 3        4    
13   238 4        1    
14   598 4        2    
15   363 4        3    
16   111 4        4    
17    78 5        1    
18   250 5        2    
19   150 5        3    
20    55 5        4    
21    50 6        1    
22   200 6        2    
23   208 6        3    
24    74 6        4    
25     8 7        1    
26    29 7        2    
27    46 7        3    
28    21 7        4    </code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="8-Note.html#cb104-1"></a><span class="co"># 独立モデル</span></span>
<span id="cb104-2"><a href="8-Note.html#cb104-2"></a>O &lt;-<span class="st"> </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam, </span>
<span id="cb104-3"><a href="8-Note.html#cb104-3"></a>         <span class="dt">family =</span> poisson, </span>
<span id="cb104-4"><a href="8-Note.html#cb104-4"></a>         <span class="dt">data =</span> freq_tab_<span class="fl">2.3</span>A, </span>
<span id="cb104-5"><a href="8-Note.html#cb104-5"></a>         <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb104-6"><a href="8-Note.html#cb104-6"></a></span>
<span id="cb104-7"><a href="8-Note.html#cb104-7"></a><span class="kw">var_num</span>(O)</span></code></pre></div>
<pre><code>           var   estimate number
1  (Intercept)  3.0603480      1
2    polviews2  1.3449091      2
3    polviews3  1.3378420      3
4    polviews4  2.4682522      4
5    polviews5  1.5689912      5
6    polviews6  1.5671133      6
7    polviews7 -0.0651393      7
8       fefam2  0.8194665      8
9       fefam3  0.3804447      9
10      fefam4 -0.7539609     10</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="8-Note.html#cb106-1"></a>RC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span></span>
<span id="cb106-2"><a href="8-Note.html#cb106-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam),</span>
<span id="cb106-3"><a href="8-Note.html#cb106-3"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb106-4"><a href="8-Note.html#cb106-4"></a>      <span class="dt">data =</span> ., </span>
<span id="cb106-5"><a href="8-Note.html#cb106-5"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...........................
Done</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="8-Note.html#cb108-1"></a><span class="kw">var_num</span>(RC)</span></code></pre></div>
<pre><code>                           var     estimate number
1                  (Intercept)  2.917797939      1
2                    polviews2  1.389634204      2
3                    polviews3  1.425014233      3
4                    polviews4  2.582596002      4
5                    polviews5  1.681176911      5
6                    polviews6  1.618470919      6
7                    polviews7 -0.123844371      7
8                       fefam2  0.879615228      8
9                       fefam3  0.397211555      9
10                      fefam4 -0.788036894     10
11   Mult(., polviews, fefam). -2.092563619     11
12 Mult(1, ., fefam).polviews1  0.681313030     12
13 Mult(1, ., fefam).polviews2  0.524126364     13
14 Mult(1, ., fefam).polviews3  0.314210971     14
15 Mult(1, ., fefam).polviews4 -0.009667259     15
16 Mult(1, ., fefam).polviews5 -0.148956667     16
17 Mult(1, ., fefam).polviews6 -0.604460617     17
18 Mult(1, ., fefam).polviews7 -0.993821182     18
19 Mult(1, polviews, .).fefam1 -0.531378908     19
20 Mult(1, polviews, .).fefam2 -0.067644650     20
21 Mult(1, polviews, .).fefam3  0.293838210     21
22 Mult(1, polviews, .).fefam4  0.465316048     22</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="8-Note.html#cb110-1"></a>mult1 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(O, polviews, fefam)</span>
<span id="cb110-2"><a href="8-Note.html#cb110-2"></a>mult2 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(O, polviews, fefam, <span class="dt">d =</span> <span class="dv">2</span>)</span>
<span id="cb110-3"><a href="8-Note.html#cb110-3"></a>mult3 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(O, polviews, fefam, <span class="dt">d =</span> <span class="dv">3</span>)</span>
<span id="cb110-4"><a href="8-Note.html#cb110-4"></a></span>
<span id="cb110-5"><a href="8-Note.html#cb110-5"></a>RC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span></span>
<span id="cb110-6"><a href="8-Note.html#cb110-6"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam),</span>
<span id="cb110-7"><a href="8-Note.html#cb110-7"></a>      <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(O), <span class="ot">NA</span>, mult1),</span>
<span id="cb110-8"><a href="8-Note.html#cb110-8"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb110-9"><a href="8-Note.html#cb110-9"></a>      <span class="dt">data =</span> ., </span>
<span id="cb110-10"><a href="8-Note.html#cb110-10"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................
Done</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="8-Note.html#cb112-1"></a><span class="kw">summary</span>(RC)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam), 
    family = poisson, data = ., start = c(coef(O), NA, mult1), 
    tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.07428  -0.27239   0.03038   0.36792   1.03721  

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                  2.923005         NA      NA       NA
polviews2                    1.386069         NA      NA       NA
polviews3                    1.416687         NA      NA       NA
polviews4                    2.566922         NA      NA       NA
polviews5                    1.662344         NA      NA       NA
polviews6                    1.589306         NA      NA       NA
polviews7                   -0.161841         NA      NA       NA
fefam2                       0.888744         NA      NA       NA
fefam3                       0.413456         NA      NA       NA
fefam4                      -0.768417         NA      NA       NA
Mult(., polviews, fefam).    1.056560         NA      NA       NA
Mult(1, ., fefam).polviews1 -0.698458         NA      NA       NA
Mult(1, ., fefam).polviews2 -0.539511         NA      NA       NA
Mult(1, ., fefam).polviews3 -0.327244         NA      NA       NA
Mult(1, ., fefam).polviews4  0.000263         NA      NA       NA
Mult(1, ., fefam).polviews5  0.141113         NA      NA       NA
Mult(1, ., fefam).polviews6  0.601720         NA      NA       NA
Mult(1, ., fefam).polviews7  0.995442         NA      NA       NA
Mult(1, polviews, .).fefam1 -1.019529         NA      NA       NA
Mult(1, polviews, .).fefam2 -0.111258         NA      NA       NA
Mult(1, polviews, .).fefam3  0.596743         NA      NA       NA
Mult(1, polviews, .).fefam4  0.932600         NA      NA       NA

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 8.0718 on 10 degrees of freedom
AIC: 215.43

Number of iterations: 35</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="8-Note.html#cb114-1"></a>RC2 &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span></span>
<span id="cb114-2"><a href="8-Note.html#cb114-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam, <span class="dt">inst =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam, <span class="dt">inst =</span> <span class="dv">2</span>),</span>
<span id="cb114-3"><a href="8-Note.html#cb114-3"></a>      <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(O), <span class="ot">NA</span>, mult2[,<span class="dv">1</span>], <span class="ot">NA</span>, mult2[,<span class="dv">2</span>]),</span>
<span id="cb114-4"><a href="8-Note.html#cb114-4"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb114-5"><a href="8-Note.html#cb114-5"></a>      <span class="dt">data =</span> ., </span>
<span id="cb114-6"><a href="8-Note.html#cb114-6"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
...............
Done</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="8-Note.html#cb116-1"></a><span class="kw">summary</span>(RC2)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam, 
    inst = 1) + Mult(1, polviews, fefam, inst = 2), family = poisson, 
    data = ., start = c(coef(O), NA, mult2[, 1], NA, mult2[, 
        2]), tolerance = 1e-12)

Deviance Residuals: 
      Min         1Q     Median         3Q        Max  
-0.500439  -0.068726  -0.002705   0.066147   0.535693  

Coefficients:
                                      Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            2.91819         NA      NA       NA
polviews2                              1.39397         NA      NA       NA
polviews3                              1.41864         NA      NA       NA
polviews4                              2.56796         NA      NA       NA
polviews5                              1.65784         NA      NA       NA
polviews6                              1.59466         NA      NA       NA
polviews7                             -0.14115         NA      NA       NA
fefam2                                 0.88413         NA      NA       NA
fefam3                                 0.42555         NA      NA       NA
fefam4                                -0.75373         NA      NA       NA
Mult(., polviews, fefam, inst = 1).    1.00492         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews1 -0.75964         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews2 -0.52028         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews3 -0.35691         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews4 -0.01452         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews5  0.12908         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews6  0.60928         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews7  0.95887         NA      NA       NA
Mult(1, polviews, ., inst = 1).fefam1 -0.91476         NA      NA       NA
Mult(1, polviews, ., inst = 1).fefam2 -0.19195         NA      NA       NA
Mult(1, polviews, ., inst = 1).fefam3  0.63323         NA      NA       NA
Mult(1, polviews, ., inst = 1).fefam4  0.96989         NA      NA       NA
Mult(., polviews, fefam, inst = 2).    0.63836         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews1  0.14115         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews2  0.43421         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews3  0.06787         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews4 -0.07766         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews5 -0.33262         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews6 -0.06627         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews7  0.39887         NA      NA       NA
Mult(1, polviews, ., inst = 2).fefam1  0.53563         NA      NA       NA
Mult(1, polviews, ., inst = 2).fefam2 -0.41197         NA      NA       NA
Mult(1, polviews, ., inst = 2).fefam3  0.20277         NA      NA       NA
Mult(1, polviews, ., inst = 2).fefam4  0.06536         NA      NA       NA

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 1.3691 on 4 degrees of freedom
AIC: 220.72

Number of iterations: 72</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="8-Note.html#cb118-1"></a>RC3 &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>A <span class="op">%&gt;%</span></span>
<span id="cb118-2"><a href="8-Note.html#cb118-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam, <span class="dt">inst =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb118-3"><a href="8-Note.html#cb118-3"></a><span class="st">        </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam, <span class="dt">inst =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb118-4"><a href="8-Note.html#cb118-4"></a><span class="st">        </span><span class="kw">Mult</span>(<span class="dv">1</span>,polviews,fefam, <span class="dt">inst =</span> <span class="dv">3</span>),</span>
<span id="cb118-5"><a href="8-Note.html#cb118-5"></a>      <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(O), <span class="ot">NA</span>, mult3[,<span class="dv">1</span>], <span class="ot">NA</span>, mult3[,<span class="dv">2</span>], <span class="ot">NA</span>, mult3[,<span class="dv">3</span>]),</span>
<span id="cb118-6"><a href="8-Note.html#cb118-6"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb118-7"><a href="8-Note.html#cb118-7"></a>      <span class="dt">data =</span> ., </span>
<span id="cb118-8"><a href="8-Note.html#cb118-8"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations....
Done</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="8-Note.html#cb120-1"></a><span class="kw">summary</span>(RC3)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + Mult(1, polviews, fefam, 
    inst = 1) + Mult(1, polviews, fefam, inst = 2) + Mult(1, 
    polviews, fefam, inst = 3), family = poisson, data = ., start = c(coef(O), 
    NA, mult3[, 1], NA, mult3[, 2], NA, mult3[, 3]), tolerance = 1e-12)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
     0       0       0       0       0  

Coefficients:
                                      Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            2.91910         NA      NA       NA
polviews2                              1.39510         NA      NA       NA
polviews3                              1.41763         NA      NA       NA
polviews4                              2.56790         NA      NA       NA
polviews5                              1.65780         NA      NA       NA
polviews6                              1.59247         NA      NA       NA
polviews7                             -0.13766         NA      NA       NA
fefam2                                 0.88275         NA      NA       NA
fefam3                                 0.42469         NA      NA       NA
fefam4                                -0.75453         NA      NA       NA
Mult(., polviews, fefam, inst = 1).    1.00014         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews1 -0.77446         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews2 -0.50579         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews3 -0.39714         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews4 -0.01256         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews5  0.16821         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews6  0.59266         NA      NA       NA
Mult(1, ., fefam, inst = 1).polviews7  0.93685         NA      NA       NA
Mult(1, polviews, ., inst = 1).fefam1 -0.91234         NA      NA       NA
Mult(1, polviews, ., inst = 1).fefam2 -0.18084         NA      NA       NA
Mult(1, polviews, ., inst = 1).fefam3  0.60069         NA      NA       NA
Mult(1, polviews, ., inst = 1).fefam4  1.02512         NA      NA       NA
Mult(., polviews, fefam, inst = 2).    0.61713         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews1  0.11254         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews2  0.48026         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews3 -0.03266         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews4 -0.07847         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews5 -0.22089         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews6 -0.15511         NA      NA       NA
Mult(1, ., fefam, inst = 2).polviews7  0.45887         NA      NA       NA
Mult(1, polviews, ., inst = 2).fefam1  0.55594         NA      NA       NA
Mult(1, polviews, ., inst = 2).fefam2 -0.37729         NA      NA       NA
Mult(1, polviews, ., inst = 2).fefam3  0.06150         NA      NA       NA
Mult(1, polviews, ., inst = 2).fefam4  0.29591         NA      NA       NA
Mult(., polviews, fefam, inst = 3).    0.93372         NA      NA       NA
Mult(1, ., fefam, inst = 3).polviews1  0.02727         NA      NA       NA
Mult(1, ., fefam, inst = 3).polviews2 -0.03813         NA      NA       NA
Mult(1, ., fefam, inst = 3).polviews3  0.19104         NA      NA       NA
Mult(1, ., fefam, inst = 3).polviews4 -0.02432         NA      NA       NA
Mult(1, ., fefam, inst = 3).polviews5 -0.30078         NA      NA       NA
Mult(1, ., fefam, inst = 3).polviews6  0.18379         NA      NA       NA
Mult(1, ., fefam, inst = 3).polviews7  0.15198         NA      NA       NA
Mult(1, polviews, ., inst = 3).fefam1 -0.03232         NA      NA       NA
Mult(1, polviews, ., inst = 3).fefam2 -0.14527         NA      NA       NA
Mult(1, polviews, ., inst = 3).fefam3  0.29780         NA      NA       NA
Mult(1, polviews, ., inst = 3).fefam4 -0.18814         NA      NA       NA

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: -4.9516e-14 on 0 degrees of freedom
AIC: 227.35

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="8-Note.html#cb122-1"></a><span class="kw">library</span>(logmult)</span>
<span id="cb122-2"><a href="8-Note.html#cb122-2"></a>anoas_model &lt;-<span class="st"> </span><span class="kw">anoas</span>(tab_<span class="fl">2.3</span>A, <span class="dt">nd =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>Fitting independence model...
Fitting model with 1 dimension...
Initialising
Running start-up iterations..
Running main iterations..........
Done
Fitting model with 2 dimensions...
Initialising
Running start-up iterations..
Running main iterations...........................
Done
Fitting model with 3 dimensions...
Initialising
Running start-up iterations..
Running main iterations......
Done</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="8-Note.html#cb124-1"></a>anoas_model</span></code></pre></div>
<pre><code>       Res. Df           Res. Dev    Dev./Indep. (%)      Dissim. (%)
Indep.      18 211.69508974175707 100.00000000000000 8.09171028964660
RC(1)       10   8.07181892815003   3.81294575041712 1.76730792803994
RC(2)        4   1.36909098846097   0.64672779615772 0.49639214356899
RC(3)        0   0.00000000000007   0.00000000000003 0.00000000000003
                      BIC                AIC Dev. Df
Indep.  65.12224155397629 175.69508974175707   NA NA
RC(1)  -73.35754117617262 -11.92818107184997 -204 -8
RC(2)  -31.20265305326809  -6.63090901153903   -7 -6
RC(3)    0.00000000000007   0.00000000000007   -1 -4</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="8-Note.html#cb126-1"></a><span class="kw">summary</span>(anoas_model)</span></code></pre></div>
<pre><code>       Res. Df           Res. Dev    Dev./Indep. (%)      Dissim. (%)
Indep.      18 211.69508974175707 100.00000000000000 8.09171028964660
RC(1)       10   8.07181892815003   3.81294575041712 1.76730792803994
RC(2)        4   1.36909098846097   0.64672779615772 0.49639214356899
RC(3)        0   0.00000000000007   0.00000000000003 0.00000000000003
                      BIC                AIC Dev. Df
Indep.  65.12224155397629 175.69508974175707   NA NA
RC(1)  -73.35754117617262 -11.92818107184997 -204 -8
RC(2)  -31.20265305326809  -6.63090901153903   -7 -6
RC(3)    0.00000000000007   0.00000000000007   -1 -4</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="8-Note.html#cb128-1"></a><span class="kw">rc</span>(tab_<span class="fl">2.3</span>A, <span class="dt">d =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations..........
Done</code></pre>
<pre><code>Call:
rc(tab = tab_2.3A, diagonal = 3)

Intrinsic association coefficients:
 Dim1 
0.259 

Normalized row scores (Rows):
      A       B       C       D       E       F       G 
 1.4876  1.3963  1.1207 -0.0203 -0.3155 -1.4779 -2.4334 

Normalized column scores (Columns):
     A      B      C      D 
 1.475  0.354 -1.077 -1.492 

Diagonal coefficients:
    A:A     B:B     C:C     D:D     E:A     F:B     G:C 
 0.2586 -0.2981  0.2310 -0.0498  0.2586 -0.2981  0.2310 

Normalization weights: marginal
Deviance:              3.191348
Pearson chi-squared:   3.221668
Dissimilarity index:   0.9476085%
Residual df:           6
BIC:                   -45.66627
AIC:                   -8.808652</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="8-Note.html#cb131-1"></a><span class="kw">bind_rows</span>(</span>
<span id="cb131-2"><a href="8-Note.html#cb131-2"></a><span class="kw">model.summary</span>(O),</span>
<span id="cb131-3"><a href="8-Note.html#cb131-3"></a><span class="kw">model.summary</span>(RC),</span>
<span id="cb131-4"><a href="8-Note.html#cb131-4"></a><span class="kw">model.summary</span>(RC2),</span>
<span id="cb131-5"><a href="8-Note.html#cb131-5"></a><span class="kw">model.summary</span>(RC3))</span></code></pre></div>
<pre><code># A tibble: 4 x 6
  `Model Description`    df        L2       BIC    Delta     p
  &lt;chr&gt;               &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 O                      18  2.12e+ 2  6.51e+ 1 8.09e+ 0 1    
2 RC                     10  8.07e+ 0 -7.34e+ 1 1.77e+ 0 0.378
3 RC2                     4  1.37e+ 0 -3.12e+ 1 4.96e- 1 0.150
4 RC3                     0 -4.95e-14 -4.95e-14 3.46e-14 0    </code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="8-Note.html#cb133-1"></a><span class="co">## 表2.3B</span></span>
<span id="cb133-2"><a href="8-Note.html#cb133-2"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">518</span>,  <span class="dv">95</span>, <span class="dv">6</span>, <span class="dv">35</span>, <span class="dv">5</span>,</span>
<span id="cb133-3"><a href="8-Note.html#cb133-3"></a>         　 <span class="dv">81</span>,  <span class="dv">67</span>, <span class="dv">4</span>, <span class="dv">49</span>, <span class="dv">2</span>,</span>
<span id="cb133-4"><a href="8-Note.html#cb133-4"></a>          <span class="dv">452</span>,<span class="dv">1003</span>,<span class="dv">67</span>,<span class="dv">630</span>, <span class="dv">5</span>,</span>
<span id="cb133-5"><a href="8-Note.html#cb133-5"></a>           <span class="dv">71</span>, <span class="dv">157</span>,<span class="dv">37</span>,<span class="dv">562</span>,<span class="dv">12</span>)</span>
<span id="cb133-6"><a href="8-Note.html#cb133-6"></a></span>
<span id="cb133-7"><a href="8-Note.html#cb133-7"></a><span class="co"># データを表形式に変換</span></span>
<span id="cb133-8"><a href="8-Note.html#cb133-8"></a>tab_<span class="fl">2.3</span>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(Freq, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">5</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.table</span>()</span>
<span id="cb133-9"><a href="8-Note.html#cb133-9"></a></span>
<span id="cb133-10"><a href="8-Note.html#cb133-10"></a>tab_<span class="fl">2.3</span>B</span></code></pre></div>
<pre><code>     A    B    C    D    E
A  518   95    6   35    5
B   81   67    4   49    2
C  452 1003   67  630    5
D   71  157   37  562   12</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="8-Note.html#cb135-1"></a><span class="co"># 度数，行変数，列変数からなる集計データを作成</span></span>
<span id="cb135-2"><a href="8-Note.html#cb135-2"></a>Educ &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">k =</span> <span class="dv">5</span>)</span>
<span id="cb135-3"><a href="8-Note.html#cb135-3"></a>Occ &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">20</span>)</span>
<span id="cb135-4"><a href="8-Note.html#cb135-4"></a>freq_tab_<span class="fl">2.3</span>B &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, Educ, Occ)</span>
<span id="cb135-5"><a href="8-Note.html#cb135-5"></a>freq_tab_<span class="fl">2.3</span>B</span></code></pre></div>
<pre><code># A tibble: 20 x 3
    Freq Educ  Occ  
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
 1   518 1     1    
 2    95 1     2    
 3     6 1     3    
 4    35 1     4    
 5     5 1     5    
 6    81 2     1    
 7    67 2     2    
 8     4 2     3    
 9    49 2     4    
10     2 2     5    
11   452 3     1    
12  1003 3     2    
13    67 3     3    
14   630 3     4    
15     5 3     5    
16    71 4     1    
17   157 4     2    
18    37 4     3    
19   562 4     4    
20    12 4     5    </code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="8-Note.html#cb137-1"></a>O &lt;-<span class="st"> </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ, </span>
<span id="cb137-2"><a href="8-Note.html#cb137-2"></a>         <span class="dt">family =</span> poisson, </span>
<span id="cb137-3"><a href="8-Note.html#cb137-3"></a>         <span class="dt">data =</span> freq_tab_<span class="fl">2.3</span>B, </span>
<span id="cb137-4"><a href="8-Note.html#cb137-4"></a>         <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb137-5"><a href="8-Note.html#cb137-5"></a></span>
<span id="cb137-6"><a href="8-Note.html#cb137-6"></a>mult1 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(O, Educ, Occ)</span>
<span id="cb137-7"><a href="8-Note.html#cb137-7"></a>mult2 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(O, Educ, Occ, <span class="dt">d =</span> <span class="dv">2</span>)</span>
<span id="cb137-8"><a href="8-Note.html#cb137-8"></a>mult3 &lt;-<span class="st"> </span><span class="kw">residSVD</span>(O, Educ, Occ, <span class="dt">d =</span> <span class="dv">3</span>)</span>
<span id="cb137-9"><a href="8-Note.html#cb137-9"></a></span>
<span id="cb137-10"><a href="8-Note.html#cb137-10"></a>RC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb137-11"><a href="8-Note.html#cb137-11"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb137-12"><a href="8-Note.html#cb137-12"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb137-13"><a href="8-Note.html#cb137-13"></a>      <span class="dt">data =</span> ., </span>
<span id="cb137-14"><a href="8-Note.html#cb137-14"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
..........................
Done</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="8-Note.html#cb139-1"></a><span class="kw">var_num</span>(RC)</span></code></pre></div>
<pre><code>                     var    estimate number
1            (Intercept)  4.76503358      1
2                  Educ2 -0.68164681      2
3                  Educ3  1.64246972      3
4                  Educ4  0.13768751      4
5                   Occ2  0.34674672      5
6                   Occ3 -2.28429801      6
7                   Occ4 -0.09546368      7
8                   Occ5 -3.75380084      8
9    Mult(., Educ, Occ). 18.82218461      9
10 Mult(1, ., Occ).Educ1 -0.34623878     10
11 Mult(1, ., Occ).Educ2 -0.05285906     11
12 Mult(1, ., Occ).Educ3  0.04236505     12
13 Mult(1, ., Occ).Educ4  0.28940981     13
14 Mult(1, Educ, .).Occ1 -0.22244604     14
15 Mult(1, Educ, .).Occ2  0.03134662     15
16 Mult(1, Educ, .).Occ3  0.16815066     16
17 Mult(1, Educ, .).Occ4  0.27002766     17
18 Mult(1, Educ, .).Occ5  0.11463716     18</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="8-Note.html#cb141-1"></a>RC &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb141-2"><a href="8-Note.html#cb141-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb141-3"><a href="8-Note.html#cb141-3"></a>      <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(O), <span class="dv">10</span>, mult1),</span>
<span id="cb141-4"><a href="8-Note.html#cb141-4"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb141-5"><a href="8-Note.html#cb141-5"></a>      <span class="dt">data =</span> ., </span>
<span id="cb141-6"><a href="8-Note.html#cb141-6"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Running main iterations.........................................................
........................
Done</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="8-Note.html#cb143-1"></a>RC2 &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb143-2"><a href="8-Note.html#cb143-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">instances</span>(<span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),<span class="dv">2</span>),</span>
<span id="cb143-3"><a href="8-Note.html#cb143-3"></a><span class="co">#      start = c(coef(O), NA, mult2[,1], NA, mult2[,2]),</span></span>
<span id="cb143-4"><a href="8-Note.html#cb143-4"></a>      <span class="dt">family =</span> poisson, <span class="dt">data =</span> ., <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.....................
Done</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="8-Note.html#cb145-1"></a>RC2</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Educ + Occ + instances(Mult(1, Educ, Occ), 
    2), family = poisson, data = ., tolerance = 1e-12)

Coefficients:
                    (Intercept)                            Educ2  
                        5.11536                         -0.88530  
                          Educ3                            Educ4  
                        1.06546                          0.36718  
                           Occ2                             Occ3  
                        0.43389                         -2.18454  
                           Occ4                             Occ5  
                        0.05375                         -4.23877  
  Mult(., Educ, Occ, inst = 1).  Mult(1, ., Occ, inst = 1).Educ1  
                        0.36440                          1.25958  
Mult(1, ., Occ, inst = 1).Educ2  Mult(1, ., Occ, inst = 1).Educ3  
                        0.28784                         -0.14745  
Mult(1, ., Occ, inst = 1).Educ4  Mult(1, Educ, ., inst = 1).Occ1  
                       -0.76792                          3.44652  
Mult(1, Educ, ., inst = 1).Occ2  Mult(1, Educ, ., inst = 1).Occ3  
                        0.53508                         -1.86858  
Mult(1, Educ, ., inst = 1).Occ4  Mult(1, Educ, ., inst = 1).Occ5  
                       -3.16434                         -1.49044  
  Mult(., Educ, Occ, inst = 2).  Mult(1, ., Occ, inst = 2).Educ1  
                        6.38268                         -0.57336  
Mult(1, ., Occ, inst = 2).Educ2  Mult(1, ., Occ, inst = 2).Educ3  
                       -0.24610                          0.15077  
Mult(1, ., Occ, inst = 2).Educ4  Mult(1, Educ, ., inst = 2).Occ1  
                       -0.32875                          0.12232  
Mult(1, Educ, ., inst = 2).Occ2  Mult(1, Educ, ., inst = 2).Occ3  
                        0.33791                          0.10398  
Mult(1, Educ, ., inst = 2).Occ4  Mult(1, Educ, ., inst = 2).Occ5  
                        0.04296                         -0.39632  

Deviance:            0.6001022 
Pearson chi-squared: 0.5746549 
Residual df:         2 </code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="8-Note.html#cb147-1"></a>RC3 &lt;-<span class="st"> </span>freq_tab_<span class="fl">2.3</span>B <span class="op">%&gt;%</span></span>
<span id="cb147-2"><a href="8-Note.html#cb147-2"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>Educ <span class="op">+</span><span class="st"> </span>Occ <span class="op">+</span><span class="st"> </span><span class="kw">instances</span>(<span class="kw">Mult</span>(<span class="dv">1</span>, Educ, Occ),<span class="dv">3</span>),</span>
<span id="cb147-3"><a href="8-Note.html#cb147-3"></a>      <span class="dt">start =</span> <span class="kw">c</span>(<span class="kw">coef</span>(O), <span class="ot">NA</span>, mult3[,<span class="dv">1</span>], <span class="ot">NA</span>, mult3[,<span class="dv">2</span>], <span class="ot">NA</span>, mult3[,<span class="dv">3</span>]),</span>
<span id="cb147-4"><a href="8-Note.html#cb147-4"></a>      <span class="dt">family =</span> poisson, <span class="dt">data =</span> ., <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................................................................
................................................................................
................................................................................
.......................
Done</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="8-Note.html#cb149-1"></a>RC3</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Educ + Occ + instances(Mult(1, Educ, Occ), 
    3), family = poisson, data = ., start = c(coef(O), NA, mult3[, 
    1], NA, mult3[, 2], NA, mult3[, 3]), tolerance = 1e-12)

Coefficients:
                    (Intercept)                            Educ2  
                        4.72065                         -0.74046  
                          Educ3                            Educ4  
                        1.60128                          0.42168  
                           Occ2                             Occ3  
                        0.25351                         -2.14991  
                           Occ4                             Occ5  
                        0.11685                         -3.83169  
  Mult(., Educ, Occ, inst = 1).  Mult(1, ., Occ, inst = 1).Educ1  
                        0.92790                          1.33651  
Mult(1, ., Occ, inst = 1).Educ2  Mult(1, ., Occ, inst = 1).Educ3  
                        0.30299                         -0.07169  
Mult(1, ., Occ, inst = 1).Educ4  Mult(1, Educ, ., inst = 1).Occ1  
                       -0.99183                          1.16507  
Mult(1, Educ, ., inst = 1).Occ2  Mult(1, Educ, ., inst = 1).Occ3  
                       -0.17506                         -0.62728  
Mult(1, Educ, ., inst = 1).Occ4  Mult(1, Educ, ., inst = 1).Occ5  
                       -1.06835                          0.12796  
  Mult(., Educ, Occ, inst = 2).  Mult(1, ., Occ, inst = 2).Educ1  
                        0.79641                          0.40428  
Mult(1, ., Occ, inst = 2).Educ2  Mult(1, ., Occ, inst = 2).Educ3  
                        0.49536                         -0.62252  
Mult(1, ., Occ, inst = 2).Educ4  Mult(1, Educ, ., inst = 2).Occ1  
                        0.90861                          0.26162  
Mult(1, Educ, ., inst = 2).Occ2  Mult(1, Educ, ., inst = 2).Occ3  
                       -0.61924                         -0.01499  
Mult(1, Educ, ., inst = 2).Occ4  Mult(1, Educ, ., inst = 2).Occ5  
                        0.13468                          1.73698  
  Mult(., Educ, Occ, inst = 3).  Mult(1, ., Occ, inst = 3).Educ1  
                        0.36888                         -0.01437  
Mult(1, ., Occ, inst = 3).Educ2  Mult(1, ., Occ, inst = 3).Educ3  
                        0.99766                          0.06283  
Mult(1, ., Occ, inst = 3).Educ4  Mult(1, Educ, ., inst = 3).Occ1  
                       -0.19840                         -0.04484  
Mult(1, Educ, ., inst = 3).Occ2  Mult(1, Educ, ., inst = 3).Occ3  
                        0.71874                         -0.71115  
Mult(1, Educ, ., inst = 3).Occ4  Mult(1, Educ, ., inst = 3).Occ5  
                        0.11415                         -0.47982  

Deviance:            -2.611245e-13 
Pearson chi-squared: 2.300609e-24 
Residual df:         0 </code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="8-Note.html#cb151-1"></a><span class="kw">bind_rows</span>(</span>
<span id="cb151-2"><a href="8-Note.html#cb151-2"></a><span class="kw">model.summary</span>(O),<span class="kw">model.summary</span>(RC),<span class="kw">model.summary</span>(RC2),<span class="kw">model.summary</span>(RC3)</span>
<span id="cb151-3"><a href="8-Note.html#cb151-3"></a>)</span></code></pre></div>
<pre><code># A tibble: 4 x 6
  `Model Description`    df        L2       BIC    Delta     p
  &lt;chr&gt;               &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 O                      12  1.37e+ 3  1.27e+ 3 2.39e+ 1 1    
2 RC                      6  1.25e+ 2  7.55e+ 1 6.44e+ 0 1    
3 RC2                     2  6.00e- 1 -1.59e+ 1 9.35e- 2 0.259
4 RC3                     0 -2.61e-13 -2.61e-13 1.63e-13 0    </code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="8-Note.html#cb153-1"></a>anoas_model &lt;-<span class="st"> </span><span class="kw">anoas</span>(tab_<span class="fl">2.3</span>B, <span class="dt">nd =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>Fitting independence model...
Fitting model with 1 dimension...
Initialising
Running start-up iterations..
Running main iterations.........................................................
....
Done
Fitting model with 2 dimensions...
Initialising
Running start-up iterations..
Running main iterations........
Done
Fitting model with 3 dimensions...
Initialising
Running start-up iterations..
Running main iterations.......
Done</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="8-Note.html#cb155-1"></a>anoas_model</span></code></pre></div>
<pre><code>       Res. Df            Res. Dev     Dev./Indep. (%)       Dissim. (%)
Indep.      12 1373.17576565224499 100.000000000000000 23.86157529528986
RC(1)        6  125.05974855014647   9.107337289101102  6.43603909819582
RC(2)        2    0.60010223526830   0.043701778772891  0.09351658015798
RC(3)        0    0.00000000000003   0.000000000000002  0.00000000000003
                       BIC                 AIC    Dev. Df
Indep. 1274.08091533065681 1349.17576565224499      NA NA
RC(1)    75.51232338935242  113.05974855014647 -1248.1 -6
RC(2)   -15.91570615166305   -3.39989776473170  -124.5 -4
RC(3)     0.00000000000003    0.00000000000003    -0.6 -2</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7-Chapter_6.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Association_Models.pdf", "Association_Models.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
