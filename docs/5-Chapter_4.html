<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 第4章 | 『カテゴリカルデータの連関モデル』サポートページ</title>
  <meta name="description" content="5 第4章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="5 第4章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 第4章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  
  
  

<meta name="author" content="藤原翔（Sho Fujihara）" />


<meta name="date" content="2022-04-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="4-Chapter_3.html"/>
<link rel="next" href="6-Chapter_5.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> bookdown::gitbook: default<span></span></a>
<ul>
<li><a href="index.html#目的">目的<span></span></a></li>
<li><a href="index.html#rのスクリプト">Rのスクリプト<span></span></a></li>
<li><a href="index.html#サポートページバージョン情報">サポートページバージョン情報<span></span></a></li>
</ul></li>
<li><a href="1-Introduction.html#はじめに">はじめに<span></span></a>
<ul>
<li><a href="1-Introduction.html#独立性の検定">独立性の検定<span></span></a></li>
<li><a href="1-Introduction.html#一様連関モデル">一様連関モデル<span></span></a></li>
<li><a href="1-Introduction.html#度数行変数列変数のデータからクロス表を作成">度数，行変数，列変数のデータからクロス表を作成<span></span></a></li>
<li class="chapter" data-level="1.1" data-path="1-Introduction.html"><a href="1-Introduction.html"><i class="fa fa-check"></i><b>1.1</b> 個票データから集計データを作成<span></span></a></li>
<li><a href="1-Introduction.html#練習問題">練習問題<span></span></a></li>
<li><a href="1-Introduction.html#参考文献">参考文献<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-Chapter_1.html"><a href="2-Chapter_1.html"><i class="fa fa-check"></i><b>2</b> 第1章<span></span></a></li>
<li class="chapter" data-level="3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html"><i class="fa fa-check"></i><b>3</b> 第2章<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#対比について"><i class="fa fa-check"></i><b>3.1</b> 対比について<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.1-p.8"><i class="fa fa-check"></i><b>3.2</b> 表2.1 (p.8)<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.3-p.32"><i class="fa fa-check"></i><b>3.3</b> 表2.3 (p.32)<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4a"><i class="fa fa-check"></i><b>3.4</b> 表2.4A<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4b"><i class="fa fa-check"></i><b>3.5</b> 表2.4B<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.5a"><i class="fa fa-check"></i><b>3.6</b> 表2.5A<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#logmultパッケージの利用"><i class="fa fa-check"></i><b>3.7</b> logmultパッケージの利用<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6a"><i class="fa fa-check"></i><b>3.8</b> 表2.6A<span></span></a></li>
<li class="chapter" data-level="3.9" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6b"><i class="fa fa-check"></i><b>3.9</b> 表2.6B<span></span></a></li>
<li class="chapter" data-level="3.10" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6c"><i class="fa fa-check"></i><b>3.10</b> 表2.6C<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html"><i class="fa fa-check"></i><b>4</b> 第3章<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1a"><i class="fa fa-check"></i><b>4.1</b> 表3.1A<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1b"><i class="fa fa-check"></i><b>4.2</b> 表3.1B<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-Chapter_4.html"><a href="5-Chapter_4.html"><i class="fa fa-check"></i><b>5</b> 第4章<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="5-Chapter_4.html"><a href="5-Chapter_4.html#表4.3"><i class="fa fa-check"></i><b>5.1</b> 表4.3<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="5-Chapter_4.html"><a href="5-Chapter_4.html#表4.6"><i class="fa fa-check"></i><b>5.2</b> 表4.6<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html"><i class="fa fa-check"></i><b>6</b> 第5章<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html#表5.1"><i class="fa fa-check"></i><b>6.1</b> 表5.1<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html#表5.4"><i class="fa fa-check"></i><b>6.2</b> 表5.4<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-Chapter_6.html"><a href="7-Chapter_6.html"><i class="fa fa-check"></i><b>7</b> 第6章<span></span></a></li>
<li><a href="8-Note.html#補足のノート">補足のノート<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="8-Note.html"><a href="8-Note.html"><i class="fa fa-check"></i><b>7.1</b> パッケージ<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="8-Note.html"><a href="8-Note.html#クロス表の作成"><i class="fa fa-check"></i><b>7.2</b> クロス表の作成<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="8-Note.html"><a href="8-Note.html#集計データの作成"><i class="fa fa-check"></i><b>7.3</b> 集計データの作成<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="8-Note.html"><a href="8-Note.html#glmとgnmの結果の比較"><i class="fa fa-check"></i><b>7.4</b> GLMとGNMの結果の比較<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="8-Note.html"><a href="8-Note.html#期待度数"><i class="fa fa-check"></i><b>7.5</b> 期待度数<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="8-Note.html"><a href="8-Note.html#モザイクプロット"><i class="fa fa-check"></i><b>7.6</b> モザイクプロット<span></span></a></li>
<li class="chapter" data-level="7.7" data-path="8-Note.html"><a href="8-Note.html#正規化"><i class="fa fa-check"></i><b>7.7</b> 正規化<span></span></a></li>
<li class="chapter" data-level="7.8" data-path="8-Note.html"><a href="8-Note.html#初期値"><i class="fa fa-check"></i><b>7.8</b> 初期値<span></span></a></li>
<li class="chapter" data-level="7.9" data-path="8-Note.html"><a href="8-Note.html#位相モデル"><i class="fa fa-check"></i><b>7.9</b> 位相モデル<span></span></a></li>
<li class="chapter" data-level="7.10" data-path="8-Note.html"><a href="8-Note.html#xie"><i class="fa fa-check"></i><b>7.10</b> Xie<span></span></a></li>
</ul></li>
<li><a href="9-R.html#rのインストールと基本的な操作方法">Rのインストールと基本的な操作方法<span></span></a></li>
<li class="divider"></li>
<li></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第4章" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> 第4章<a href="5-Chapter_4.html#第4章" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<pre><code>## [1] 1000</code></pre>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="5-Chapter_4.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="5-Chapter_4.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb2-3"><a href="5-Chapter_4.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnm)</span></code></pre></div>
<div id="表4.3" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> 表4.3<a href="5-Chapter_4.html#表4.3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="5-Chapter_4.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function which calculation BIC based on L2 statistics</span></span>
<span id="cb3-2"><a href="5-Chapter_4.html#cb3-2" aria-hidden="true" tabindex="-1"></a>model.summary <span class="ot">&lt;-</span> <span class="cf">function</span>(obj) {</span>
<span id="cb3-3"><a href="5-Chapter_4.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="dv">2</span>   <span class="co"># AIC(L2)</span></span>
<span id="cb3-4"><a href="5-Chapter_4.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sum</span>(obj<span class="sc">$</span>y))   <span class="co">#BIC(L2)</span></span>
<span id="cb3-5"><a href="5-Chapter_4.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Index of Dissimilarity (%)</span></span>
<span id="cb3-6"><a href="5-Chapter_4.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">abs</span>(obj<span class="sc">$</span>y <span class="sc">-</span> obj<span class="sc">$</span>fitted.values)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(obj<span class="sc">$</span>y))</span>
<span id="cb3-7"><a href="5-Chapter_4.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(obj<span class="sc">$</span>deviance, obj<span class="sc">$</span>df, <span class="at">lower.tail =</span> F)</span>
<span id="cb3-8"><a href="5-Chapter_4.html#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#p&lt;-ifelse(p&lt;0.001,&quot;&lt;0.001&quot;,p)</span></span>
<span id="cb3-9"><a href="5-Chapter_4.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb3-10"><a href="5-Chapter_4.html#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb3-11"><a href="5-Chapter_4.html#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Df&quot;</span>, <span class="st">&quot;L2&quot;</span>, <span class="st">&quot;p&quot;</span>, <span class="st">&quot;AIC(L2)&quot;</span>, <span class="st">&quot;BIC(L2)&quot;</span>, <span class="st">&quot;Delta&quot;</span>)</span>
<span id="cb3-12"><a href="5-Chapter_4.html#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#exp.freq=obj$fitted.values</span></span>
<span id="cb3-13"><a href="5-Chapter_4.html#cb3-13" aria-hidden="true" tabindex="-1"></a>  result[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(obj<span class="sc">$</span>df, obj<span class="sc">$</span>deviance, p, aic, bic, delta)</span>
<span id="cb3-14"><a href="5-Chapter_4.html#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Model Summary:&quot;</span>)</span>
<span id="cb3-15"><a href="5-Chapter_4.html#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb3-16"><a href="5-Chapter_4.html#cb3-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-17"><a href="5-Chapter_4.html#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="5-Chapter_4.html#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 4.3</span></span>
<span id="cb3-19"><a href="5-Chapter_4.html#cb3-19" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">201</span>,  <span class="dv">29</span>,   <span class="dv">8</span>,  <span class="dv">13</span>,   <span class="dv">5</span>,     <span class="dv">152</span>,  <span class="dv">29</span>,   <span class="dv">2</span>,   <span class="dv">8</span>,   <span class="dv">0</span>,</span>
<span id="cb3-20"><a href="5-Chapter_4.html#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="dv">18</span>,   <span class="dv">6</span>,   <span class="dv">3</span>,   <span class="dv">6</span>,   <span class="dv">0</span>,      <span class="dv">17</span>,  <span class="dv">12</span>,   <span class="dv">0</span>,   <span class="dv">3</span>,   <span class="dv">0</span>,</span>
<span id="cb3-21"><a href="5-Chapter_4.html#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="dv">109</span>,  <span class="dv">74</span>, <span class="dv">164</span>,  <span class="dv">89</span>,  <span class="dv">16</span>,     <span class="dv">101</span>, <span class="dv">336</span>,   <span class="dv">9</span>, <span class="dv">134</span>,   <span class="dv">2</span>,</span>
<span id="cb3-22"><a href="5-Chapter_4.html#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="dv">7</span>,   <span class="dv">6</span>,  <span class="dv">45</span>,  <span class="dv">30</span>,   <span class="dv">6</span>,       <span class="dv">7</span>,  <span class="dv">41</span>,   <span class="dv">7</span>,  <span class="dv">63</span>,   <span class="dv">0</span>,</span>
<span id="cb3-23"><a href="5-Chapter_4.html#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="dv">247</span>,  <span class="dv">58</span>,  <span class="dv">20</span>,  <span class="dv">23</span>,   <span class="dv">2</span>,     <span class="dv">288</span>,  <span class="dv">51</span>,   <span class="dv">1</span>,  <span class="dv">17</span>,   <span class="dv">3</span>,</span>
<span id="cb3-24"><a href="5-Chapter_4.html#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="dv">48</span>,  <span class="dv">11</span>,  <span class="dv">16</span>,  <span class="dv">13</span>,   <span class="dv">1</span>,      <span class="dv">47</span>,  <span class="dv">38</span>,   <span class="dv">2</span>,  <span class="dv">18</span>,   <span class="dv">0</span>,</span>
<span id="cb3-25"><a href="5-Chapter_4.html#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="dv">157</span>,  <span class="dv">68</span>, <span class="dv">178</span>, <span class="dv">116</span>,  <span class="dv">27</span>,     <span class="dv">165</span>, <span class="dv">321</span>,  <span class="dv">27</span>, <span class="dv">168</span>,   <span class="dv">1</span>,</span>
<span id="cb3-26"><a href="5-Chapter_4.html#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="dv">7</span>,   <span class="dv">7</span>,  <span class="dv">50</span>,  <span class="dv">42</span>,   <span class="dv">5</span>,      <span class="dv">12</span>,  <span class="dv">25</span>,   <span class="dv">5</span>,  <span class="dv">29</span>,   <span class="dv">6</span>)</span>
<span id="cb3-27"><a href="5-Chapter_4.html#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="5-Chapter_4.html#cb3-28" aria-hidden="true" tabindex="-1"></a>Educ <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb3-29"><a href="5-Chapter_4.html#cb3-29" aria-hidden="true" tabindex="-1"></a>Occ <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb3-30"><a href="5-Chapter_4.html#cb3-30" aria-hidden="true" tabindex="-1"></a>Sex <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb3-31"><a href="5-Chapter_4.html#cb3-31" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">40</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb3-32"><a href="5-Chapter_4.html#cb3-32" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> Year<span class="sc">:</span>Sex</span>
<span id="cb3-33"><a href="5-Chapter_4.html#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(L) <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb3-34"><a href="5-Chapter_4.html#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="5-Chapter_4.html#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="5-Chapter_4.html#cb3-36" aria-hidden="true" tabindex="-1"></a>Rscore <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Educ)</span>
<span id="cb3-37"><a href="5-Chapter_4.html#cb3-37" aria-hidden="true" tabindex="-1"></a>Cscore <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Occ)</span>
<span id="cb3-38"><a href="5-Chapter_4.html#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="5-Chapter_4.html#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="5-Chapter_4.html#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="5-Chapter_4.html#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - RC(0)-L(homogeneous)</span></span>
<span id="cb3-42"><a href="5-Chapter_4.html#cb3-42" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span></span>
<span id="cb3-43"><a href="5-Chapter_4.html#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb3-44"><a href="5-Chapter_4.html#cb3-44" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L,</span>
<span id="cb3-45"><a href="5-Chapter_4.html#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb3-46"><a href="5-Chapter_4.html#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb3-47"><a href="5-Chapter_4.html#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb3-48"><a href="5-Chapter_4.html#cb3-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-49"><a href="5-Chapter_4.html#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>FALSE 
FALSE Call:
FALSE gnm(formula = Freq ~ Educ + Occ + L + Educ:L + Occ:L, family = poisson, 
FALSE     tolerance = 1e-12, trace = F)
FALSE 
FALSE Deviance Residuals: 
FALSE     Min       1Q   Median       3Q      Max  
FALSE -9.2080  -2.2181  -0.4393   1.7534  10.3493  
FALSE 
FALSE Coefficients:
FALSE             Estimate Std. Error z value Pr(&gt;|z|)    
FALSE (Intercept)  4.63188    0.07546  61.385  &lt; 2e-16 ***
FALSE Educ2       -2.04867    0.18496 -11.076  &lt; 2e-16 ***
FALSE Educ3        0.56850    0.07822   7.268 3.65e-13 ***
FALSE Educ4       -1.00188    0.12060  -8.307  &lt; 2e-16 ***
FALSE Occ2        -1.06920    0.10808  -9.893  &lt; 2e-16 ***
FALSE Occ3        -0.42050    0.08678  -4.846 1.26e-06 ***
FALSE Occ4        -0.88688    0.10115  -8.768  &lt; 2e-16 ***
FALSE Occ5        -2.51829    0.20006 -12.588  &lt; 2e-16 ***
FALSE L2          -0.58321    0.11600  -5.028 4.96e-07 ***
FALSE L3           0.35568    0.09908   3.590 0.000331 ***
FALSE L4           0.38267    0.09802   3.904 9.46e-05 ***
FALSE Educ2:L2     0.26213    0.26589   0.986 0.324189    
FALSE Educ3:L2     0.54569    0.11433   4.773 1.82e-06 ***
FALSE Educ4:L2     0.52029    0.16809   3.095 0.001966 ** 
FALSE Educ2:L3     0.67937    0.21978   3.091 0.001994 ** 
FALSE Educ3:L3    -0.12382    0.10396  -1.191 0.233635    
FALSE Educ4:L3    -0.14652    0.16251  -0.902 0.367276    
FALSE Educ2:L4     0.81653    0.21566   3.786 0.000153 ***
FALSE Educ3:L4     0.07042    0.10180   0.692 0.489078    
FALSE Educ4:L4    -0.54042    0.17410  -3.104 0.001908 ** 
FALSE Occ2:L2      1.48066    0.13298  11.135  &lt; 2e-16 ***
FALSE Occ3:L2     -2.31314    0.25826  -8.957  &lt; 2e-16 ***
FALSE Occ4:L2      0.60040    0.13656   4.397 1.10e-05 ***
FALSE Occ5:L2     -2.41258    0.73731  -3.272 0.001067 ** 
FALSE Occ2:L3     -0.09004    0.14424  -0.624 0.532465    
FALSE Occ3:L3     -0.13260    0.11618  -1.141 0.253725    
FALSE Occ4:L3      0.02568    0.13253   0.194 0.846332    
FALSE Occ5:L3     -0.05541    0.26603  -0.208 0.835011    
FALSE Occ2:L4      0.90622    0.12622   7.179 7.00e-13 ***
FALSE Occ3:L4     -2.26247    0.19508 -11.598  &lt; 2e-16 ***
FALSE Occ4:L4      0.09529    0.12843   0.742 0.458122    
FALSE Occ5:L4     -1.41745    0.37680  -3.762 0.000169 ***
FALSE ---
FALSE Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
FALSE 
FALSE (Dispersion parameter for poisson family taken to be 1)
FALSE 
FALSE Residual deviance: 1370.9 on 48 degrees of freedom
FALSE AIC: 1796.7
FALSE 
FALSE Number of iterations: 6</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="5-Chapter_4.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model1)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2             p  AIC(L2)  BIC(L2)    Delta
FALSE  48 1370.934 1.366344e-255 1274.934 971.8922 23.75048</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="5-Chapter_4.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - RC(1)-L(homogeneous)</span></span>
<span id="cb8-2"><a href="5-Chapter_4.html#cb8-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">gnm</span>(</span>
<span id="cb8-3"><a href="5-Chapter_4.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ)</span>
<span id="cb8-4"><a href="5-Chapter_4.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb8-5"><a href="5-Chapter_4.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb8-6"><a href="5-Chapter_4.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> F,</span>
<span id="cb8-7"><a href="5-Chapter_4.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb8-8"><a href="5-Chapter_4.html#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations..
FALSE Running main iterations..........................................
FALSE Done</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="5-Chapter_4.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model2)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2            p  AIC(L2)   BIC(L2)    Delta
FALSE  42 143.8274 4.537907e-13 59.82743 -205.3338 6.388286</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="5-Chapter_4.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - RC(1)-L(heterogeneous)</span></span>
<span id="cb13-2"><a href="5-Chapter_4.html#cb13-2" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">gnm</span>(</span>
<span id="cb13-3"><a href="5-Chapter_4.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(L, L<span class="sc">:</span>Educ, L<span class="sc">:</span>Occ)</span>
<span id="cb13-4"><a href="5-Chapter_4.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb13-5"><a href="5-Chapter_4.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb13-6"><a href="5-Chapter_4.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> F,</span>
<span id="cb13-7"><a href="5-Chapter_4.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb13-8"><a href="5-Chapter_4.html#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations..
FALSE Running main iterations.........................................................
FALSE .........................................
FALSE Done</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="5-Chapter_4.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model3)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2           p  AIC(L2)   BIC(L2)    Delta
FALSE  24 69.06197 3.02988e-06 21.06197 -130.4587 3.038593</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="5-Chapter_4.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - RC(2)-L(homogeneous)</span></span>
<span id="cb18-2"><a href="5-Chapter_4.html#cb18-2" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span></span>
<span id="cb18-3"><a href="5-Chapter_4.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb18-4"><a href="5-Chapter_4.html#cb18-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">instances</span>(<span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ), <span class="dv">2</span>)</span>
<span id="cb18-5"><a href="5-Chapter_4.html#cb18-5" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb18-6"><a href="5-Chapter_4.html#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb18-7"><a href="5-Chapter_4.html#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb18-8"><a href="5-Chapter_4.html#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-8</span></span>
<span id="cb18-9"><a href="5-Chapter_4.html#cb18-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations..
FALSE Running main iterations..................
FALSE Done</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="5-Chapter_4.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model4)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2            p  AIC(L2)  BIC(L2)    Delta
FALSE  38 117.3838 4.933675e-10 41.38378 -198.524 5.236715</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="5-Chapter_4.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - RC(2)-L(heterogeneous)</span></span>
<span id="cb23-2"><a href="5-Chapter_4.html#cb23-2" aria-hidden="true" tabindex="-1"></a>model5 <span class="ot">&lt;-</span></span>
<span id="cb23-3"><a href="5-Chapter_4.html#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb23-4"><a href="5-Chapter_4.html#cb23-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">instances</span>(<span class="fu">Mult</span>(L, L<span class="sc">:</span>Educ, L<span class="sc">:</span>Occ), <span class="dv">2</span>),</span>
<span id="cb23-5"><a href="5-Chapter_4.html#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb23-6"><a href="5-Chapter_4.html#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb23-7"><a href="5-Chapter_4.html#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-10</span>,</span>
<span id="cb23-8"><a href="5-Chapter_4.html#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterStart =</span> <span class="dv">5</span>,</span>
<span id="cb23-9"><a href="5-Chapter_4.html#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterMax =</span> <span class="dv">1000000</span>,</span>
<span id="cb23-10"><a href="5-Chapter_4.html#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> F</span>
<span id="cb23-11"><a href="5-Chapter_4.html#cb23-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-12"><a href="5-Chapter_4.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model5)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)   BIC(L2)    Delta
FALSE   8 5.833864 0.6658353 -10.16614 -60.67303 0.436722</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="5-Chapter_4.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 - RC(3)-L(homogeneous)</span></span>
<span id="cb26-2"><a href="5-Chapter_4.html#cb26-2" aria-hidden="true" tabindex="-1"></a>model6 <span class="ot">&lt;-</span></span>
<span id="cb26-3"><a href="5-Chapter_4.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb26-4"><a href="5-Chapter_4.html#cb26-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">instances</span>(<span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ), <span class="dv">3</span>)</span>
<span id="cb26-5"><a href="5-Chapter_4.html#cb26-5" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb26-6"><a href="5-Chapter_4.html#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb26-7"><a href="5-Chapter_4.html#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb26-8"><a href="5-Chapter_4.html#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span></span>
<span id="cb26-9"><a href="5-Chapter_4.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations..
FALSE Running main iterations.....
FALSE Done</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="5-Chapter_4.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model6)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2           p  AIC(L2)   BIC(L2)    Delta
FALSE  36 113.1797 6.60068e-10 41.17975 -186.1013 5.186927</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="5-Chapter_4.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7 - RC(3)-L(heterogeneous)</span></span>
<span id="cb31-2"><a href="5-Chapter_4.html#cb31-2" aria-hidden="true" tabindex="-1"></a>model6 <span class="ot">&lt;-</span></span>
<span id="cb31-3"><a href="5-Chapter_4.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb31-4"><a href="5-Chapter_4.html#cb31-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">instances</span>(<span class="fu">Mult</span>(L, L<span class="sc">:</span>Educ, L<span class="sc">:</span>Occ), <span class="dv">3</span>),</span>
<span id="cb31-5"><a href="5-Chapter_4.html#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb31-6"><a href="5-Chapter_4.html#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb31-7"><a href="5-Chapter_4.html#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-8</span></span>
<span id="cb31-8"><a href="5-Chapter_4.html#cb31-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations..
FALSE Running main iterations.........................................................
FALSE ................................................................................
FALSE ................................................................................
FALSE ................................................................................
FALSE ................................................................................
FALSE ................................................................................
FALSE ...........................................
FALSE Done</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="5-Chapter_4.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model6)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df           L2 p      AIC(L2)      BIC(L2)        Delta
FALSE   0 3.466432e-11 0 3.466432e-11 3.466432e-11 6.221806e-09</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="5-Chapter_4.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 98- U+RC(homogeneous)</span></span>
<span id="cb36-2"><a href="5-Chapter_4.html#cb36-2" aria-hidden="true" tabindex="-1"></a>model8 <span class="ot">&lt;-</span></span>
<span id="cb36-3"><a href="5-Chapter_4.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb36-4"><a href="5-Chapter_4.html#cb36-4" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> Rscore<span class="sc">:</span>Cscore <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ),</span>
<span id="cb36-5"><a href="5-Chapter_4.html#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb36-6"><a href="5-Chapter_4.html#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb36-7"><a href="5-Chapter_4.html#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-6</span>,</span>
<span id="cb36-8"><a href="5-Chapter_4.html#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb36-9"><a href="5-Chapter_4.html#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterMax =</span> <span class="dv">100000</span></span>
<span id="cb36-10"><a href="5-Chapter_4.html#cb36-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations....................
FALSE Running main iterations..............
FALSE Done</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="5-Chapter_4.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model8)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2            p  AIC(L2)   BIC(L2)    Delta
FALSE  41 124.7511 2.182856e-10 42.75111 -216.0967 5.580511</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="5-Chapter_4.html#cb41-1" aria-hidden="true" tabindex="-1"></a>model8<span class="sc">$</span>deviance <span class="sc">-</span> model8<span class="sc">$</span>df <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">4078</span>)</span></code></pre></div>
<pre><code>FALSE [1] -216.0967</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="5-Chapter_4.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8 - U+RC(heterogeneous)</span></span>
<span id="cb43-2"><a href="5-Chapter_4.html#cb43-2" aria-hidden="true" tabindex="-1"></a>Rscore <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Educ)</span>
<span id="cb43-3"><a href="5-Chapter_4.html#cb43-3" aria-hidden="true" tabindex="-1"></a>Cscore <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Occ)</span>
<span id="cb43-4"><a href="5-Chapter_4.html#cb43-4" aria-hidden="true" tabindex="-1"></a>model9 <span class="ot">&lt;-</span></span>
<span id="cb43-5"><a href="5-Chapter_4.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(</span>
<span id="cb43-6"><a href="5-Chapter_4.html#cb43-6" aria-hidden="true" tabindex="-1"></a>    Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> Rscore<span class="sc">:</span>Cscore<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(L, L<span class="sc">:</span>Educ, L<span class="sc">:</span>Occ),</span>
<span id="cb43-7"><a href="5-Chapter_4.html#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb43-8"><a href="5-Chapter_4.html#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb43-9"><a href="5-Chapter_4.html#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-6</span>,</span>
<span id="cb43-10"><a href="5-Chapter_4.html#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb43-11"><a href="5-Chapter_4.html#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterMax =</span> <span class="dv">100000</span>,</span>
<span id="cb43-12"><a href="5-Chapter_4.html#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> F</span>
<span id="cb43-13"><a href="5-Chapter_4.html#cb43-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-14"><a href="5-Chapter_4.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model9)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)   BIC(L2)    Delta
FALSE  20 27.47202 0.1224988 -12.52798 -138.7952 1.496033</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="5-Chapter_4.html#cb46-1" aria-hidden="true" tabindex="-1"></a>model9<span class="sc">$</span>deviance <span class="sc">-</span> model9<span class="sc">$</span>df <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">4078</span>)</span></code></pre></div>
<pre><code>FALSE [1] -138.7952</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="5-Chapter_4.html#cb48-1" aria-hidden="true" tabindex="-1"></a>model9<span class="sc">$</span>deviance <span class="sc">-</span> <span class="dv">20</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">4078</span>)</span></code></pre></div>
<pre><code>FALSE [1] -138.7952</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="5-Chapter_4.html#cb50-1" aria-hidden="true" tabindex="-1"></a>model9<span class="sc">$</span>deviance <span class="sc">-</span> <span class="dv">22</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">4078</span>)</span></code></pre></div>
<pre><code>FALSE [1] -155.4219</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="5-Chapter_4.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fl">27.47</span>, <span class="dv">20</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>FALSE [1] 0.1225512</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="5-Chapter_4.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fl">27.47</span>, <span class="dv">22</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>FALSE [1] 0.1939168</code></pre>
</div>
<div id="表4.6" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> 表4.6<a href="5-Chapter_4.html#表4.6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="5-Chapter_4.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 4.6</span></span>
<span id="cb56-2"><a href="5-Chapter_4.html#cb56-2" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">201</span>, <span class="dv">29</span>, <span class="dv">8</span>,<span class="dv">13</span>, <span class="dv">5</span>, <span class="dv">152</span>,<span class="dv">29</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">0</span>,</span>
<span id="cb56-3"><a href="5-Chapter_4.html#cb56-3" aria-hidden="true" tabindex="-1"></a>          <span class="dv">18</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">0</span>,<span class="dv">17</span>,<span class="dv">12</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>,</span>
<span id="cb56-4"><a href="5-Chapter_4.html#cb56-4" aria-hidden="true" tabindex="-1"></a>          <span class="dv">109</span>,<span class="dv">74</span>, <span class="dv">164</span>,<span class="dv">89</span>,<span class="dv">16</span>, <span class="dv">101</span>, <span class="dv">336</span>, <span class="dv">9</span>, <span class="dv">134</span>, <span class="dv">2</span>,</span>
<span id="cb56-5"><a href="5-Chapter_4.html#cb56-5" aria-hidden="true" tabindex="-1"></a>          <span class="dv">7</span>, <span class="dv">6</span>,<span class="dv">45</span>,<span class="dv">30</span>, <span class="dv">6</span>, <span class="dv">7</span>,<span class="dv">41</span>, <span class="dv">7</span>,<span class="dv">63</span>, <span class="dv">0</span>,</span>
<span id="cb56-6"><a href="5-Chapter_4.html#cb56-6" aria-hidden="true" tabindex="-1"></a>          <span class="dv">247</span>,<span class="dv">58</span>,<span class="dv">20</span>,<span class="dv">23</span>, <span class="dv">2</span>, <span class="dv">288</span>,<span class="dv">51</span>, <span class="dv">1</span>,<span class="dv">17</span>, <span class="dv">3</span>,</span>
<span id="cb56-7"><a href="5-Chapter_4.html#cb56-7" aria-hidden="true" tabindex="-1"></a>          <span class="dv">48</span>,<span class="dv">11</span>,<span class="dv">16</span>,<span class="dv">13</span>, <span class="dv">1</span>,<span class="dv">47</span>,<span class="dv">38</span>, <span class="dv">2</span>,<span class="dv">18</span>, <span class="dv">0</span>,</span>
<span id="cb56-8"><a href="5-Chapter_4.html#cb56-8" aria-hidden="true" tabindex="-1"></a>          <span class="dv">157</span>,<span class="dv">68</span>, <span class="dv">178</span>, <span class="dv">116</span>,<span class="dv">27</span>, <span class="dv">165</span>, <span class="dv">321</span>,<span class="dv">27</span>, <span class="dv">168</span>, <span class="dv">1</span>,</span>
<span id="cb56-9"><a href="5-Chapter_4.html#cb56-9" aria-hidden="true" tabindex="-1"></a>          <span class="dv">7</span>, <span class="dv">7</span>,<span class="dv">50</span>,<span class="dv">42</span>, <span class="dv">5</span>,<span class="dv">12</span>,<span class="dv">25</span>, <span class="dv">5</span>,<span class="dv">29</span>, <span class="dv">6</span>)</span>
<span id="cb56-10"><a href="5-Chapter_4.html#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="5-Chapter_4.html#cb56-11" aria-hidden="true" tabindex="-1"></a>Educ <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb56-12"><a href="5-Chapter_4.html#cb56-12" aria-hidden="true" tabindex="-1"></a>Occ <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb56-13"><a href="5-Chapter_4.html#cb56-13" aria-hidden="true" tabindex="-1"></a>Sex <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb56-14"><a href="5-Chapter_4.html#cb56-14" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">40</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb56-15"><a href="5-Chapter_4.html#cb56-15" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> Year<span class="sc">:</span>Sex</span>
<span id="cb56-16"><a href="5-Chapter_4.html#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(L) <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb56-17"><a href="5-Chapter_4.html#cb56-17" aria-hidden="true" tabindex="-1"></a>Rscore <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Educ)</span>
<span id="cb56-18"><a href="5-Chapter_4.html#cb56-18" aria-hidden="true" tabindex="-1"></a>Cscore <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Occ)</span>
<span id="cb56-19"><a href="5-Chapter_4.html#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="5-Chapter_4.html#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1</span></span>
<span id="cb56-21"><a href="5-Chapter_4.html#cb56-21" aria-hidden="true" tabindex="-1"></a>model1.un <span class="ot">&lt;-</span> <span class="fu">gnm</span>(</span>
<span id="cb56-22"><a href="5-Chapter_4.html#cb56-22" aria-hidden="true" tabindex="-1"></a>  Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span></span>
<span id="cb56-23"><a href="5-Chapter_4.html#cb56-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Mult</span>(L, L<span class="sc">:</span>Educ, Occ, <span class="at">inst =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb56-24"><a href="5-Chapter_4.html#cb56-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Mult</span>(L, L<span class="sc">:</span>Educ, Occ, <span class="at">inst =</span> <span class="dv">2</span>),</span>
<span id="cb56-25"><a href="5-Chapter_4.html#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb56-26"><a href="5-Chapter_4.html#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> F,</span>
<span id="cb56-27"><a href="5-Chapter_4.html#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-8</span>,</span>
<span id="cb56-28"><a href="5-Chapter_4.html#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb56-29"><a href="5-Chapter_4.html#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterMax =</span> <span class="dv">100000</span>,</span>
<span id="cb56-30"><a href="5-Chapter_4.html#cb56-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> F)</span>
<span id="cb56-31"><a href="5-Chapter_4.html#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model1.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2          p   AIC(L2)   BIC(L2)    Delta
FALSE  20 29.24633 0.08302108 -10.75367 -137.0209 1.824495</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="5-Chapter_4.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2</span></span>
<span id="cb59-2"><a href="5-Chapter_4.html#cb59-2" aria-hidden="true" tabindex="-1"></a>model2.un <span class="ot">&lt;-</span> <span class="fu">gnm</span>(</span>
<span id="cb59-3"><a href="5-Chapter_4.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(L, Educ, L<span class="sc">:</span>Occ, <span class="at">inst =</span> <span class="dv">1</span>)</span>
<span id="cb59-4"><a href="5-Chapter_4.html#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">Mult</span>(L, Educ, L<span class="sc">:</span>Occ, <span class="at">inst =</span> <span class="dv">2</span>),</span>
<span id="cb59-5"><a href="5-Chapter_4.html#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb59-6"><a href="5-Chapter_4.html#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb59-7"><a href="5-Chapter_4.html#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-8</span>,</span>
<span id="cb59-8"><a href="5-Chapter_4.html#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb59-9"><a href="5-Chapter_4.html#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterMax =</span> <span class="dv">100000</span>,</span>
<span id="cb59-10"><a href="5-Chapter_4.html#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> F</span>
<span id="cb59-11"><a href="5-Chapter_4.html#cb59-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-12"><a href="5-Chapter_4.html#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model2.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)   BIC(L2)     Delta
FALSE  14 7.969585 0.8909046 -20.03042 -108.4175 0.6869727</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="5-Chapter_4.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3</span></span>
<span id="cb62-2"><a href="5-Chapter_4.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># it might not be fitted with gnm!</span></span>
<span id="cb62-3"><a href="5-Chapter_4.html#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="5-Chapter_4.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4</span></span>
<span id="cb62-5"><a href="5-Chapter_4.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># it might not be fitted with gnm!</span></span>
<span id="cb62-6"><a href="5-Chapter_4.html#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="5-Chapter_4.html#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5</span></span>
<span id="cb62-8"><a href="5-Chapter_4.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># it might not be fitted with gnm!</span></span>
<span id="cb62-9"><a href="5-Chapter_4.html#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="5-Chapter_4.html#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6</span></span>
<span id="cb62-11"><a href="5-Chapter_4.html#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># it might not be fitted with gnm!</span></span>
<span id="cb62-12"><a href="5-Chapter_4.html#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="5-Chapter_4.html#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7</span></span>
<span id="cb62-14"><a href="5-Chapter_4.html#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># it might not be fitted with gnm!</span></span>
<span id="cb62-15"><a href="5-Chapter_4.html#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="5-Chapter_4.html#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8</span></span>
<span id="cb62-17"><a href="5-Chapter_4.html#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co"># it might not be fitted with gnm!</span></span>
<span id="cb62-18"><a href="5-Chapter_4.html#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="5-Chapter_4.html#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 9</span></span>
<span id="cb62-20"><a href="5-Chapter_4.html#cb62-20" aria-hidden="true" tabindex="-1"></a>model9.un <span class="ot">&lt;-</span> <span class="fu">gnm</span>(</span>
<span id="cb62-21"><a href="5-Chapter_4.html#cb62-21" aria-hidden="true" tabindex="-1"></a>  Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(L, Educ, Occ, <span class="at">inst =</span> <span class="dv">1</span>)</span>
<span id="cb62-22"><a href="5-Chapter_4.html#cb62-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">Mult</span>(L, Educ, Occ, <span class="at">inst =</span> <span class="dv">2</span>),</span>
<span id="cb62-23"><a href="5-Chapter_4.html#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb62-24"><a href="5-Chapter_4.html#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> F,</span>
<span id="cb62-25"><a href="5-Chapter_4.html#cb62-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-12</span>,</span>
<span id="cb62-26"><a href="5-Chapter_4.html#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb62-27"><a href="5-Chapter_4.html#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterMax =</span> <span class="dv">100000</span></span>
<span id="cb62-28"><a href="5-Chapter_4.html#cb62-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations....................
FALSE Running main iterations.........................................................
FALSE ....................................................
FALSE Done</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="5-Chapter_4.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model9.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)  BIC(L2)    Delta
FALSE  30 38.46182 0.1382491 -21.53818 -210.939 2.123425</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="5-Chapter_4.html#cb67-1" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb67-2"><a href="5-Chapter_4.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  model9.un,</span>
<span id="cb67-3"><a href="5-Chapter_4.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9.un, <span class="st">&quot;[.]Educ&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb67-4"><a href="5-Chapter_4.html#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-5"><a href="5-Chapter_4.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-6"><a href="5-Chapter_4.html#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span></span>
<span id="cb67-7"><a href="5-Chapter_4.html#cb67-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-8"><a href="5-Chapter_4.html#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="5-Chapter_4.html#cb67-9" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb67-10"><a href="5-Chapter_4.html#cb67-10" aria-hidden="true" tabindex="-1"></a>  model9.un,</span>
<span id="cb67-11"><a href="5-Chapter_4.html#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9.un, <span class="st">&quot;[.]Occ&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb67-12"><a href="5-Chapter_4.html#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-13"><a href="5-Chapter_4.html#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-14"><a href="5-Chapter_4.html#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span></span>
<span id="cb67-15"><a href="5-Chapter_4.html#cb67-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-16"><a href="5-Chapter_4.html#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="5-Chapter_4.html#cb67-17" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb67-18"><a href="5-Chapter_4.html#cb67-18" aria-hidden="true" tabindex="-1"></a>  model9.un,</span>
<span id="cb67-19"><a href="5-Chapter_4.html#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9.un, <span class="st">&quot;[.]Educ&quot;</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb67-20"><a href="5-Chapter_4.html#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-21"><a href="5-Chapter_4.html#cb67-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-22"><a href="5-Chapter_4.html#cb67-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span></span>
<span id="cb67-23"><a href="5-Chapter_4.html#cb67-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-24"><a href="5-Chapter_4.html#cb67-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-25"><a href="5-Chapter_4.html#cb67-25" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb67-26"><a href="5-Chapter_4.html#cb67-26" aria-hidden="true" tabindex="-1"></a>  model9.un,</span>
<span id="cb67-27"><a href="5-Chapter_4.html#cb67-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model9.un, <span class="st">&quot;[.]Occ&quot;</span>)[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb67-28"><a href="5-Chapter_4.html#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-29"><a href="5-Chapter_4.html#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-30"><a href="5-Chapter_4.html#cb67-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span></span>
<span id="cb67-31"><a href="5-Chapter_4.html#cb67-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-32"><a href="5-Chapter_4.html#cb67-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-33"><a href="5-Chapter_4.html#cb67-33" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)],</span>
<span id="cb67-34"><a href="5-Chapter_4.html#cb67-34" aria-hidden="true" tabindex="-1"></a>         mu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)])</span>
<span id="cb67-35"><a href="5-Chapter_4.html#cb67-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-36"><a href="5-Chapter_4.html#cb67-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-37"><a href="5-Chapter_4.html#cb67-37" aria-hidden="true" tabindex="-1"></a>model9 <span class="ot">&lt;-</span> <span class="fu">gnm</span>(</span>
<span id="cb67-38"><a href="5-Chapter_4.html#cb67-38" aria-hidden="true" tabindex="-1"></a>  Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(L, Educ, Occ, <span class="at">inst =</span> <span class="dv">1</span>)</span>
<span id="cb67-39"><a href="5-Chapter_4.html#cb67-39" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">Mult</span>(L, Educ, Occ, <span class="at">inst =</span> <span class="dv">2</span>),</span>
<span id="cb67-40"><a href="5-Chapter_4.html#cb67-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">37</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">45</span>, <span class="dv">50</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">58</span>),</span>
<span id="cb67-41"><a href="5-Chapter_4.html#cb67-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">constrainTo =</span> con,</span>
<span id="cb67-42"><a href="5-Chapter_4.html#cb67-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb67-43"><a href="5-Chapter_4.html#cb67-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-12</span>,</span>
<span id="cb67-44"><a href="5-Chapter_4.html#cb67-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb67-45"><a href="5-Chapter_4.html#cb67-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterMax =</span> <span class="dv">100000</span></span>
<span id="cb67-46"><a href="5-Chapter_4.html#cb67-46" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations....................
FALSE Running main iterations.........................................................
FALSE ......................................
FALSE Done</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="5-Chapter_4.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model9)</span></code></pre></div>
<pre><code>FALSE 
FALSE Call:
FALSE gnm(formula = Freq ~ Educ + Occ + L + Educ:L + Occ:L + Mult(L, 
FALSE     Educ, Occ, inst = 1) + Mult(L, Educ, Occ, inst = 2), constrain = c(37, 
FALSE     40, 41, 45, 50, 53, 54, 58), constrainTo = con, family = poisson, 
FALSE     tolerance = 1e-12, iterStart = 20, iterMax = 1e+05)
FALSE 
FALSE Deviance Residuals: 
FALSE      Min        1Q    Median        3Q       Max  
FALSE -1.51811  -0.56756  -0.01895   0.28869   1.94702  
FALSE 
FALSE Coefficients:
FALSE                                  Estimate Std. Error z value Pr(&gt;|z|)    
FALSE (Intercept)                      3.776871   0.201817  18.714  &lt; 2e-16 ***
FALSE Educ2                           -1.475941   0.237006  -6.227 4.74e-10 ***
FALSE Educ3                            1.338024   0.250220   5.347 8.92e-08 ***
FALSE Educ4                           -0.386433   0.365319  -1.058 0.290147    
FALSE Occ2                            -0.819310   0.145907  -5.615 1.96e-08 ***
FALSE Occ3                            -0.358584   0.165219  -2.170 0.029980 *  
FALSE Occ4                            -0.747820   0.156695  -4.772 1.82e-06 ***
FALSE Occ5                            -2.242320   0.266133  -8.426  &lt; 2e-16 ***
FALSE L2                              -0.541993   0.239821  -2.260 0.023822 *  
FALSE L3                               0.332074   0.184369   1.801 0.071681 .  
FALSE L4                               0.578995   0.197763   2.928 0.003415 ** 
FALSE Educ2:L2                         0.249787   0.322280   0.775 0.438302    
FALSE Educ3:L2                         0.574508   0.310912   1.848 0.064629 .  
FALSE Educ4:L2                         1.258371   0.294826   4.268 1.97e-05 ***
FALSE Educ2:L3                         0.685185   0.256779   2.668 0.007622 ** 
FALSE Educ3:L3                        -0.051335   0.234420  -0.219 0.826661    
FALSE Educ4:L3                        -0.189157   0.201734  -0.938 0.348420    
FALSE Educ2:L4                         0.608704   0.256697   2.371 0.017726 *  
FALSE Educ3:L4                        -0.198847   0.245994  -0.808 0.418894    
FALSE Educ4:L4                        -0.132650   0.259420  -0.511 0.609117    
FALSE Occ2:L2                          1.106241   0.222342   4.975 6.51e-07 ***
FALSE Occ3:L2                         -2.833341   0.300699  -9.423  &lt; 2e-16 ***
FALSE Occ4:L2                          0.130662   0.188617   0.693 0.488475    
FALSE Occ5:L2                         -2.741272   0.760043  -3.607 0.000310 ***
FALSE Occ2:L3                         -0.020358   0.247401  -0.082 0.934419    
FALSE Occ3:L3                          0.003917   0.174660   0.022 0.982108    
FALSE Occ4:L3                          0.151826   0.182270   0.833 0.404858    
FALSE Occ5:L3                         -0.419846   0.384701  -1.091 0.275116    
FALSE Occ2:L4                          0.634026   0.244780   2.590 0.009592 ** 
FALSE Occ3:L4                         -2.325890   0.243990  -9.533  &lt; 2e-16 ***
FALSE Occ4:L4                         -0.005584   0.188443  -0.030 0.976362    
FALSE Occ5:L4                         -1.361009   0.448647  -3.034 0.002417 ** 
FALSE Mult(., Educ, Occ, inst = 1).L1 -0.539381   0.443291  -1.217 0.223694    
FALSE Mult(., Educ, Occ, inst = 1).L2 -1.685987   1.124282  -1.500 0.133715    
FALSE Mult(., Educ, Occ, inst = 1).L3  0.770115   0.484254   1.590 0.111765    
FALSE Mult(., Educ, Occ, inst = 1).L4 -1.891489   1.110200  -1.704 0.088430 .  
FALSE Mult(L, ., Occ, inst = 1).Educ1 -0.730944         NA      NA       NA    
FALSE Mult(L, ., Occ, inst = 1).Educ2  0.216854   0.397526   0.546 0.585404    
FALSE Mult(L, ., Occ, inst = 1).Educ3  0.635562   0.507015   1.254 0.210010    
FALSE Mult(L, ., Occ, inst = 1).Educ4 -0.121472         NA      NA       NA    
FALSE Mult(L, Educ, ., inst = 1).Occ1  0.070594         NA      NA       NA    
FALSE Mult(L, Educ, ., inst = 1).Occ2 -0.480302   0.239850  -2.003 0.045230 *  
FALSE Mult(L, Educ, ., inst = 1).Occ3 -0.197722   0.204305  -0.968 0.333157    
FALSE Mult(L, Educ, ., inst = 1).Occ4 -0.216260   0.176922  -1.222 0.221576    
FALSE Mult(L, Educ, ., inst = 1).Occ5  0.823689         NA      NA       NA    
FALSE Mult(., Educ, Occ, inst = 2).L1 -3.075307   0.398593  -7.715  &lt; 2e-16 ***
FALSE Mult(., Educ, Occ, inst = 2).L2 -3.474079   0.537127  -6.468 9.94e-11 ***
FALSE Mult(., Educ, Occ, inst = 2).L3 -2.949027   0.411449  -7.167 7.64e-13 ***
FALSE Mult(., Educ, Occ, inst = 2).L4 -2.460165   0.382429  -6.433 1.25e-10 ***
FALSE Mult(L, ., Occ, inst = 2).Educ1  0.640222         NA      NA       NA    
FALSE Mult(L, ., Occ, inst = 2).Educ2  0.238616   0.062126   3.841 0.000123 ***
FALSE Mult(L, ., Occ, inst = 2).Educ3 -0.168311   0.048597  -3.463 0.000533 ***
FALSE Mult(L, ., Occ, inst = 2).Educ4 -0.710527         NA      NA       NA    
FALSE Mult(L, Educ, ., inst = 2).Occ1 -0.765403         NA      NA       NA    
FALSE Mult(L, Educ, ., inst = 2).Occ2 -0.250142   0.087180  -2.869 0.004114 ** 
FALSE Mult(L, Educ, ., inst = 2).Occ3  0.397918   0.134487   2.959 0.003089 ** 
FALSE Mult(L, Educ, ., inst = 2).Occ4  0.273333   0.121403   2.251 0.024357 *  
FALSE Mult(L, Educ, ., inst = 2).Occ5  0.344294         NA      NA       NA    
FALSE ---
FALSE Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
FALSE 
FALSE (Dispersion parameter for poisson family taken to be 1)
FALSE 
FALSE Std. Error is NA where coefficient has been constrained or is unidentified
FALSE 
FALSE Residual deviance: 38.462 on 30 degrees of freedom
FALSE AIC: 500.27
FALSE 
FALSE Number of iterations: 95</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="5-Chapter_4.html#cb71-1" aria-hidden="true" tabindex="-1"></a>mu1</span></code></pre></div>
<pre><code>FALSE                                   Estimate Std. Error
FALSE Mult(L, ., Occ, inst = 1).Educ1 -0.7309442 0.07862794
FALSE Mult(L, ., Occ, inst = 1).Educ2  0.2168538 0.14103742
FALSE Mult(L, ., Occ, inst = 1).Educ3  0.6355624 0.08287906
FALSE Mult(L, ., Occ, inst = 1).Educ4 -0.1214720 0.17120754</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="5-Chapter_4.html#cb73-1" aria-hidden="true" tabindex="-1"></a>nu1</span></code></pre></div>
<pre><code>FALSE                                    Estimate Std. Error
FALSE Mult(L, Educ, ., inst = 1).Occ1  0.07059438 0.10141736
FALSE Mult(L, Educ, ., inst = 1).Occ2 -0.48030206 0.07332532
FALSE Mult(L, Educ, ., inst = 1).Occ3 -0.19772154 0.10545108
FALSE Mult(L, Educ, ., inst = 1).Occ4 -0.21626011 0.06608227
FALSE Mult(L, Educ, ., inst = 1).Occ5  0.82368933 0.03866984</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="5-Chapter_4.html#cb75-1" aria-hidden="true" tabindex="-1"></a>mu2</span></code></pre></div>
<pre><code>FALSE                                   Estimate Std. Error
FALSE Mult(L, ., Occ, inst = 2).Educ1  0.6402222 0.02882211
FALSE Mult(L, ., Occ, inst = 2).Educ2  0.2386164 0.03949527
FALSE Mult(L, ., Occ, inst = 2).Educ3 -0.1683115 0.03139203
FALSE Mult(L, ., Occ, inst = 2).Educ4 -0.7105272 0.02071164</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="5-Chapter_4.html#cb77-1" aria-hidden="true" tabindex="-1"></a>nu2</span></code></pre></div>
<pre><code>FALSE                                   Estimate Std. Error
FALSE Mult(L, Educ, ., inst = 2).Occ1 -0.7654028 0.02524700
FALSE Mult(L, Educ, ., inst = 2).Occ2 -0.2501417 0.04589839
FALSE Mult(L, Educ, ., inst = 2).Occ3  0.3979180 0.05170619
FALSE Mult(L, Educ, ., inst = 2).Occ4  0.2733327 0.04831936
FALSE Mult(L, Educ, ., inst = 2).Occ5  0.3442938 0.08637688</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="5-Chapter_4.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model9.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)  BIC(L2)    Delta
FALSE  30 38.46182 0.1382491 -21.53818 -210.939 2.123425</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="5-Chapter_4.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 10</span></span>
<span id="cb82-2"><a href="5-Chapter_4.html#cb82-2" aria-hidden="true" tabindex="-1"></a>Lc <span class="ot">&lt;-</span> L</span>
<span id="cb82-3"><a href="5-Chapter_4.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Lc) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb82-4"><a href="5-Chapter_4.html#cb82-4" aria-hidden="true" tabindex="-1"></a>model10.un <span class="ot">&lt;-</span> <span class="fu">gnm</span>(</span>
<span id="cb82-5"><a href="5-Chapter_4.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(Lc, Educ, Occ)</span>
<span id="cb82-6"><a href="5-Chapter_4.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">Mult</span>(L, Educ, Occ),</span>
<span id="cb82-7"><a href="5-Chapter_4.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb82-8"><a href="5-Chapter_4.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> F,</span>
<span id="cb82-9"><a href="5-Chapter_4.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-8</span>,</span>
<span id="cb82-10"><a href="5-Chapter_4.html#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb82-11"><a href="5-Chapter_4.html#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterMax =</span> <span class="dv">100000</span>,</span>
<span id="cb82-12"><a href="5-Chapter_4.html#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> F</span>
<span id="cb82-13"><a href="5-Chapter_4.html#cb82-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-14"><a href="5-Chapter_4.html#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model10.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)   BIC(L2)    Delta
FALSE  32 40.43536 0.1455738 -23.56464 -225.5922 2.168625</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="5-Chapter_4.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 11</span></span>
<span id="cb85-2"><a href="5-Chapter_4.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb85-3"><a href="5-Chapter_4.html#cb85-3" aria-hidden="true" tabindex="-1"></a>model11.un <span class="ot">&lt;-</span> <span class="fu">gnm</span>(</span>
<span id="cb85-4"><a href="5-Chapter_4.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ)</span>
<span id="cb85-5"><a href="5-Chapter_4.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">Mult</span>(L, Educ, Occ),</span>
<span id="cb85-6"><a href="5-Chapter_4.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb85-7"><a href="5-Chapter_4.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> F,</span>
<span id="cb85-8"><a href="5-Chapter_4.html#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-8</span>,</span>
<span id="cb85-9"><a href="5-Chapter_4.html#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb85-10"><a href="5-Chapter_4.html#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterMax =</span> <span class="dv">100000</span>,</span>
<span id="cb85-11"><a href="5-Chapter_4.html#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> F</span>
<span id="cb85-12"><a href="5-Chapter_4.html#cb85-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-13"><a href="5-Chapter_4.html#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model11.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)   BIC(L2)    Delta
FALSE  33 43.44178 0.1055553 -22.55822 -230.8992 2.307225</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="5-Chapter_4.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 12</span></span>
<span id="cb88-2"><a href="5-Chapter_4.html#cb88-2" aria-hidden="true" tabindex="-1"></a>L.c <span class="ot">&lt;-</span> L</span>
<span id="cb88-3"><a href="5-Chapter_4.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(L.c) <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb88-4"><a href="5-Chapter_4.html#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="5-Chapter_4.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb88-6"><a href="5-Chapter_4.html#cb88-6" aria-hidden="true" tabindex="-1"></a>model12.un <span class="ot">&lt;-</span></span>
<span id="cb88-7"><a href="5-Chapter_4.html#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ) <span class="sc">+</span> <span class="fu">Mult</span>(L.c, Educ, Occ),</span>
<span id="cb88-8"><a href="5-Chapter_4.html#cb88-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb88-9"><a href="5-Chapter_4.html#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb88-10"><a href="5-Chapter_4.html#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span>,</span>
<span id="cb88-11"><a href="5-Chapter_4.html#cb88-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb88-12"><a href="5-Chapter_4.html#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterMax =</span> <span class="dv">100000</span></span>
<span id="cb88-13"><a href="5-Chapter_4.html#cb88-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations....................
FALSE Running main iterations.........................................................
FALSE ............................................................................
FALSE Done</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="5-Chapter_4.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)   BIC(L2)    Delta
FALSE  34 44.64316 0.1046856 -23.35684 -238.0111 2.701997</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="5-Chapter_4.html#cb93-1" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb93-2"><a href="5-Chapter_4.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  model12.un,</span>
<span id="cb93-3"><a href="5-Chapter_4.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12.un, <span class="st">&quot;[.]Educ&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb93-4"><a href="5-Chapter_4.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb93-5"><a href="5-Chapter_4.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb93-6"><a href="5-Chapter_4.html#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span></span>
<span id="cb93-7"><a href="5-Chapter_4.html#cb93-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-8"><a href="5-Chapter_4.html#cb93-8" aria-hidden="true" tabindex="-1"></a>nu1 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb93-9"><a href="5-Chapter_4.html#cb93-9" aria-hidden="true" tabindex="-1"></a>  model12.un,</span>
<span id="cb93-10"><a href="5-Chapter_4.html#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12.un, <span class="st">&quot;[.]Occ&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb93-11"><a href="5-Chapter_4.html#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb93-12"><a href="5-Chapter_4.html#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb93-13"><a href="5-Chapter_4.html#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span></span>
<span id="cb93-14"><a href="5-Chapter_4.html#cb93-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-15"><a href="5-Chapter_4.html#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="5-Chapter_4.html#cb93-16" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb93-17"><a href="5-Chapter_4.html#cb93-17" aria-hidden="true" tabindex="-1"></a>  model12.un,</span>
<span id="cb93-18"><a href="5-Chapter_4.html#cb93-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12.un, <span class="st">&quot;[.]Educ&quot;</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>],</span>
<span id="cb93-19"><a href="5-Chapter_4.html#cb93-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb93-20"><a href="5-Chapter_4.html#cb93-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb93-21"><a href="5-Chapter_4.html#cb93-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span></span>
<span id="cb93-22"><a href="5-Chapter_4.html#cb93-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-23"><a href="5-Chapter_4.html#cb93-23" aria-hidden="true" tabindex="-1"></a>nu2 <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(</span>
<span id="cb93-24"><a href="5-Chapter_4.html#cb93-24" aria-hidden="true" tabindex="-1"></a>  model12.un,</span>
<span id="cb93-25"><a href="5-Chapter_4.html#cb93-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pickCoef</span>(model12.un, <span class="st">&quot;[.]Occ&quot;</span>)[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb93-26"><a href="5-Chapter_4.html#cb93-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb93-27"><a href="5-Chapter_4.html#cb93-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb93-28"><a href="5-Chapter_4.html#cb93-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span></span>
<span id="cb93-29"><a href="5-Chapter_4.html#cb93-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-30"><a href="5-Chapter_4.html#cb93-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-31"><a href="5-Chapter_4.html#cb93-31" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], nu1<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)],</span>
<span id="cb93-32"><a href="5-Chapter_4.html#cb93-32" aria-hidden="true" tabindex="-1"></a>         mu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], nu2<span class="sc">$</span>qvframe[, <span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)])</span>
<span id="cb93-33"><a href="5-Chapter_4.html#cb93-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-34"><a href="5-Chapter_4.html#cb93-34" aria-hidden="true" tabindex="-1"></a>model12 <span class="ot">&lt;-</span></span>
<span id="cb93-35"><a href="5-Chapter_4.html#cb93-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ) <span class="sc">+</span> <span class="fu">Mult</span>(L.c, Educ, Occ),</span>
<span id="cb93-36"><a href="5-Chapter_4.html#cb93-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrain =</span> <span class="fu">c</span>(<span class="dv">34</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">42</span>, <span class="dv">46</span>, <span class="dv">49</span>, <span class="dv">50</span>, <span class="dv">54</span>),</span>
<span id="cb93-37"><a href="5-Chapter_4.html#cb93-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">constrainTo =</span> con,</span>
<span id="cb93-38"><a href="5-Chapter_4.html#cb93-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb93-39"><a href="5-Chapter_4.html#cb93-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb93-40"><a href="5-Chapter_4.html#cb93-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-12</span>,</span>
<span id="cb93-41"><a href="5-Chapter_4.html#cb93-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb93-42"><a href="5-Chapter_4.html#cb93-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterMax =</span> <span class="dv">100000</span></span>
<span id="cb93-43"><a href="5-Chapter_4.html#cb93-43" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>FALSE Initialising
FALSE Running start-up iterations....................
FALSE Running main iterations.........................................................
FALSE ...................</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="5-Chapter_4.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model12)</span></code></pre></div>
<pre><code>FALSE Length  Class   Mode 
FALSE      0   NULL   NULL</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="5-Chapter_4.html#cb97-1" aria-hidden="true" tabindex="-1"></a>mu1</span></code></pre></div>
<pre><code>FALSE                         Estimate Std. Error
FALSE Mult(1, ., Occ).Educ1 -0.6496856 0.02689904
FALSE Mult(1, ., Occ).Educ2 -0.2266856 0.03916088
FALSE Mult(1, ., Occ).Educ3  0.1712502 0.02789996
FALSE Mult(1, ., Occ).Educ4  0.7051210 0.01869796</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="5-Chapter_4.html#cb99-1" aria-hidden="true" tabindex="-1"></a>nu1</span></code></pre></div>
<pre><code>FALSE                         Estimate Std. Error
FALSE Mult(1, Educ, .).Occ1  0.7477472 0.03046619
FALSE Mult(1, Educ, .).Occ2  0.2798375 0.04956910
FALSE Mult(1, Educ, .).Occ3 -0.3926778 0.05281437
FALSE Mult(1, Educ, .).Occ4 -0.2590761 0.04731457
FALSE Mult(1, Educ, .).Occ5 -0.3758307 0.08654401</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="5-Chapter_4.html#cb101-1" aria-hidden="true" tabindex="-1"></a>mu2</span></code></pre></div>
<pre><code>FALSE                           Estimate Std. Error
FALSE Mult(L.c, ., Occ).Educ1  0.7697514 0.05982573
FALSE Mult(L.c, ., Occ).Educ2 -0.1649990 0.14337525
FALSE Mult(L.c, ., Occ).Educ3 -0.6165380 0.08295724
FALSE Mult(L.c, ., Occ).Educ4  0.0117856 0.16680372</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="5-Chapter_4.html#cb103-1" aria-hidden="true" tabindex="-1"></a>nu2</span></code></pre></div>
<pre><code>FALSE                            Estimate Std. Error
FALSE Mult(L.c, Educ, .).Occ1  0.04308284 0.07694408
FALSE Mult(L.c, Educ, .).Occ2 -0.47712634 0.07295173
FALSE Mult(L.c, Educ, .).Occ3 -0.22737747 0.10213888
FALSE Mult(L.c, Educ, .).Occ4 -0.16931700 0.06314427
FALSE Mult(L.c, Educ, .).Occ5  0.83073797 0.03112819</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="5-Chapter_4.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model12.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2         p   AIC(L2)   BIC(L2)    Delta
FALSE  34 44.64316 0.1046856 -23.35684 -238.0111 2.701997</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="5-Chapter_4.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 13</span></span>
<span id="cb108-2"><a href="5-Chapter_4.html#cb108-2" aria-hidden="true" tabindex="-1"></a>model13.un <span class="ot">&lt;-</span></span>
<span id="cb108-3"><a href="5-Chapter_4.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gnm</span>(Freq <span class="sc">~</span> Educ <span class="sc">+</span> Occ <span class="sc">+</span> L <span class="sc">+</span> Educ<span class="sc">:</span>L <span class="sc">+</span> Occ<span class="sc">:</span>L <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ, <span class="at">inst =</span> <span class="dv">1</span>)</span>
<span id="cb108-4"><a href="5-Chapter_4.html#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">Mult</span>(<span class="dv">1</span>, Educ, Occ, <span class="at">inst =</span> <span class="dv">2</span>),</span>
<span id="cb108-5"><a href="5-Chapter_4.html#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson,</span>
<span id="cb108-6"><a href="5-Chapter_4.html#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> F,</span>
<span id="cb108-7"><a href="5-Chapter_4.html#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-8</span>,</span>
<span id="cb108-8"><a href="5-Chapter_4.html#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterStart =</span> <span class="dv">20</span>,</span>
<span id="cb108-9"><a href="5-Chapter_4.html#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterMax =</span> <span class="dv">100000</span>,</span>
<span id="cb108-10"><a href="5-Chapter_4.html#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> F</span>
<span id="cb108-11"><a href="5-Chapter_4.html#cb108-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-12"><a href="5-Chapter_4.html#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(model13.un)</span></code></pre></div>
<pre><code>FALSE [1] &quot;Model Summary:&quot;</code></pre>
<pre><code>FALSE  Df       L2            p  AIC(L2)  BIC(L2)    Delta
FALSE  38 117.3838 4.933675e-10 41.38378 -198.524 5.236715</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="4-Chapter_3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="6-Chapter_5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["カテゴリカルデータの連関モデル.pdf", "カテゴリカルデータの連関モデル.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
