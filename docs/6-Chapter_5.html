<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 第5章 | 『カテゴリカルデータの連関モデル』サポートページ</title>
  <meta name="description" content="6 第5章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="6 第5章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 第5章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  
  
  

<meta name="author" content="藤原翔（Sho Fujihara）" />


<meta name="date" content="2022-04-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="5-Chapter_4.html"/>
<link rel="next" href="7-Chapter_6.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> bookdown::gitbook: default<span></span></a>
<ul>
<li><a href="index.html#目的">目的<span></span></a></li>
<li><a href="index.html#rのスクリプト">Rのスクリプト<span></span></a></li>
<li><a href="index.html#サポートページバージョン情報">サポートページバージョン情報<span></span></a></li>
</ul></li>
<li><a href="1-Introduction.html#はじめに">はじめに<span></span></a>
<ul>
<li><a href="1-Introduction.html#独立性の検定">独立性の検定<span></span></a></li>
<li><a href="1-Introduction.html#一様連関モデル">一様連関モデル<span></span></a></li>
<li><a href="1-Introduction.html#度数行変数列変数のデータからクロス表を作成">度数，行変数，列変数のデータからクロス表を作成<span></span></a></li>
<li class="chapter" data-level="1.1" data-path="1-Introduction.html"><a href="1-Introduction.html"><i class="fa fa-check"></i><b>1.1</b> 個票データから集計データを作成<span></span></a></li>
<li><a href="1-Introduction.html#練習問題">練習問題<span></span></a></li>
<li><a href="1-Introduction.html#参考文献">参考文献<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-Chapter_1.html"><a href="2-Chapter_1.html"><i class="fa fa-check"></i><b>2</b> 第1章<span></span></a></li>
<li class="chapter" data-level="3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html"><i class="fa fa-check"></i><b>3</b> 第2章<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#対比について"><i class="fa fa-check"></i><b>3.1</b> 対比について<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.1-p.8"><i class="fa fa-check"></i><b>3.2</b> 表2.1 (p.8)<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.3-p.32"><i class="fa fa-check"></i><b>3.3</b> 表2.3 (p.32)<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4a"><i class="fa fa-check"></i><b>3.4</b> 表2.4A<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4b"><i class="fa fa-check"></i><b>3.5</b> 表2.4B<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.5a"><i class="fa fa-check"></i><b>3.6</b> 表2.5A<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#logmultパッケージの利用"><i class="fa fa-check"></i><b>3.7</b> logmultパッケージの利用<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6a"><i class="fa fa-check"></i><b>3.8</b> 表2.6A<span></span></a></li>
<li class="chapter" data-level="3.9" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6b"><i class="fa fa-check"></i><b>3.9</b> 表2.6B<span></span></a></li>
<li class="chapter" data-level="3.10" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6c"><i class="fa fa-check"></i><b>3.10</b> 表2.6C<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html"><i class="fa fa-check"></i><b>4</b> 第3章<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1a"><i class="fa fa-check"></i><b>4.1</b> 表3.1A<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1b"><i class="fa fa-check"></i><b>4.2</b> 表3.1B<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-Chapter_4.html"><a href="5-Chapter_4.html"><i class="fa fa-check"></i><b>5</b> 第4章<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="5-Chapter_4.html"><a href="5-Chapter_4.html#表4.3"><i class="fa fa-check"></i><b>5.1</b> 表4.3<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="5-Chapter_4.html"><a href="5-Chapter_4.html#表4.6"><i class="fa fa-check"></i><b>5.2</b> 表4.6<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html"><i class="fa fa-check"></i><b>6</b> 第5章<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html#表5.1"><i class="fa fa-check"></i><b>6.1</b> 表5.1<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="6-Chapter_5.html"><a href="6-Chapter_5.html#表5.4"><i class="fa fa-check"></i><b>6.2</b> 表5.4<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-Chapter_6.html"><a href="7-Chapter_6.html"><i class="fa fa-check"></i><b>7</b> 第6章<span></span></a></li>
<li><a href="8-Note.html#補足のノート">補足のノート<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="8-Note.html"><a href="8-Note.html"><i class="fa fa-check"></i><b>7.1</b> パッケージ<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="8-Note.html"><a href="8-Note.html#クロス表の作成"><i class="fa fa-check"></i><b>7.2</b> クロス表の作成<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="8-Note.html"><a href="8-Note.html#集計データの作成"><i class="fa fa-check"></i><b>7.3</b> 集計データの作成<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="8-Note.html"><a href="8-Note.html#glmとgnmの結果の比較"><i class="fa fa-check"></i><b>7.4</b> GLMとGNMの結果の比較<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="8-Note.html"><a href="8-Note.html#期待度数"><i class="fa fa-check"></i><b>7.5</b> 期待度数<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="8-Note.html"><a href="8-Note.html#モザイクプロット"><i class="fa fa-check"></i><b>7.6</b> モザイクプロット<span></span></a></li>
<li class="chapter" data-level="7.7" data-path="8-Note.html"><a href="8-Note.html#正規化"><i class="fa fa-check"></i><b>7.7</b> 正規化<span></span></a></li>
<li class="chapter" data-level="7.8" data-path="8-Note.html"><a href="8-Note.html#初期値"><i class="fa fa-check"></i><b>7.8</b> 初期値<span></span></a></li>
<li class="chapter" data-level="7.9" data-path="8-Note.html"><a href="8-Note.html#位相モデル"><i class="fa fa-check"></i><b>7.9</b> 位相モデル<span></span></a></li>
<li class="chapter" data-level="7.10" data-path="8-Note.html"><a href="8-Note.html#xie"><i class="fa fa-check"></i><b>7.10</b> Xie<span></span></a></li>
</ul></li>
<li><a href="9-R.html#rのインストールと基本的な操作方法">Rのインストールと基本的な操作方法<span></span></a></li>
<li class="divider"></li>
<li></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第5章" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> 第5章<a href="6-Chapter_5.html#第5章" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="6-Chapter_5.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="6-Chapter_5.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-3"><a href="6-Chapter_5.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gnm)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="6-Chapter_5.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the constrasts</span></span>
<span id="cb2-2"><a href="6-Chapter_5.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we use sum to zero contrast.</span></span>
<span id="cb2-3"><a href="6-Chapter_5.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width=</span><span class="dv">90</span>,<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="at">factor=</span><span class="st">&quot;contr.sum&quot;</span>, <span class="at">ordered=</span><span class="st">&quot;contr.treatment&quot;</span>))</span>
<span id="cb2-4"><a href="6-Chapter_5.html#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="6-Chapter_5.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function which calculation BIC based on L2 statistics</span></span>
<span id="cb2-6"><a href="6-Chapter_5.html#cb2-6" aria-hidden="true" tabindex="-1"></a>model.summary <span class="ot">&lt;-</span> <span class="cf">function</span>(obj) {</span>
<span id="cb2-7"><a href="6-Chapter_5.html#cb2-7" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="dv">2</span>   <span class="co"># AIC(L2)</span></span>
<span id="cb2-8"><a href="6-Chapter_5.html#cb2-8" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> obj<span class="sc">$</span>deviance <span class="sc">-</span> obj<span class="sc">$</span>df <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">sum</span>(obj<span class="sc">$</span>y))   <span class="co">#BIC(L2)</span></span>
<span id="cb2-9"><a href="6-Chapter_5.html#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Index of Dissimilarity (%)</span></span>
<span id="cb2-10"><a href="6-Chapter_5.html#cb2-10" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">abs</span>(obj<span class="sc">$</span>y <span class="sc">-</span> obj<span class="sc">$</span>fitted.values)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(obj<span class="sc">$</span>y))</span>
<span id="cb2-11"><a href="6-Chapter_5.html#cb2-11" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(obj<span class="sc">$</span>deviance, obj<span class="sc">$</span>df, <span class="at">lower.tail =</span> F)</span>
<span id="cb2-12"><a href="6-Chapter_5.html#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#p&lt;-ifelse(p&lt;0.001,&quot;&lt;0.001&quot;,p)</span></span>
<span id="cb2-13"><a href="6-Chapter_5.html#cb2-13" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb2-14"><a href="6-Chapter_5.html#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb2-15"><a href="6-Chapter_5.html#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Df&quot;</span>, <span class="st">&quot;L2&quot;</span>, <span class="st">&quot;p&quot;</span>, <span class="st">&quot;AIC(L2)&quot;</span>, <span class="st">&quot;BIC(L2)&quot;</span>, <span class="st">&quot;Delta&quot;</span>)</span>
<span id="cb2-16"><a href="6-Chapter_5.html#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#exp.freq=obj$fitted.values</span></span>
<span id="cb2-17"><a href="6-Chapter_5.html#cb2-17" aria-hidden="true" tabindex="-1"></a>  result[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(obj<span class="sc">$</span>df, obj<span class="sc">$</span>deviance, p, aic, bic, delta)</span>
<span id="cb2-18"><a href="6-Chapter_5.html#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Model Summary:&quot;</span>)</span>
<span id="cb2-19"><a href="6-Chapter_5.html#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb2-20"><a href="6-Chapter_5.html#cb2-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="表5.1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 表5.1<a href="6-Chapter_5.html#表5.1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="6-Chapter_5.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 5.1</span></span>
<span id="cb3-2"><a href="6-Chapter_5.html#cb3-2" aria-hidden="true" tabindex="-1"></a>Freq<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">118</span>, <span class="dv">28</span>,  <span class="dv">32</span>,  <span class="dv">6</span>,  <span class="dv">7</span>,</span>
<span id="cb3-3"><a href="6-Chapter_5.html#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">218</span>, <span class="dv">28</span>,  <span class="dv">97</span>, <span class="dv">12</span>, <span class="dv">14</span>,</span>
<span id="cb3-4"><a href="6-Chapter_5.html#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="dv">11</span>,  <span class="dv">2</span>,   <span class="dv">4</span>,  <span class="dv">1</span>,  <span class="dv">1</span>,</span>
<span id="cb3-5"><a href="6-Chapter_5.html#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">104</span>, <span class="dv">22</span>,  <span class="dv">61</span>,  <span class="dv">8</span>,  <span class="dv">5</span>,</span>
<span id="cb3-6"><a href="6-Chapter_5.html#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">117</span>, <span class="dv">24</span>,  <span class="dv">70</span>,  <span class="dv">9</span>,  <span class="dv">7</span>,</span>
<span id="cb3-7"><a href="6-Chapter_5.html#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="dv">42</span>,  <span class="dv">6</span>,  <span class="dv">20</span>,  <span class="dv">2</span>,  <span class="dv">0</span>,</span>
<span id="cb3-8"><a href="6-Chapter_5.html#cb3-8" aria-hidden="true" tabindex="-1"></a>         <span class="dv">48</span>, <span class="dv">16</span>, <span class="dv">104</span>, <span class="dv">14</span>,  <span class="dv">9</span>,</span>
<span id="cb3-9"><a href="6-Chapter_5.html#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="dv">128</span>, <span class="dv">52</span>,  <span class="dv">81</span>, <span class="dv">14</span>, <span class="dv">12</span>)</span>
<span id="cb3-10"><a href="6-Chapter_5.html#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="6-Chapter_5.html#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="6-Chapter_5.html#cb3-12" aria-hidden="true" tabindex="-1"></a>Worries<span class="ot">&lt;-</span><span class="fu">gl</span>(<span class="dv">8</span>,<span class="dv">5</span>)</span>
<span id="cb3-13"><a href="6-Chapter_5.html#cb3-13" aria-hidden="true" tabindex="-1"></a>Situations<span class="ot">&lt;-</span><span class="fu">gl</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">8</span><span class="sc">*</span><span class="dv">5</span>)</span>
<span id="cb3-14"><a href="6-Chapter_5.html#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="6-Chapter_5.html#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="6-Chapter_5.html#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1 - Independence</span></span>
<span id="cb3-17"><a href="6-Chapter_5.html#cb3-17" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Worries<span class="sc">+</span>Situations,<span class="at">family=</span>poisson,<span class="at">trace=</span>F,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb3-18"><a href="6-Chapter_5.html#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m1)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code> Df       L2            p  AIC(L2)   BIC(L2)    Delta
 28 121.4661 1.307612e-13 65.46607 -84.29438 9.844607</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="6-Chapter_5.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2 - RC(1)</span></span>
<span id="cb6-2"><a href="6-Chapter_5.html#cb6-2" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Worries<span class="sc">+</span>Situations<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Worries,Situations),<span class="at">family=</span>poisson,</span>
<span id="cb6-3"><a href="6-Chapter_5.html#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">trace=</span>F,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
..........................................................................................
..........................................................................................
..........................................................................................
..........................................................................................
.........................................................................
Done</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="6-Chapter_5.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m2)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code> Df       L2            p  AIC(L2)   BIC(L2)    Delta
 27 121.4874 5.995511e-14 67.48739 -76.92448 9.838695</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="6-Chapter_5.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3 - RC(1) with equality constraints on</span></span>
<span id="cb11-2"><a href="6-Chapter_5.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MIL=ECO=MTO, ENR=SAB=OTH and ASAF=IFAA</span></span>
<span id="cb11-3"><a href="6-Chapter_5.html#cb11-3" aria-hidden="true" tabindex="-1"></a>Worries.a<span class="ot">&lt;-</span>Worries</span>
<span id="cb11-4"><a href="6-Chapter_5.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Worries.a)<span class="ot">&lt;-</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>))</span>
<span id="cb11-5"><a href="6-Chapter_5.html#cb11-5" aria-hidden="true" tabindex="-1"></a>Worries.a</span></code></pre></div>
<pre><code> [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 4 4 4 4 4 3 3 3 3 3
Levels: 1 2 3 4</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="6-Chapter_5.html#cb13-1" aria-hidden="true" tabindex="-1"></a>Situations.a<span class="ot">&lt;-</span>Situations</span>
<span id="cb13-2"><a href="6-Chapter_5.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Situations.a)<span class="ot">&lt;-</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb13-3"><a href="6-Chapter_5.html#cb13-3" aria-hidden="true" tabindex="-1"></a>Situations.a</span></code></pre></div>
<pre><code> [1] 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4 1 2 3 3 4
Levels: 1 2 3 4</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="6-Chapter_5.html#cb15-1" aria-hidden="true" tabindex="-1"></a>m3.un<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Worries<span class="sc">+</span>Situations<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Worries.a,Situations.a),<span class="at">family=</span>poisson,</span>
<span id="cb15-2"><a href="6-Chapter_5.html#cb15-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">trace=</span>F,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
...............................................
Done</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="6-Chapter_5.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m3.un)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code> Df       L2             p  AIC(L2)  BIC(L2)    Delta
 32 925.4714 8.207554e-174 861.4714 690.3166 30.30552</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="6-Chapter_5.html#cb20-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">getContrasts</span>(m3.un, <span class="fu">pickCoef</span>(m3.un, <span class="st">&quot;[.]Worries.a&quot;</span>),</span>
<span id="cb20-2"><a href="6-Chapter_5.html#cb20-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">ref =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">8</span>, <span class="at">scaleRef =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">8</span>,</span>
<span id="cb20-3"><a href="6-Chapter_5.html#cb20-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">scaleWeights =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb20-4"><a href="6-Chapter_5.html#cb20-4" aria-hidden="true" tabindex="-1"></a>nu<span class="ot">&lt;-</span><span class="fu">getContrasts</span>(m3.un, <span class="fu">pickCoef</span>(m3.un, <span class="st">&quot;[.]Situations.a&quot;</span>),</span>
<span id="cb20-5"><a href="6-Chapter_5.html#cb20-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">ref =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span>, <span class="at">scaleRef =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span>,</span>
<span id="cb20-6"><a href="6-Chapter_5.html#cb20-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">scaleWeights =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb20-7"><a href="6-Chapter_5.html#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="6-Chapter_5.html#cb20-8" aria-hidden="true" tabindex="-1"></a>con<span class="ot">&lt;-</span><span class="fu">c</span>(mu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],nu<span class="sc">$</span>qvframe[,<span class="dv">1</span>][<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span>
<span id="cb20-9"><a href="6-Chapter_5.html#cb20-9" aria-hidden="true" tabindex="-1"></a>m3<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Worries<span class="sc">+</span>Situations<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Worries.a,Situations.a),<span class="at">family=</span>poisson,</span>
<span id="cb20-10"><a href="6-Chapter_5.html#cb20-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">constrain=</span><span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">21</span>),<span class="at">constrainTo=</span>con,</span>
<span id="cb20-11"><a href="6-Chapter_5.html#cb20-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">trace=</span>F,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
...........................................................................
Done</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="6-Chapter_5.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3);mu;nu;<span class="fu">model.summary</span>(m3.un)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ Worries + Situations + Mult(1, Worries.a, 
    Situations.a), constrain = c(14, 17, 18, 21), constrainTo = con, 
    family = poisson, tolerance = 1e-12, trace = F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-11.364   -4.566   -1.177    1.247   11.623  

Coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          3.50501    0.04289  81.724  &lt; 2e-16 ***
Worries1                             0.00000         NA      NA       NA    
Worries2                             0.00000         NA      NA       NA    
Worries3                             0.00000         NA      NA       NA    
Worries4                             0.00000         NA      NA       NA    
Worries5                             0.00000         NA      NA       NA    
Worries6                             0.00000         NA      NA       NA    
Worries7                             0.00000         NA      NA       NA    
Situations1                          0.00000         NA      NA       NA    
Situations2                          0.00000         NA      NA       NA    
Situations3                          0.00000         NA      NA       NA    
Situations4                          0.00000         NA      NA       NA    
Mult(., Worries.a, Situations.a).    0.45649    0.46489   0.982 0.326138    
Mult(1, ., Situations.a).Worries.a1  0.11313         NA      NA       NA    
Mult(1, ., Situations.a).Worries.a2 -3.63355    3.70632  -0.980 0.326906    
Mult(1, ., Situations.a).Worries.a3 -4.05192    4.13163  -0.981 0.326737    
Mult(1, ., Situations.a).Worries.a4 -0.35379         NA      NA       NA    
Mult(1, Worries.a, .).Situations.a1 -0.66229         NA      NA       NA    
Mult(1, Worries.a, .).Situations.a2  0.21821    0.05836   3.739 0.000185 ***
Mult(1, Worries.a, .).Situations.a3  0.01290    0.03812   0.338 0.734996    
Mult(1, Worries.a, .).Situations.a4  0.72845         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 1162.5 on 34 degrees of freedom
AIC: 1360.8

Number of iterations: 142</code></pre>
<pre><code>                                      Estimate Std. Error
Mult(1, ., Situations.a).Worries.a1  0.1131301 0.11361061
Mult(1, ., Situations.a).Worries.a2  0.4170232 0.02269737
Mult(1, ., Situations.a).Worries.a3 -0.3368043 0.03042467
Mult(1, ., Situations.a).Worries.a4 -0.3537867 0.08354914</code></pre>
<pre><code>                                       Estimate Std. Error
Mult(1, Worries.a, .).Situations.a1 -0.66229120 0.02512458
Mult(1, Worries.a, .).Situations.a2  0.11763705 0.03837698
Mult(1, Worries.a, .).Situations.a3 -0.09189854 0.01868966
Mult(1, Worries.a, .).Situations.a4  0.72845124 0.02397519</code></pre>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code> Df       L2             p  AIC(L2)  BIC(L2)    Delta
 32 925.4714 8.207554e-174 861.4714 690.3166 30.30552</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="6-Chapter_5.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4 - RC(1) with equality constraints on</span></span>
<span id="cb28-2"><a href="6-Chapter_5.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MIL=ECO=MTO=ENR=SAB=OTH and ASAF=IFAA</span></span>
<span id="cb28-3"><a href="6-Chapter_5.html#cb28-3" aria-hidden="true" tabindex="-1"></a>Worries.b<span class="ot">&lt;-</span>Worries</span>
<span id="cb28-4"><a href="6-Chapter_5.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Worries.b)<span class="ot">&lt;-</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb28-5"><a href="6-Chapter_5.html#cb28-5" aria-hidden="true" tabindex="-1"></a>Worries.b</span></code></pre></div>
<pre><code> [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 2 2 2 2 2
Levels: 1 2 3</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="6-Chapter_5.html#cb30-1" aria-hidden="true" tabindex="-1"></a>m4.un<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Worries<span class="sc">+</span>Situations<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Worries.b,Situations.a),<span class="at">family=</span>poisson,</span>
<span id="cb30-2"><a href="6-Chapter_5.html#cb30-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">trace=</span>F,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations............................................................
Done</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="6-Chapter_5.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m4.un)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code> Df       L2             p  AIC(L2)  BIC(L2)   Delta
 33 964.1288 3.382326e-181 898.1288 721.6254 30.4467</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="6-Chapter_5.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5</span></span>
<span id="cb35-2"><a href="6-Chapter_5.html#cb35-2" aria-hidden="true" tabindex="-1"></a>m5.un<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Worries<span class="sc">+</span>Situations<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Worries,Situations,<span class="at">inst=</span><span class="dv">1</span>)</span>
<span id="cb35-3"><a href="6-Chapter_5.html#cb35-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Worries,Situations,<span class="at">inst=</span><span class="dv">2</span>),<span class="at">family=</span>poisson,</span>
<span id="cb35-4"><a href="6-Chapter_5.html#cb35-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">trace=</span>F,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
..........................................................................................
..........................................................................................
..........................................................................................
..........................................................................................
.........................................................................
Done</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="6-Chapter_5.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m5.un)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code> Df       L2          p   AIC(L2)   BIC(L2)    Delta
 17 29.36242 0.03132697 -4.637583 -95.56357 3.927879</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="6-Chapter_5.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 - RC(2) with equality constraints on</span></span>
<span id="cb40-2"><a href="6-Chapter_5.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ECO=MTO=MIL=ENR=SAB and ASAF=IFAA in both dimensions</span></span>
<span id="cb40-3"><a href="6-Chapter_5.html#cb40-3" aria-hidden="true" tabindex="-1"></a>Worries.c<span class="ot">&lt;-</span>Worries</span>
<span id="cb40-4"><a href="6-Chapter_5.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Worries.c)<span class="ot">&lt;-</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb40-5"><a href="6-Chapter_5.html#cb40-5" aria-hidden="true" tabindex="-1"></a>Worries.c</span></code></pre></div>
<pre><code> [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4
Levels: 1 2 3 4</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="6-Chapter_5.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb42-2"><a href="6-Chapter_5.html#cb42-2" aria-hidden="true" tabindex="-1"></a>m6.un<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Worries<span class="sc">+</span>Situations<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Worries.c,Situations.a,<span class="at">inst=</span><span class="dv">1</span>)</span>
<span id="cb42-3"><a href="6-Chapter_5.html#cb42-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Worries.c,Situations.a,<span class="at">inst=</span><span class="dv">2</span>),<span class="at">family=</span>poisson,</span>
<span id="cb42-4"><a href="6-Chapter_5.html#cb42-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">trace=</span>F,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
...
Done</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="6-Chapter_5.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m6.un)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code> Df       L2             p  AIC(L2)  BIC(L2)    Delta
 27 853.0971 2.550771e-162 799.0971 654.6853 27.69847</code></pre>
</div>
<div id="表5.4" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 表5.4<a href="6-Chapter_5.html#表5.4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="6-Chapter_5.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 5.4</span></span>
<span id="cb47-2"><a href="6-Chapter_5.html#cb47-2" aria-hidden="true" tabindex="-1"></a>Freq<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1096</span>,  <span class="dv">1847</span>,  <span class="dv">1255</span>,  <span class="dv">925</span>,    <span class="dv">3321</span>,  <span class="dv">6123</span>,  <span class="dv">6830</span>,  <span class="dv">5524</span>,</span>
<span id="cb47-3"><a href="6-Chapter_5.html#cb47-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1541</span>,  <span class="dv">3134</span>,  <span class="dv">3145</span>, <span class="dv">3300</span>,    <span class="dv">1915</span>,  <span class="dv">4429</span>,  <span class="dv">7035</span>,  <span class="dv">9421</span>,</span>
<span id="cb47-4"><a href="6-Chapter_5.html#cb47-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4183</span>,  <span class="dv">5139</span>,  <span class="dv">1857</span>, <span class="dv">1272</span>,    <span class="dv">8080</span>,  <span class="dv">8586</span>,  <span class="dv">4788</span>,  <span class="dv">4294</span>,</span>
<span id="cb47-5"><a href="6-Chapter_5.html#cb47-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">6033</span>,  <span class="dv">9211</span>,  <span class="dv">5046</span>, <span class="dv">1058</span>,   <span class="dv">28130</span>, <span class="dv">44589</span>, <span class="dv">20074</span>,  <span class="dv">3408</span>,</span>
<span id="cb47-6"><a href="6-Chapter_5.html#cb47-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4354</span>, <span class="dv">13430</span>, <span class="dv">18670</span>, <span class="dv">9821</span>,    <span class="dv">2250</span>,  <span class="dv">9075</span>, <span class="dv">18286</span>, <span class="dv">14358</span>,</span>
<span id="cb47-7"><a href="6-Chapter_5.html#cb47-7" aria-hidden="true" tabindex="-1"></a>       <span class="dv">14587</span>, <span class="dv">31470</span>, <span class="dv">16390</span>, <span class="dv">3751</span>,    <span class="dv">8242</span>, <span class="dv">17532</span>, <span class="dv">12825</span>,  <span class="dv">3956</span>,</span>
<span id="cb47-8"><a href="6-Chapter_5.html#cb47-8" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1517</span>,  <span class="dv">5820</span>,  <span class="dv">6197</span>, <span class="dv">2372</span>,     <span class="dv">721</span>,  <span class="dv">2909</span>,  <span class="dv">4141</span>,  <span class="dv">2070</span>,</span>
<span id="cb47-9"><a href="6-Chapter_5.html#cb47-9" aria-hidden="true" tabindex="-1"></a>        <span class="dv">3581</span>,  <span class="dv">9268</span>,  <span class="dv">5463</span>, <span class="dv">1007</span>,    <span class="dv">1341</span>,  <span class="dv">3808</span>,  <span class="dv">3163</span>,   <span class="dv">815</span>,</span>
<span id="cb47-10"><a href="6-Chapter_5.html#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1454</span>,  <span class="dv">3109</span>,  <span class="dv">1055</span>,  <span class="dv">888</span>,     <span class="dv">563</span>,  <span class="dv">1909</span>,  <span class="dv">1018</span>,  <span class="dv">1051</span>,</span>
<span id="cb47-11"><a href="6-Chapter_5.html#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="dv">3237</span>,  <span class="dv">3851</span>,   <span class="dv">377</span>,  <span class="dv">102</span>,     <span class="dv">731</span>,   <span class="dv">858</span>,   <span class="dv">247</span>,    <span class="dv">84</span>,</span>
<span id="cb47-12"><a href="6-Chapter_5.html#cb47-12" aria-hidden="true" tabindex="-1"></a>       <span class="dv">14882</span>, <span class="dv">22182</span>,  <span class="dv">5363</span>, <span class="dv">1136</span>,   <span class="dv">11650</span>, <span class="dv">15818</span>,  <span class="dv">5524</span>,  <span class="dv">2122</span>,</span>
<span id="cb47-13"><a href="6-Chapter_5.html#cb47-13" aria-hidden="true" tabindex="-1"></a>        <span class="dv">6033</span>,  <span class="dv">3475</span>,    <span class="dv">63</span>,   <span class="dv">18</span>,    <span class="dv">1603</span>,  <span class="dv">1005</span>,    <span class="dv">30</span>,    <span class="dv">16</span>,</span>
<span id="cb47-14"><a href="6-Chapter_5.html#cb47-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-15"><a href="6-Chapter_5.html#cb47-15" aria-hidden="true" tabindex="-1"></a>        <span class="dv">5968</span>,  <span class="dv">8783</span>,  <span class="dv">7701</span>, <span class="dv">6483</span>,    <span class="dv">8733</span>, <span class="dv">14329</span>, <span class="dv">19386</span>, <span class="dv">28143</span>,</span>
<span id="cb47-16"><a href="6-Chapter_5.html#cb47-16" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1011</span>,  <span class="dv">2162</span>,  <span class="dv">3536</span>, <span class="dv">6649</span>,     <span class="dv">697</span>,  <span class="dv">1299</span>,  <span class="dv">2362</span>, <span class="dv">10796</span>,</span>
<span id="cb47-17"><a href="6-Chapter_5.html#cb47-17" aria-hidden="true" tabindex="-1"></a>        <span class="dv">3214</span>,  <span class="dv">3621</span>,  <span class="dv">2485</span>, <span class="dv">3177</span>,     <span class="dv">793</span>,  <span class="dv">1134</span>,  <span class="dv">1292</span>,  <span class="dv">3597</span>,</span>
<span id="cb47-18"><a href="6-Chapter_5.html#cb47-18" aria-hidden="true" tabindex="-1"></a>       <span class="dv">11532</span>, <span class="dv">16837</span>,  <span class="dv">6975</span>, <span class="dv">1839</span>,    <span class="dv">2563</span>,  <span class="dv">2995</span>,  <span class="dv">2060</span>,  <span class="dv">1600</span>,</span>
<span id="cb47-19"><a href="6-Chapter_5.html#cb47-19" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1009</span>,  <span class="dv">2719</span>,  <span class="dv">3521</span>, <span class="dv">3409</span>,     <span class="dv">296</span>,   <span class="dv">503</span>,   <span class="dv">626</span>,  <span class="dv">1273</span>,</span>
<span id="cb47-20"><a href="6-Chapter_5.html#cb47-20" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1586</span>,  <span class="dv">3025</span>,  <span class="dv">1726</span>,  <span class="dv">668</span>,     <span class="dv">245</span>,   <span class="dv">415</span>,   <span class="dv">238</span>,   <span class="dv">218</span>,</span>
<span id="cb47-21"><a href="6-Chapter_5.html#cb47-21" aria-hidden="true" tabindex="-1"></a>         <span class="dv">387</span>,   <span class="dv">941</span>,   <span class="dv">564</span>,  <span class="dv">316</span>,      <span class="dv">86</span>,   <span class="dv">138</span>,    <span class="dv">79</span>,    <span class="dv">48</span>,</span>
<span id="cb47-22"><a href="6-Chapter_5.html#cb47-22" aria-hidden="true" tabindex="-1"></a>         <span class="dv">994</span>,  <span class="dv">1988</span>,   <span class="dv">542</span>,  <span class="dv">145</span>,     <span class="dv">158</span>,   <span class="dv">259</span>,   <span class="dv">101</span>,    <span class="dv">56</span>,</span>
<span id="cb47-23"><a href="6-Chapter_5.html#cb47-23" aria-hidden="true" tabindex="-1"></a>         <span class="dv">171</span>,   <span class="dv">409</span>,   <span class="dv">223</span>,  <span class="dv">245</span>,      <span class="dv">65</span>,   <span class="dv">172</span>,    <span class="dv">99</span>,   <span class="dv">174</span>,</span>
<span id="cb47-24"><a href="6-Chapter_5.html#cb47-24" aria-hidden="true" tabindex="-1"></a>         <span class="dv">293</span>,   <span class="dv">290</span>,    <span class="dv">67</span>,   <span class="dv">31</span>,      <span class="dv">32</span>,    <span class="dv">62</span>,    <span class="dv">18</span>,    <span class="dv">30</span>,</span>
<span id="cb47-25"><a href="6-Chapter_5.html#cb47-25" aria-hidden="true" tabindex="-1"></a>        <span class="dv">4288</span>,  <span class="dv">4916</span>,  <span class="dv">1452</span>,  <span class="dv">766</span>,     <span class="dv">616</span>,   <span class="dv">794</span>,   <span class="dv">347</span>,   <span class="dv">300</span>,</span>
<span id="cb47-26"><a href="6-Chapter_5.html#cb47-26" aria-hidden="true" tabindex="-1"></a>         <span class="dv">370</span>,   <span class="dv">186</span>,     <span class="dv">3</span>,    <span class="dv">4</span>,      <span class="dv">67</span>,    <span class="dv">37</span>,     <span class="dv">5</span>,     <span class="dv">2</span>)</span>
<span id="cb47-27"><a href="6-Chapter_5.html#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="6-Chapter_5.html#cb47-28" aria-hidden="true" tabindex="-1"></a>Income<span class="ot">&lt;-</span><span class="fu">gl</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">192</span>)</span>
<span id="cb47-29"><a href="6-Chapter_5.html#cb47-29" aria-hidden="true" tabindex="-1"></a>Occ<span class="ot">&lt;-</span><span class="fu">gl</span>(<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">192</span>)</span>
<span id="cb47-30"><a href="6-Chapter_5.html#cb47-30" aria-hidden="true" tabindex="-1"></a>E1<span class="ot">&lt;-</span><span class="fu">gl</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">192</span>)</span>
<span id="cb47-31"><a href="6-Chapter_5.html#cb47-31" aria-hidden="true" tabindex="-1"></a>E2<span class="ot">&lt;-</span><span class="fu">gl</span>(<span class="dv">2</span>,<span class="dv">96</span>,<span class="dv">192</span>)</span>
<span id="cb47-32"><a href="6-Chapter_5.html#cb47-32" aria-hidden="true" tabindex="-1"></a>Educ<span class="ot">&lt;-</span>E2<span class="sc">:</span>E1</span>
<span id="cb47-33"><a href="6-Chapter_5.html#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Educ)<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb47-34"><a href="6-Chapter_5.html#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="6-Chapter_5.html#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co">#nEduc&lt;-as.numeric(Educ)</span></span>
<span id="cb47-36"><a href="6-Chapter_5.html#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="co">#nAttitude&lt;-as.numeric(Attitude)</span></span>
<span id="cb47-37"><a href="6-Chapter_5.html#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Attitude.c&lt;-Attitude</span></span>
<span id="cb47-38"><a href="6-Chapter_5.html#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="co">#levels(Attitude.c)&lt;-c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;3&quot;)</span></span>
<span id="cb47-39"><a href="6-Chapter_5.html#cb47-39" aria-hidden="true" tabindex="-1"></a>Table<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Freq,Income,Occ,Educ)</span>
<span id="cb47-40"><a href="6-Chapter_5.html#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################################################</span></span>
<span id="cb47-41"><a href="6-Chapter_5.html#cb47-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-42"><a href="6-Chapter_5.html#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 5.5</span></span>
<span id="cb47-43"><a href="6-Chapter_5.html#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: Complete Independence</span></span>
<span id="cb47-44"><a href="6-Chapter_5.html#cb47-44" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Educ<span class="sc">+</span>Occ<span class="sc">+</span>Income,<span class="at">data=</span>Table,<span class="at">family=</span>poisson,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb47-45"><a href="6-Chapter_5.html#cb47-45" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m1) </span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code>  Df       L2 p  AIC(L2)  BIC(L2)    Delta
 174 586906.2 0 586558.2 584536.9 33.84897</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="6-Chapter_5.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: Conditional Independence</span></span>
<span id="cb50-2"><a href="6-Chapter_5.html#cb50-2" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Educ<span class="sc">*</span>Occ<span class="sc">+</span>Income<span class="sc">*</span>Occ,<span class="at">data=</span>Table,<span class="at">family=</span>poisson,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb50-3"><a href="6-Chapter_5.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m2)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code>  Df      L2 p AIC(L2)  BIC(L2)    Delta
 108 27957.4 0 27741.4 26486.78 6.003195</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="6-Chapter_5.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 3: All two-way interaction</span></span>
<span id="cb53-2"><a href="6-Chapter_5.html#cb53-2" aria-hidden="true" tabindex="-1"></a>m3<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Educ<span class="sc">*</span>Occ<span class="sc">+</span>Income<span class="sc">*</span>Occ<span class="sc">+</span>Educ<span class="sc">*</span>Income,<span class="at">data=</span>Table,<span class="at">family=</span>poisson,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb53-3"><a href="6-Chapter_5.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m3)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code> Df       L2 p  AIC(L2)  BIC(L2)    Delta
 99 6540.396 0 6342.396 5192.331 2.635334</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="6-Chapter_5.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 4: RC(1)+RL(1) partial association</span></span>
<span id="cb56-2"><a href="6-Chapter_5.html#cb56-2" aria-hidden="true" tabindex="-1"></a>m4<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Educ<span class="sc">+</span>Occ<span class="sc">+</span>Income<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Occ,Educ)<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Occ,Income),</span>
<span id="cb56-3"><a href="6-Chapter_5.html#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>Table,<span class="at">family=</span>poisson,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
........
Done</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="6-Chapter_5.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m4)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code>  Df       L2 p  AIC(L2) BIC(L2)    Delta
 148 70860.99 0 70564.99 68845.7 11.16939</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="6-Chapter_5.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 5: Model 4 with consistent row (occupation) scores</span></span>
<span id="cb61-2"><a href="6-Chapter_5.html#cb61-2" aria-hidden="true" tabindex="-1"></a>m5<span class="ot">&lt;-</span><span class="fu">gnm</span>(Freq<span class="sc">~</span>Educ<span class="sc">+</span>Occ<span class="sc">+</span>Income<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Occ,Educ<span class="sc">+</span>Income),</span>
<span id="cb61-3"><a href="6-Chapter_5.html#cb61-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>Table,<span class="at">family=</span>poisson,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................................................................
..........................................
Done</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="6-Chapter_5.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m5)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code>  Df       L2 p  AIC(L2)  BIC(L2)    Delta
 158 185515.3 0 185199.3 183363.8 18.26686</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="6-Chapter_5.html#cb66-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">getContrasts</span>(m5, <span class="fu">pickCoef</span>(m5, <span class="st">&quot;[.]Occ&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],</span>
<span id="cb66-2"><a href="6-Chapter_5.html#cb66-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,<span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb66-3"><a href="6-Chapter_5.html#cb66-3" aria-hidden="true" tabindex="-1"></a>mu</span></code></pre></div>
<pre><code>                                   Estimate  Std. Error
Mult(1, ., Educ + Income).Occ1  -0.54805987 0.001793134
Mult(1, ., Educ + Income).Occ2  -0.38746682 0.001271727
Mult(1, ., Educ + Income).Occ3  -0.21717857 0.001291161
Mult(1, ., Educ + Income).Occ4  -0.14398575 0.001002368
Mult(1, ., Educ + Income).Occ5  -0.08607017 0.001273939
Mult(1, ., Educ + Income).Occ6   0.15776750 0.001820890
Mult(1, ., Educ + Income).Occ7   0.05029005 0.002500252
Mult(1, ., Educ + Income).Occ8   0.14092026 0.002598170
Mult(1, ., Educ + Income).Occ9   0.02379483 0.003466324
Mult(1, ., Educ + Income).Occ10  0.39930723 0.004697125
Mult(1, ., Educ + Income).Occ11  0.10479535 0.001779509
Mult(1, ., Educ + Income).Occ12  0.50588597 0.004258340</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="6-Chapter_5.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6: RC(1)+RL(1)+CL(1) partial association</span></span>
<span id="cb68-2"><a href="6-Chapter_5.html#cb68-2" aria-hidden="true" tabindex="-1"></a>m6 <span class="ot">&lt;-</span> <span class="fu">gnm</span>(Freq<span class="sc">~</span>Educ<span class="sc">+</span>Occ<span class="sc">+</span>Income<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Occ,Educ)<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Occ,Income)<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Educ,Income),</span>
<span id="cb68-3"><a href="6-Chapter_5.html#cb68-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>Table,<span class="at">family=</span>poisson,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
......................
Done</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="6-Chapter_5.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m6)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code>  Df       L2 p  AIC(L2)  BIC(L2)    Delta
 143 42101.44 0 41815.44 40154.24 8.274821</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="6-Chapter_5.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7: Model 6 with consistent row (occupation) scores</span></span>
<span id="cb73-2"><a href="6-Chapter_5.html#cb73-2" aria-hidden="true" tabindex="-1"></a>m7 <span class="ot">&lt;-</span> <span class="fu">gnm</span>(Freq<span class="sc">~</span>Educ<span class="sc">+</span>Occ<span class="sc">+</span>Income<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Occ,Educ<span class="sc">+</span>Income)<span class="sc">+</span><span class="fu">Mult</span>(<span class="dv">1</span>,Educ,Income),</span>
<span id="cb73-3"><a href="6-Chapter_5.html#cb73-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>Table,<span class="at">family=</span>poisson,<span class="at">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
................................................................................
.........................................................................
Done</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="6-Chapter_5.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.summary</span>(m7)</span></code></pre></div>
<pre><code>[1] &quot;Model Summary:&quot;</code></pre>
<pre><code>  Df       L2 p  AIC(L2)  BIC(L2)    Delta
 153 174073.1 0 173767.1 171989.8 17.80335</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="6-Chapter_5.html#cb78-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">getContrasts</span>(m7, <span class="fu">pickCoef</span>(m7, <span class="st">&quot;[.]Occ&quot;</span>),</span>
<span id="cb78-2"><a href="6-Chapter_5.html#cb78-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ref =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">scaleRef =</span> <span class="st">&quot;mean&quot;</span>,<span class="at">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb78-3"><a href="6-Chapter_5.html#cb78-3" aria-hidden="true" tabindex="-1"></a>mu</span></code></pre></div>
<pre><code>                                   Estimate  Std. Error
Mult(1, ., Educ + Income).Occ1   0.56931429 0.001883457
Mult(1, ., Educ + Income).Occ2   0.37928161 0.001275097
Mult(1, ., Educ + Income).Occ3   0.22247516 0.001381547
Mult(1, ., Educ + Income).Occ4   0.17045561 0.001046926
Mult(1, ., Educ + Income).Occ5   0.05464251 0.001423421
Mult(1, ., Educ + Income).Occ6  -0.16380722 0.001871288
Mult(1, ., Educ + Income).Occ7  -0.07890623 0.002667870
Mult(1, ., Educ + Income).Occ8  -0.14504188 0.002680434
Mult(1, ., Educ + Income).Occ9  -0.04282708 0.003676179
Mult(1, ., Educ + Income).Occ10 -0.39013284 0.004810546
Mult(1, ., Educ + Income).Occ11 -0.09178943 0.001794307
Mult(1, ., Educ + Income).Occ12 -0.48366450 0.004397647</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="6-Chapter_5.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 8: model 6 with consistent row, column and layer scores</span></span>
<span id="cb80-2"><a href="6-Chapter_5.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># currently, this might not be fitted with gnm!</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="5-Chapter_4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="7-Chapter_6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["カテゴリカルデータの連関モデル.pdf", "カテゴリカルデータの連関モデル.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
